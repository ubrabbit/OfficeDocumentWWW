/*!
 * Copyright (c) Ascensio System SIA 2023. All rights reserved
 *
 * http://www.onlyoffice.com 
 *
 * Version: 7.3.3 (build:49)
 */
function _extend_object(t,e){return"undefined"!=typeof _?_.extend({},t,e):Object?Object.assign({},t,e):e}function onDropDownKeyDown(t){var e=$(this),i=e.parent(),n=jQuery.Event("keydown.before.bs.dropdown",{keyCode:t.keyCode}),o=jQuery.Event("keydown.after.bs.dropdown",{keyCode:t.keyCode});i.trigger(n),i.hasClass("no-stop-propagate")?(arguments.length>1&&arguments[1]instanceof KeyboardEvent&&(t=arguments[1]),!/^(38|40|27|13|9|37|39)$/.test(t.keyCode)||t.ctrlKey||t.altKey||(patchDropDownKeyDownAdditional.call(this,t),/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()))):e.hasClass("move-focus")?(!/^(13|9|32)/.test(t.keyCode)&&(27!==t.keyCode||i.hasClass("open"))||t.ctrlKey||t.altKey)&&(patchDropDownKeyDown.call(this,t),t.preventDefault(),t.stopPropagation()):(patchDropDownKeyDown.call(this,t),t.preventDefault(),t.stopPropagation()),i.trigger(o)}function checkFocusedItem(t,e){var i=t.innerHeight(),n=(i-t.height())/2,o=e.position().top,s=e.outerHeight();o<0?t.scrollTop(t.scrollTop()+o-n):o+s>i&&t.scrollTop(t.scrollTop()+o+s-i+n)}function patchDropDownKeyDown(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=getParent(e),n=i.hasClass("open")||i.hasClass("over");if(!n||n&&27==t.keyCode){if(27==t.which){if(o=$("[role=menu] li.dropdown-submenu.over:visible",i),o.length)return o.eq(o.length-1).removeClass("over"),!1;i.hasClass("dropdown-submenu")&&i.hasClass("over")?(i.removeClass("over"),i.find("> a").focus()):i.find("[data-toggle=dropdown]").focus()}return n?e.click():void 0}var o=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");if(o.length){var s=o.index(o.filter(":focus"));if(39==t.keyCode){if(s<0)return;var r=o.eq(s).parent();r.hasClass("dropdown-submenu")&&!r.hasClass("over")&&(r.mouseenter(),r.addClass("focused-submenu"),_.delay(function(){var t=$("> [role=menu]",r),e=t.find("> li:not(.divider):not(.disabled):visible > a"),i=t.find("> li:not(.divider):not(.disabled):visible .dataview"),n=t.find("> li:not(.divider):not(.disabled):visible .theme-colorpalette.focused"),o=t.find("> li:not(.divider):not(.disabled):visible ul.internal-menu");e.length>0&&i.length<1&&o.length<1&&n.length<1&&e.index(e.filter(":focus"))<0&&e.eq(0).focus()},250))}else 37==t.keyCode?i.hasClass("dropdown-submenu")&&i.hasClass("over")&&(i.removeClass("over"),i.find("> a").focus()):(38==t.keyCode?s>0?s--:s=e.hasClass("no-cyclic")?0:o.length-1:40==t.keyCode&&(s<o.length-1?s++:s=e.hasClass("no-cyclic")?o.length-1:0),~s||(s=0),i.hasClass("dropdown-submenu")&&i.hasClass("over")&&i.addClass("focused-submenu"),checkFocusedItem(e,o.eq(s)),o.eq(s).focus())}}}}function patchDropDownKeyDownAdditional(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()),!e.is(".disabled, :disabled")){var i=getParent(e),n=i.hasClass("open")||i.hasClass("over");if(!n||n&&(27==t.keyCode||37==t.keyCode||39==t.keyCode))return n?e.click():void 0;var o=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");if(o.length){var s=o.index(o.filter(".focus")),r=s;if(38==t.keyCode?s>0?s--:s=e.hasClass("no-cyclic")?0:o.length-1:40==t.keyCode&&(s<o.length-1?s++:s=e.hasClass("no-cyclic")?o.length-1:0),~s||(s=0),o.removeClass("focus"),o.eq(s).addClass("focus"),r!==s){var a=o.eq(r).parent().data("bs.tooltip");a&&a.hide(),a=o.eq(s).parent().data("bs.tooltip"),a&&a.show()}}}}}function getParent(t){var e=t.attr("data-target");e||(e=t.attr("href"),e=e&&/#/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var i=e&&$(e);return i&&i.length?i:t.parent()}function clearMenus(t){$(".dropdown-toggle").each(function(e){var i=$(this).parent();if(i.hasClass("open")){if("prevent-canvas-click"==i.attr("data-value"))return void i.attr("data-value","");i.trigger(e=$.Event("hide.bs.dropdown")),e.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown",t)}})}function toggle(){$(".dropdown-backdrop").remove()}if(function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},e=t._,i=Array.prototype,n=Object.prototype,o="undefined"!=typeof Symbol?Symbol.prototype:null,s=i.push,r=i.slice,a=n.toString,l=n.hasOwnProperty,c=Array.isArray,h=Object.keys,d=Object.create,u=function(){},p=function(t){return t instanceof p?t:this instanceof p?void(this._wrapped=t):new p(t)};"undefined"==typeof exports||exports.nodeType?t._=p:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=p),exports._=p),p.VERSION="1.8.3";var m,f=function(t,e,i){if(void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case null:case 3:return function(i,n,o){return t.call(e,i,n,o)};case 4:return function(i,n,o,s){return t.call(e,i,n,o,s)}}return function(){return t.apply(e,arguments)}},g=function(t,e,i){return p.iteratee!==m?p.iteratee(t,e):null==t?p.identity:p.isFunction(t)?f(t,e,i):p.isObject(t)&&!p.isArray(t)?p.matcher(t):p.property(t)};p.iteratee=m=function(t,e){return g(t,e,1/0)};var v=function(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),n=Array(i),o=0;o<i;o++)n[o]=arguments[o+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var s=Array(e+1);for(o=0;o<e;o++)s[o]=arguments[o];return s[e]=n,t.apply(this,s)}},b=function(t){if(!p.isObject(t))return{};if(d)return d(t);u.prototype=t;var e=new u;return u.prototype=null,e},y=function(t){return function(e){return null==e?void 0:e[t]}},w=function(t,e){for(var i=e.length,n=0;n<i;n++){if(null==t)return;t=t[e[n]]}return i?t:void 0},C=Math.pow(2,53)-1,x=y("length"),_=function(t){var e=x(t);return"number"==typeof e&&e>=0&&e<=C};p.each=p.forEach=function(t,e,i){e=f(e,i);var n,o;if(_(t))for(n=0,o=t.length;n<o;n++)e(t[n],n,t);else{var s=p.keys(t);for(n=0,o=s.length;n<o;n++)e(t[s[n]],s[n],t)}return t},p.map=p.collect=function(t,e,i){e=g(e,i);for(var n=!_(t)&&p.keys(t),o=(n||t).length,s=Array(o),r=0;r<o;r++){var a=n?n[r]:r;s[r]=e(t[a],a,t)}return s};var k=function(t){var e=function(e,i,n,o){var s=!_(e)&&p.keys(e),r=(s||e).length,a=t>0?0:r-1;for(o||(n=e[s?s[a]:a],a+=t);a>=0&&a<r;a+=t){var l=s?s[a]:a;n=i(n,e[l],l,e)}return n};return function(t,i,n,o){var s=arguments.length>=3;return e(t,f(i,o,4),n,s)}};p.reduce=p.foldl=p.inject=k(1),p.reduceRight=p.foldr=k(-1),p.find=p.detect=function(t,e,i){var n=_(t)?p.findIndex:p.findKey,o=n(t,e,i);if(void 0!==o&&-1!==o)return t[o]},p.filter=p.select=function(t,e,i){var n=[];return e=g(e,i),p.each(t,function(t,i,o){e(t,i,o)&&n.push(t)}),n},p.reject=function(t,e,i){return p.filter(t,p.negate(g(e)),i)},p.every=p.all=function(t,e,i){e=g(e,i);for(var n=!_(t)&&p.keys(t),o=(n||t).length,s=0;s<o;s++){var r=n?n[s]:s;if(!e(t[r],r,t))return!1}return!0},p.some=p.any=function(t,e,i){e=g(e,i);for(var n=!_(t)&&p.keys(t),o=(n||t).length,s=0;s<o;s++){var r=n?n[s]:s;if(e(t[r],r,t))return!0}return!1},p.contains=p.includes=p.include=function(t,e,i,n){return _(t)||(t=p.values(t)),("number"!=typeof i||n)&&(i=0),p.indexOf(t,e,i)>=0},p.invoke=v(function(t,e,i){var n,o;return p.isFunction(e)?o=e:p.isArray(e)&&(n=e.slice(0,-1),e=e[e.length-1]),p.map(t,function(t){var s=o;if(!s){if(n&&n.length&&(t=w(t,n)),null==t)return;s=t[e]}return null==s?s:s.apply(t,i)})}),p.pluck=function(t,e){return p.map(t,p.property(e))},p.where=function(t,e){return p.filter(t,p.matcher(e))},p.findWhere=function(t,e){return p.find(t,p.matcher(e))},p.max=function(t,e,i){var n,o,s=-1/0,r=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t){t=_(t)?t:p.values(t);for(var a=0,l=t.length;a<l;a++)null!=(n=t[a])&&n>s&&(s=n)}else e=g(e,i),p.each(t,function(t,i,n){((o=e(t,i,n))>r||o===-1/0&&s===-1/0)&&(s=t,r=o)});return s},p.min=function(t,e,i){var n,o,s=1/0,r=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t){t=_(t)?t:p.values(t);for(var a=0,l=t.length;a<l;a++)null!=(n=t[a])&&n<s&&(s=n)}else e=g(e,i),p.each(t,function(t,i,n){((o=e(t,i,n))<r||o===1/0&&s===1/0)&&(s=t,r=o)});return s},p.shuffle=function(t){return p.sample(t,1/0)},p.sample=function(t,e,i){if(null==e||i)return _(t)||(t=p.values(t)),t[p.random(t.length-1)];var n=_(t)?p.clone(t):p.values(t),o=x(n);e=Math.max(Math.min(e,o),0);for(var s=o-1,r=0;r<e;r++){var a=p.random(r,s),l=n[r];n[r]=n[a],n[a]=l}return n.slice(0,e)},p.sortBy=function(t,e,i){var n=0;return e=g(e,i),p.pluck(p.map(t,function(t,i,o){return{value:t,index:n++,criteria:e(t,i,o)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")};var S=function(t,e){return function(i,n,o){var s=e?[[],[]]:{};return n=g(n,o),p.each(i,function(e,o){var r=n(e,o,i);t(s,e,r)}),s}};p.groupBy=S(function(t,e,i){p.has(t,i)?t[i].push(e):t[i]=[e]}),p.indexBy=S(function(t,e,i){t[i]=e}),p.countBy=S(function(t,e,i){p.has(t,i)?t[i]++:t[i]=1});var T=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;p.toArray=function(t){return t?p.isArray(t)?r.call(t):p.isString(t)?t.match(T):_(t)?p.map(t,p.identity):p.values(t):[]},p.size=function(t){return null==t?0:_(t)?t.length:p.keys(t).length},p.partition=S(function(t,e,i){t[i?0:1].push(e)},!0),p.first=p.head=p.take=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[0]:p.initial(t,t.length-e)},p.initial=function(t,e,i){return r.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},p.last=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[t.length-1]:p.rest(t,Math.max(0,t.length-e))},p.rest=p.tail=p.drop=function(t,e,i){return r.call(t,null==e||i?1:e)},p.compact=function(t){return p.filter(t,Boolean)};var I=function(t,e,i,n){n=n||[];for(var o=n.length,s=0,r=x(t);s<r;s++){var a=t[s];if(_(a)&&(p.isArray(a)||p.isArguments(a)))if(e)for(var l=0,c=a.length;l<c;)n[o++]=a[l++];else I(a,e,i,n),o=n.length;else i||(n[o++]=a)}return n};p.flatten=function(t,e){return I(t,e,!1)},p.without=v(function(t,e){return p.difference(t,e)}),p.uniq=p.unique=function(t,e,i,n){p.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=g(i,n));for(var o=[],s=[],r=0,a=x(t);r<a;r++){var l=t[r],c=i?i(l,r,t):l;e?(r&&s===c||o.push(l),s=c):i?p.contains(s,c)||(s.push(c),o.push(l)):p.contains(o,l)||o.push(l)}return o},p.union=v(function(t){return p.uniq(I(t,!0,!0))}),p.intersection=function(t){for(var e=[],i=arguments.length,n=0,o=x(t);n<o;n++){var s=t[n];if(!p.contains(e,s)){var r;for(r=1;r<i&&p.contains(arguments[r],s);r++);r===i&&e.push(s)}}return e},p.difference=v(function(t,e){return e=I(e,!0,!0),p.filter(t,function(t){return!p.contains(e,t)})}),p.unzip=function(t){for(var e=t&&p.max(t,x).length||0,i=Array(e),n=0;n<e;n++)i[n]=p.pluck(t,n);return i},p.zip=v(p.unzip),p.object=function(t,e){for(var i={},n=0,o=x(t);n<o;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i};var E=function(t){return function(e,i,n){i=g(i,n);for(var o=x(e),s=t>0?0:o-1;s>=0&&s<o;s+=t)if(i(e[s],s,e))return s;return-1}};p.findIndex=E(1),p.findLastIndex=E(-1),p.sortedIndex=function(t,e,i,n){i=g(i,n,1);for(var o=i(e),s=0,r=x(t);s<r;){var a=Math.floor((s+r)/2);i(t[a])<o?s=a+1:r=a}return s};var D=function(t,e,i){return function(n,o,s){var a=0,l=x(n);if("number"==typeof s)t>0?a=s>=0?s:Math.max(s+l,a):l=s>=0?Math.min(s+1,l):s+l+1;else if(i&&s&&l)return s=i(n,o),n[s]===o?s:-1;if(o!==o)return s=e(r.call(n,a,l),p.isNaN),s>=0?s+a:-1;for(s=t>0?a:l-1;s>=0&&s<l;s+=t)if(n[s]===o)return s;return-1}};p.indexOf=D(1,p.findIndex,p.sortedIndex),p.lastIndexOf=D(-1,p.findLastIndex),p.range=function(t,e,i){null==e&&(e=t||0,t=0),i||(i=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/i),0),o=Array(n),s=0;s<n;s++,t+=i)o[s]=t;return o},p.chunk=function(t,e){if(null==e||e<1)return[];for(var i=[],n=0,o=t.length;n<o;)i.push(r.call(t,n,n+=e));return i};var A=function(t,e,i,n,o){if(!(n instanceof e))return t.apply(i,o);var s=b(t.prototype),r=t.apply(s,o);return p.isObject(r)?r:s};p.bind=v(function(t,e,i){if(!p.isFunction(t))throw new TypeError("Bind must be called on a function");var n=v(function(o){return A(t,n,e,this,i.concat(o))});return n}),p.partial=v(function(t,e){var i=p.partial.placeholder,n=function(){for(var o=0,s=e.length,r=Array(s),a=0;a<s;a++)r[a]=e[a]===i?arguments[o++]:e[a];for(;o<arguments.length;)r.push(arguments[o++]);return A(t,n,this,this,r)};return n}),p.partial.placeholder=p,p.bindAll=v(function(t,e){e=I(e,!1,!1);var i=e.length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=e[i];t[n]=p.bind(t[n],t)}}),p.memoize=function(t,e){var i=function(n){var o=i.cache,s=""+(e?e.apply(this,arguments):n);return p.has(o,s)||(o[s]=t.apply(this,arguments)),o[s]};return i.cache={},i},p.delay=v(function(t,e,i){return setTimeout(function(){return t.apply(null,i)},e)}),p.defer=p.partial(p.delay,p,1),p.throttle=function(t,e,i){var n,o,s,r,a=0;i||(i={});var l=function(){a=!1===i.leading?0:p.now(),n=null,r=t.apply(o,s),n||(o=s=null)},c=function(){var c=p.now();a||!1!==i.leading||(a=c);var h=e-(c-a);return o=this,s=arguments,h<=0||h>e?(n&&(clearTimeout(n),n=null),a=c,r=t.apply(o,s),n||(o=s=null)):n||!1===i.trailing||(n=setTimeout(l,h)),r};return c.cancel=function(){clearTimeout(n),a=0,n=o=s=null},c},p.debounce=function(t,e,i){var n,o,s=function(e,i){n=null,i&&(o=t.apply(e,i))},r=v(function(r){if(n&&clearTimeout(n),i){var a=!n;n=setTimeout(s,e),a&&(o=t.apply(this,r))}else n=p.delay(s,e,this,r);return o});return r.cancel=function(){clearTimeout(n),n=null},r},p.wrap=function(t,e){return p.partial(e,t)},p.negate=function(t){return function(){return!t.apply(this,arguments)}},p.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},p.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},p.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},p.once=p.partial(p.before,2),p.restArgs=v;var U=!{toString:null}.propertyIsEnumerable("toString"),M=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],$=function(t,e){var i=M.length,o=t.constructor,s=p.isFunction(o)&&o.prototype||n,r="constructor";for(p.has(t,r)&&!p.contains(e,r)&&e.push(r);i--;)(r=M[i])in t&&t[r]!==s[r]&&!p.contains(e,r)&&e.push(r)};p.keys=function(t){if(!p.isObject(t))return[];if(h)return h(t);var e=[];for(var i in t)p.has(t,i)&&e.push(i);return U&&$(t,e),e},p.allKeys=function(t){if(!p.isObject(t))return[];var e=[];for(var i in t)e.push(i);return U&&$(t,e),e},p.values=function(t){for(var e=p.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=t[e[o]];return n},p.mapObject=function(t,e,i){e=g(e,i);for(var n=p.keys(t),o=n.length,s={},r=0;r<o;r++){var a=n[r];s[a]=e(t[a],a,t)}return s},p.pairs=function(t){for(var e=p.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=[e[o],t[e[o]]];return n},p.invert=function(t){for(var e={},i=p.keys(t),n=0,o=i.length;n<o;n++)e[t[i[n]]]=i[n];return e},p.functions=p.methods=function(t){var e=[];for(var i in t)p.isFunction(t[i])&&e.push(i);return e.sort()};var P=function(t,e){return function(i){var n=arguments.length;if(e&&(i=Object(i)),n<2||null==i)return i;for(var o=1;o<n;o++)for(var s=arguments[o],r=t(s),a=r.length,l=0;l<a;l++){var c=r[l];e&&void 0!==i[c]||(i[c]=s[c])}return i}};p.extend=P(p.allKeys),p.extendOwn=p.assign=P(p.keys),p.findKey=function(t,e,i){e=g(e,i);for(var n,o=p.keys(t),s=0,r=o.length;s<r;s++)if(n=o[s],e(t[n],n,t))return n};var O=function(t,e,i){return e in i};p.pick=v(function(t,e){var i={},n=e[0];if(null==t)return i;p.isFunction(n)?(e.length>1&&(n=f(n,e[1])),e=p.allKeys(t)):(n=O,e=I(e,!1,!1),t=Object(t));for(var o=0,s=e.length;o<s;o++){var r=e[o],a=t[r];n(a,r,t)&&(i[r]=a)}return i}),p.omit=v(function(t,e){var i,n=e[0];return p.isFunction(n)?(n=p.negate(n),e.length>1&&(i=e[1])):(e=p.map(I(e,!1,!1),String),n=function(t,i){return!p.contains(e,i)}),p.pick(t,n,i)}),p.defaults=P(p.allKeys,!0),p.create=function(t,e){var i=b(t);return e&&p.extendOwn(i,e),i},p.clone=function(t){return p.isObject(t)?p.isArray(t)?t.slice():p.extend({},t):t},p.tap=function(t,e){return e(t),t},p.isMatch=function(t,e){var i=p.keys(e),n=i.length;if(null==t)return!n;for(var o=Object(t),s=0;s<n;s++){var r=i[s];if(e[r]!==o[r]||!(r in o))return!1}return!0};var L,z;L=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!==t)return e!==e;var o=typeof t;return("function"===o||"object"===o||"object"==typeof e)&&z(t,e,i,n)},z=function(t,e,i,n){t instanceof p&&(t=t._wrapped),e instanceof p&&(e=e._wrapped);var s=a.call(t);if(s!==a.call(e))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return o.valueOf.call(t)===o.valueOf.call(e)}var r="[object Array]"===s;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var l=t.constructor,c=e.constructor;if(l!==c&&!(p.isFunction(l)&&l instanceof l&&p.isFunction(c)&&c instanceof c)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var h=i.length;h--;)if(i[h]===t)return n[h]===e;if(i.push(t),n.push(e),r){if((h=t.length)!==e.length)return!1;for(;h--;)if(!L(t[h],e[h],i,n))return!1}else{var d,u=p.keys(t);if(h=u.length,p.keys(e).length!==h)return!1;for(;h--;)if(d=u[h],!p.has(e,d)||!L(t[d],e[d],i,n))return!1}return i.pop(),n.pop(),!0},p.isEqual=function(t,e){return L(t,e)},p.isEmpty=function(t){return null==t||(_(t)&&(p.isArray(t)||p.isString(t)||p.isArguments(t))?0===t.length:0===p.keys(t).length)},p.isElement=function(t){return!(!t||1!==t.nodeType)},p.isArray=c||function(t){return"[object Array]"===a.call(t)},p.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},p.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){p["is"+t]=function(e){return a.call(e)==="[object "+t+"]"}}),p.isArguments(arguments)||(p.isArguments=function(t){return p.has(t,"callee")});var V=t.document&&t.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof V&&(p.isFunction=function(t){return"function"==typeof t||!1}),p.isFinite=function(t){return!p.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},p.isNaN=function(t){return p.isNumber(t)&&isNaN(t)},p.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===a.call(t)},p.isNull=function(t){return null===t},p.isUndefined=function(t){return void 0===t},p.has=function(t,e){if(!p.isArray(e))return null!=t&&l.call(t,e);for(var i=e.length,n=0;n<i;n++){var o=e[n];if(null==t||!l.call(t,o))return!1;t=t[o]}return!!i},p.noConflict=function(){return t._=e,this},p.identity=function(t){return t},p.constant=function(t){return function(){return t}},p.noop=function(){},p.property=function(t){return p.isArray(t)?function(e){return w(e,t)}:y(t)},p.propertyOf=function(t){return null==t?function(){}:function(e){return p.isArray(e)?w(t,e):t[e]}},p.matcher=p.matches=function(t){return t=p.extendOwn({},t),function(e){return p.isMatch(e,t)}},p.times=function(t,e,i){var n=Array(Math.max(0,t));e=f(e,i,1);for(var o=0;o<t;o++)n[o]=e(o);return n},p.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},p.now=Date.now||function(){return(new Date).getTime()};var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},R=p.invert(N),H=function(t){var e=function(e){return t[e]},i="(?:"+p.keys(t).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}};p.escape=H(N),p.unescape=H(R),p.result=function(t,e,i){p.isArray(e)||(e=[e]);var n=e.length;if(!n)return p.isFunction(i)?i.call(t):i;for(var o=0;o<n;o++){var s=null==t?void 0:t[e[o]];void 0===s&&(s=i,o=n),t=p.isFunction(s)?s.call(t):s}return t};var F=0;p.uniqueId=function(t){var e=++F+"";return t?t+e:e},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},W=/\\|'|\r|\n|\u2028|\u2029/g,q=function(t){return"\\"+j[t]};p.template=function(t,e,i){!e&&i&&(e=i),e=p.defaults({},e,p.templateSettings);var n=RegExp([(e.escape||B).source,(e.interpolate||B).source,(e.evaluate||B).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(n,function(e,i,n,r,a){return s+=t.slice(o,a).replace(W,q),o=a+e.length,i?s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(s+="';\n"+r+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";var r;try{r=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}var a=function(t){return r.call(this,t,p)};return a.source="function("+(e.variable||"obj")+"){\n"+s+"}",a},p.chain=function(t){var e=p(t);return e._chain=!0,e};var K=function(t,e){return t._chain?p(e).chain():e};p.mixin=function(t){return p.each(p.functions(t),function(e){var i=p[e]=t[e];p.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),K(this,i.apply(p,t))}}),p},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];p.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],K(this,i)}}),p.each(["concat","join","slice"],function(t){var e=i[t];p.prototype[t]=function(){return K(this,e.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},p.prototype.valueOf=p.prototype.toJSON=p.prototype.value,p.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],function(){return p})}(),function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){"use strict";function i(t,e,i){i=i||Ct;var n,o,s=i.createElement("script");if(s.text=t,e)for(n in xt)(o=e[n]||e.getAttribute&&e.getAttribute(n))&&s.setAttribute(n,o);i.head.appendChild(s).parentNode.removeChild(s)}function n(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?pt[mt.call(t)]||"object":typeof t}function o(t){var e=!!t&&"length"in t&&t.length,i=n(t);return!yt(t)&&!wt(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function s(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function r(t,e,i){return yt(e)?_t.grep(t,function(t,n){return!!e.call(t,n,t)!==i}):e.nodeType?_t.grep(t,function(t){return t===e!==i}):"string"!=typeof e?_t.grep(t,function(t){return ut.call(e,t)>-1!==i}):_t.filter(e,t,i)}function a(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function l(t){var e={};return _t.each(t.match($t)||[],function(t,i){e[i]=!0}),e}function c(t){return t}function h(t){throw t}function d(t,e,i,n){var o;try{t&&yt(o=t.promise)?o.call(t).done(e).fail(i):t&&yt(o=t.then)?o.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}function u(){Ct.removeEventListener("DOMContentLoaded",u),t.removeEventListener("load",u),_t.ready()}function p(t,e){return e.toUpperCase()}function m(t){return t.replace(zt,"ms-").replace(Vt,p)}function f(){this.expando=_t.expando+f.uid++}function g(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Ft.test(t)?JSON.parse(t):t)}function v(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(Bt,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=g(i)}catch(t){}Ht.set(t,e,i)}else i=void 0;return i}function b(t,e,i,n){var o,s,r=20,a=n?function(){return n.cur()}:function(){return _t.css(t,e,"")},l=a(),c=i&&i[3]||(_t.cssNumber[e]?"":"px"),h=t.nodeType&&(_t.cssNumber[e]||"px"!==c&&+l)&&Wt.exec(_t.css(t,e));if(h&&h[3]!==c){for(l/=2,c=c||h[3],h=+l||1;r--;)_t.style(t,e,h+c),(1-s)*(1-(s=a()/l||.5))<=0&&(r=0),h/=s;h*=2,_t.style(t,e,h+c),i=i||[]}return i&&(h=+h||+l||0,o=i[1]?h+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=h,n.end=o)),o}function y(t){var e,i=t.ownerDocument,n=t.nodeName,o=Jt[n];return o||(e=i.body.appendChild(i.createElement(n)),o=_t.css(e,"display"),e.parentNode.removeChild(e),"none"===o&&(o="block"),Jt[n]=o,o)}function w(t,e){for(var i,n,o=[],s=0,r=t.length;s<r;s++)n=t[s],n.style&&(i=n.style.display,e?("none"===i&&(o[s]=Rt.get(n,"display")||null,o[s]||(n.style.display="")),""===n.style.display&&Xt(n)&&(o[s]=y(n))):"none"!==i&&(o[s]="none",Rt.set(n,"display",i)));for(s=0;s<r;s++)null!=o[s]&&(t[s].style.display=o[s]);return t}function C(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&s(t,e)?_t.merge([t],i):i}function x(t,e){for(var i=0,n=t.length;i<n;i++)Rt.set(t[i],"globalEval",!e||Rt.get(e[i],"globalEval"))}function _(t,e,i,o,s){for(var r,a,l,c,h,d,u=e.createDocumentFragment(),p=[],m=0,f=t.length;m<f;m++)if((r=t[m])||0===r)if("object"===n(r))_t.merge(p,r.nodeType?[r]:r);else if(ie.test(r)){for(a=a||u.appendChild(e.createElement("div")),l=(Zt.exec(r)||["",""])[1].toLowerCase(),c=ee[l]||ee._default,a.innerHTML=c[1]+_t.htmlPrefilter(r)+c[2],d=c[0];d--;)a=a.lastChild;_t.merge(p,a.childNodes),a=u.firstChild,a.textContent=""}else p.push(e.createTextNode(r));for(u.textContent="",m=0;r=p[m++];)if(o&&_t.inArray(r,o)>-1)s&&s.push(r);else if(h=Yt(r),a=C(u.appendChild(r),"script"),h&&x(a),i)for(d=0;r=a[d++];)te.test(r.type||"")&&i.push(r);return u}function k(){return!0}function S(){return!1}function T(t,e){return t===I()==("focus"===e)}function I(){try{return Ct.activeElement}catch(t){}}function E(t,e,i,n,o,s){var r,a;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=void 0);for(a in e)E(t,a,i,n,e[a],s);return t}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),!1===o)o=S;else if(!o)return t;return 1===s&&(r=o,o=function(t){return _t().off(t),r.apply(this,arguments)},o.guid=r.guid||(r.guid=_t.guid++)),t.each(function(){_t.event.add(this,e,o,n,i)})}function D(t,e,i){if(!i)return void(void 0===Rt.get(t,e)&&_t.event.add(t,e,k));Rt.set(t,e,!1),_t.event.add(t,e,{namespace:!1,handler:function(t){var n,o,s=Rt.get(this,e);if(1&t.isTrigger&&this[e]){if(s.length)(_t.event.special[e]||{}).delegateType&&t.stopPropagation();else if(s=ct.call(arguments),Rt.set(this,e,s),n=i(this,e),this[e](),o=Rt.get(this,e),s!==o||n?Rt.set(this,e,!1):o={},s!==o)return t.stopImmediatePropagation(),t.preventDefault(),o.value}else s.length&&(Rt.set(this,e,{value:_t.event.trigger(_t.extend(s[0],_t.Event.prototype),s.slice(1),this)}),t.stopImmediatePropagation())}})}function A(t,e){return s(t,"table")&&s(11!==e.nodeType?e:e.firstChild,"tr")?_t(t).children("tbody")[0]||t:t}function U(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function M(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function $(t,e){var i,n,o,s,r,a,l;if(1===e.nodeType){if(Rt.hasData(t)&&(s=Rt.get(t),l=s.events)){Rt.remove(e,"handle events");for(o in l)for(i=0,n=l[o].length;i<n;i++)_t.event.add(e,o,l[o][i])}Ht.hasData(t)&&(r=Ht.access(t),a=_t.extend({},r),Ht.set(e,a))}}function P(t,e){var i=e.nodeName.toLowerCase();"input"===i&&Qt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function O(t,e,n,o){e=ht(e);var s,r,a,l,c,h,d=0,u=t.length,p=u-1,m=e[0],f=yt(m);if(f||u>1&&"string"==typeof m&&!bt.checkClone&&ae.test(m))return t.each(function(i){var s=t.eq(i);f&&(e[0]=m.call(this,i,s.html())),O(s,e,n,o)});if(u&&(s=_(e,t[0].ownerDocument,!1,t,o),r=s.firstChild,1===s.childNodes.length&&(s=r),r||o)){for(a=_t.map(C(s,"script"),U),l=a.length;d<u;d++)c=s,d!==p&&(c=_t.clone(c,!0,!0),l&&_t.merge(a,C(c,"script"))),n.call(t[d],c,d);if(l)for(h=a[a.length-1].ownerDocument,_t.map(a,M),d=0;d<l;d++)c=a[d],te.test(c.type||"")&&!Rt.access(c,"globalEval")&&_t.contains(h,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?_t._evalUrl&&!c.noModule&&_t._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},h):i(c.textContent.replace(le,""),c,h))}return t}function L(t,e,i){for(var n,o=e?_t.filter(e,t):t,s=0;null!=(n=o[s]);s++)i||1!==n.nodeType||_t.cleanData(C(n)),n.parentNode&&(i&&Yt(n)&&x(C(n,"script")),n.parentNode.removeChild(n));return t}function z(t,e,i){var n,o,s,r,a=t.style;return i=i||he(t),i&&(r=i.getPropertyValue(e)||i[e],""!==r||Yt(t)||(r=_t.style(t,e)),!bt.pixelBoxStyles()&&ce.test(r)&&ue.test(e)&&(n=a.width,o=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=i.width,a.width=n,a.minWidth=o,a.maxWidth=s)),void 0!==r?r+"":r}function V(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function N(t){for(var e=t[0].toUpperCase()+t.slice(1),i=pe.length;i--;)if((t=pe[i]+e)in me)return t}function R(t){var e=_t.cssProps[t]||fe[t];return e||(t in me?t:fe[t]=N(t)||t)}function H(t,e,i){var n=Wt.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function F(t,e,i,n,o,s){var r="width"===e?1:0,a=0,l=0;if(i===(n?"border":"content"))return 0;for(;r<4;r+=2)"margin"===i&&(l+=_t.css(t,i+qt[r],!0,o)),n?("content"===i&&(l-=_t.css(t,"padding"+qt[r],!0,o)),"margin"!==i&&(l-=_t.css(t,"border"+qt[r]+"Width",!0,o))):(l+=_t.css(t,"padding"+qt[r],!0,o),"padding"!==i?l+=_t.css(t,"border"+qt[r]+"Width",!0,o):a+=_t.css(t,"border"+qt[r]+"Width",!0,o));return!n&&s>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-s-l-a-.5))||0),l}function B(t,e,i){var n=he(t),o=!bt.boxSizingReliable()||i,r=o&&"border-box"===_t.css(t,"boxSizing",!1,n),a=r,l=z(t,e,n),c="offset"+e[0].toUpperCase()+e.slice(1);if(ce.test(l)){if(!i)return l;l="auto"}return(!bt.boxSizingReliable()&&r||!bt.reliableTrDimensions()&&s(t,"tr")||"auto"===l||!parseFloat(l)&&"inline"===_t.css(t,"display",!1,n))&&t.getClientRects().length&&(r="border-box"===_t.css(t,"boxSizing",!1,n),(a=c in t)&&(l=t[c])),(l=parseFloat(l)||0)+F(t,e,i||(r?"border":"content"),a,n,l)+"px"}function j(t,e,i,n,o){return new j.prototype.init(t,e,i,n,o)}function W(){Ce&&(!1===Ct.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(W):t.setTimeout(W,_t.fx.interval),_t.fx.tick())}function q(){return t.setTimeout(function(){we=void 0}),we=Date.now()}function K(t,e){var i,n=0,o={height:t};for(e=e?1:0;n<4;n+=2-e)i=qt[n],o["margin"+i]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function Y(t,e,i){for(var n,o=(J.tweeners[e]||[]).concat(J.tweeners["*"]),s=0,r=o.length;s<r;s++)if(n=o[s].call(i,e,t))return n}function G(t,e,i){var n,o,s,r,a,l,c,h,d="width"in e||"height"in e,u=this,p={},m=t.style,f=t.nodeType&&Xt(t),g=Rt.get(t,"fxshow");i.queue||(r=_t._queueHooks(t,"fx"),null==r.unqueued&&(r.unqueued=0,a=r.empty.fire,r.empty.fire=function(){r.unqueued||a()}),r.unqueued++,u.always(function(){u.always(function(){r.unqueued--,_t.queue(t,"fx").length||r.empty.fire()})}));for(n in e)if(o=e[n],xe.test(o)){if(delete e[n],s=s||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!g||void 0===g[n])continue;f=!0}p[n]=g&&g[n]||_t.style(t,n)}if((l=!_t.isEmptyObject(e))||!_t.isEmptyObject(p)){d&&1===t.nodeType&&(i.overflow=[m.overflow,m.overflowX,m.overflowY],c=g&&g.display,null==c&&(c=Rt.get(t,"display")),h=_t.css(t,"display"),"none"===h&&(c?h=c:(w([t],!0),c=t.style.display||c,h=_t.css(t,"display"),w([t]))),("inline"===h||"inline-block"===h&&null!=c)&&"none"===_t.css(t,"float")&&(l||(u.done(function(){m.display=c}),null==c&&(h=m.display,c="none"===h?"":h)),m.display="inline-block")),i.overflow&&(m.overflow="hidden",u.always(function(){m.overflow=i.overflow[0],m.overflowX=i.overflow[1],m.overflowY=i.overflow[2]})),l=!1;for(n in p)l||(g?"hidden"in g&&(f=g.hidden):g=Rt.access(t,"fxshow",{display:c}),s&&(g.hidden=!f),f&&w([t],!0),u.done(function(){f||w([t]),Rt.remove(t,"fxshow");for(n in p)_t.style(t,n,p[n])})),l=Y(f?g[n]:0,n,u),
n in g||(g[n]=l.start,f&&(l.end=l.start,l.start=0))}}function X(t,e){var i,n,o,s,r;for(i in t)if(n=m(i),o=e[n],s=t[i],Array.isArray(s)&&(o=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),(r=_t.cssHooks[n])&&"expand"in r){s=r.expand(s),delete t[n];for(i in s)i in t||(t[i]=s[i],e[i]=o)}else e[n]=o}function J(t,e,i){var n,o,s=0,r=J.prefilters.length,a=_t.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=we||q(),i=Math.max(0,c.startTime+c.duration-e),n=i/c.duration||0,s=1-n,r=0,l=c.tweens.length;r<l;r++)c.tweens[r].run(s);return a.notifyWith(t,[c,s,i]),s<1&&l?i:(l||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:_t.extend({},e),opts:_t.extend(!0,{specialEasing:{},easing:_t.easing._default},i),originalProperties:e,originalOptions:i,startTime:we||q(),duration:i.duration,tweens:[],createTween:function(e,i){var n=_t.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(o)return this;for(o=!0;i<n;i++)c.tweens[i].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),h=c.props;for(X(h,c.opts.specialEasing);s<r;s++)if(n=J.prefilters[s].call(c,t,h,c.opts))return yt(n.stop)&&(_t._queueHooks(c.elem,c.opts.queue).stop=n.stop.bind(n)),n;return _t.map(h,Y,c),yt(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),_t.fx.timer(_t.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}function Q(t){return(t.match($t)||[]).join(" ")}function Z(t){return t.getAttribute&&t.getAttribute("class")||""}function tt(t){return Array.isArray(t)?t:"string"==typeof t?t.match($t)||[]:[]}function et(t,e,i,o){var s;if(Array.isArray(e))_t.each(e,function(e,n){i||Pe.test(t)?o(t,n):et(t+"["+("object"==typeof n&&null!=n?e:"")+"]",n,i,o)});else if(i||"object"!==n(e))o(t,e);else for(s in e)et(t+"["+s+"]",e[s],i,o)}function it(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,o=0,s=e.toLowerCase().match($t)||[];if(yt(i))for(;n=s[o++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function nt(t,e,i,n){function o(a){var l;return s[a]=!0,_t.each(t[a]||[],function(t,a){var c=a(e,i,n);return"string"!=typeof c||r||s[c]?r?!(l=c):void 0:(e.dataTypes.unshift(c),o(c),!1)}),l}var s={},r=t===qe;return o(e.dataTypes[0])||!s["*"]&&o("*")}function ot(t,e){var i,n,o=_t.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n||(n={}))[i]=e[i]);return n&&_t.extend(!0,t,n),t}function st(t,e,i){for(var n,o,s,r,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(o in a)if(a[o]&&a[o].test(n)){l.unshift(o);break}if(l[0]in i)s=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){s=o;break}r||(r=o)}s=s||r}if(s)return s!==l[0]&&l.unshift(s),i[s]}function rt(t,e,i,n){var o,s,r,a,l,c={},h=t.dataTypes.slice();if(h[1])for(r in t.converters)c[r.toLowerCase()]=t.converters[r];for(s=h.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=h.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(r=c[l+" "+s]||c["* "+s]))for(o in c)if(a=o.split(" "),a[1]===s&&(r=c[l+" "+a[0]]||c["* "+a[0]])){!0===r?r=c[o]:!0!==c[o]&&(s=a[0],h.unshift(a[1]));break}if(!0!==r)if(r&&t.throws)e=r(e);else try{e=r(e)}catch(t){return{state:"parsererror",error:r?t:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}var at=[],lt=Object.getPrototypeOf,ct=at.slice,ht=at.flat?function(t){return at.flat.call(t)}:function(t){return at.concat.apply([],t)},dt=at.push,ut=at.indexOf,pt={},mt=pt.toString,ft=pt.hasOwnProperty,gt=ft.toString,vt=gt.call(Object),bt={},yt=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},wt=function(t){return null!=t&&t===t.window},Ct=t.document,xt={type:!0,src:!0,nonce:!0,noModule:!0},_t=function(t,e){return new _t.fn.init(t,e)};_t.fn=_t.prototype={jquery:"3.5.1",constructor:_t,length:0,toArray:function(){return ct.call(this)},get:function(t){return null==t?ct.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=_t.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return _t.each(this,t)},map:function(t){return this.pushStack(_t.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(ct.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(_t.grep(this,function(t,e){return(e+1)%2}))},odd:function(){return this.pushStack(_t.grep(this,function(t,e){return e%2}))},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:dt,sort:at.sort,splice:at.splice},_t.extend=_t.fn.extend=function(){var t,e,i,n,o,s,r=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof r&&(c=r,r=arguments[a]||{},a++),"object"==typeof r||yt(r)||(r={}),a===l&&(r=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)n=t[e],"__proto__"!==e&&r!==n&&(c&&n&&(_t.isPlainObject(n)||(o=Array.isArray(n)))?(i=r[e],s=o&&!Array.isArray(i)?[]:o||_t.isPlainObject(i)?i:{},o=!1,r[e]=_t.extend(c,s,n)):void 0!==n&&(r[e]=n));return r},_t.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==mt.call(t))&&(!(e=lt(t))||"function"==typeof(i=ft.call(e,"constructor")&&e.constructor)&&gt.call(i)===vt)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){i(t,{nonce:e&&e.nonce},n)},each:function(t,e){var i,n=0;if(o(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},makeArray:function(t,e){var i=e||[];return null!=t&&(o(Object(t))?_t.merge(i,"string"==typeof t?[t]:t):dt.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:ut.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,o=t.length;n<i;n++)t[o++]=e[n];return t.length=o,t},grep:function(t,e,i){for(var n=[],o=0,s=t.length,r=!i;o<s;o++)!e(t[o],o)!==r&&n.push(t[o]);return n},map:function(t,e,i){var n,s,r=0,a=[];if(o(t))for(n=t.length;r<n;r++)null!=(s=e(t[r],r,i))&&a.push(s);else for(r in t)null!=(s=e(t[r],r,i))&&a.push(s);return ht(a)},guid:1,support:bt}),"function"==typeof Symbol&&(_t.fn[Symbol.iterator]=at[Symbol.iterator]),_t.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){pt["[object "+e+"]"]=e.toLowerCase()});var kt=function(t){function e(t,e,i,n){var o,s,r,a,l,h,u,p=e&&e.ownerDocument,m=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==m&&9!==m&&11!==m)return i;if(!n&&(A(e),e=e||U,$)){if(11!==m&&(l=vt.exec(t)))if(o=l[1]){if(9===m){if(!(r=e.getElementById(o)))return i;if(r.id===o)return i.push(r),i}else if(p&&(r=p.getElementById(o))&&z(e,r)&&r.id===o)return i.push(r),i}else{if(l[2])return J.apply(i,e.getElementsByTagName(t)),i;if((o=l[3])&&w.getElementsByClassName&&e.getElementsByClassName)return J.apply(i,e.getElementsByClassName(o)),i}if(w.qsa&&!W[t+" "]&&(!P||!P.test(t))&&(1!==m||"object"!==e.nodeName.toLowerCase())){if(u=t,p=e,1===m&&(ct.test(t)||lt.test(t))){for(p=bt.test(t)&&c(e.parentNode)||e,p===e&&w.scope||((a=e.getAttribute("id"))?a=a.replace(Ct,xt):e.setAttribute("id",a=V)),h=k(t),s=h.length;s--;)h[s]=(a?"#"+a:":scope")+" "+d(h[s]);u=h.join(",")}try{return J.apply(i,p.querySelectorAll(u)),i}catch(e){W(t,!0)}finally{a===V&&e.removeAttribute("id")}}}return T(t.replace(rt,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>C.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[V]=!0,t}function o(t){var e=U.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function s(t,e){for(var i=t.split("|"),n=i.length;n--;)C.attrHandle[i[n]]=e}function r(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&kt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function l(t){return n(function(e){return e=+e,n(function(i,n){for(var o,s=t([],i.length,e),r=s.length;r--;)i[o=s[r]]&&(i[o]=!(n[o]=i[o]))})})}function c(t){return t&&void 0!==t.getElementsByTagName&&t}function h(){}function d(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function u(t,e,i){var n=e.dir,o=e.next,s=o||n,r=i&&"parentNode"===s,a=H++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,o);return!1}:function(e,i,l){var c,h,d,u=[R,a];if(l){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,l))return!0}else for(;e=e[n];)if(1===e.nodeType||r)if(d=e[V]||(e[V]={}),h=d[e.uniqueID]||(d[e.uniqueID]={}),o&&o===e.nodeName.toLowerCase())e=e[n]||e;else{if((c=h[s])&&c[0]===R&&c[1]===a)return u[2]=c[2];if(h[s]=u,u[2]=t(e,i,l))return!0}return!1}}function p(t){return t.length>1?function(e,i,n){for(var o=t.length;o--;)if(!t[o](e,i,n))return!1;return!0}:t[0]}function m(t,i,n){for(var o=0,s=i.length;o<s;o++)e(t,i[o],n);return n}function f(t,e,i,n,o){for(var s,r=[],a=0,l=t.length,c=null!=e;a<l;a++)(s=t[a])&&(i&&!i(s,n,o)||(r.push(s),c&&e.push(a)));return r}function g(t,e,i,o,s,r){return o&&!o[V]&&(o=g(o)),s&&!s[V]&&(s=g(s,r)),n(function(n,r,a,l){var c,h,d,u=[],p=[],g=r.length,v=n||m(e||"*",a.nodeType?[a]:a,[]),b=!t||!n&&e?v:f(v,u,t,a,l),y=i?s||(n?t:g||o)?[]:r:b;if(i&&i(b,y,a,l),o)for(c=f(y,p),o(c,[],a,l),h=c.length;h--;)(d=c[h])&&(y[p[h]]=!(b[p[h]]=d));if(n){if(s||t){if(s){for(c=[],h=y.length;h--;)(d=y[h])&&c.push(b[h]=d);s(null,y=[],c,l)}for(h=y.length;h--;)(d=y[h])&&(c=s?Z(n,d):u[h])>-1&&(n[c]=!(r[c]=d))}}else y=f(y===r?y.splice(g,y.length):y),s?s(null,r,y,l):J.apply(r,y)})}function v(t){for(var e,i,n,o=t.length,s=C.relative[t[0].type],r=s||C.relative[" "],a=s?1:0,l=u(function(t){return t===e},r,!0),c=u(function(t){return Z(e,t)>-1},r,!0),h=[function(t,i,n){var o=!s&&(n||i!==I)||((e=i).nodeType?l(t,i,n):c(t,i,n));return e=null,o}];a<o;a++)if(i=C.relative[t[a].type])h=[u(p(h),i)];else{if(i=C.filter[t[a].type].apply(null,t[a].matches),i[V]){for(n=++a;n<o&&!C.relative[t[n].type];n++);return g(a>1&&p(h),a>1&&d(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(rt,"$1"),i,a<n&&v(t.slice(a,n)),n<o&&v(t=t.slice(n)),n<o&&d(t))}h.push(i)}return p(h)}function b(t,i){var o=i.length>0,s=t.length>0,r=function(n,r,a,l,c){var h,d,u,p=0,m="0",g=n&&[],v=[],b=I,y=n||s&&C.find.TAG("*",c),w=R+=null==b?1:Math.random()||.1,x=y.length;for(c&&(I=r==U||r||c);m!==x&&null!=(h=y[m]);m++){if(s&&h){for(d=0,r||h.ownerDocument==U||(A(h),a=!$);u=t[d++];)if(u(h,r||U,a)){l.push(h);break}c&&(R=w)}o&&((h=!u&&h)&&p--,n&&g.push(h))}if(p+=m,o&&m!==p){for(d=0;u=i[d++];)u(g,v,r,a);if(n){if(p>0)for(;m--;)g[m]||v[m]||(v[m]=G.call(l));v=f(v)}J.apply(l,v),c&&!n&&v.length>0&&p+i.length>1&&e.uniqueSort(l)}return c&&(R=w,I=b),g};return o?n(r):r}var y,w,C,x,_,k,S,T,I,E,D,A,U,M,$,P,O,L,z,V="sizzle"+1*new Date,N=t.document,R=0,H=0,F=i(),B=i(),j=i(),W=i(),q=function(t,e){return t===e&&(D=!0),0},K={}.hasOwnProperty,Y=[],G=Y.pop,X=Y.push,J=Y.push,Q=Y.slice,Z=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},tt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",et="[\\x20\\t\\r\\n\\f]",it="(?:\\\\[\\da-fA-F]{1,6}"+et+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",nt="\\["+et+"*("+it+")(?:"+et+"*([*^$|!~]?=)"+et+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+it+"))|)"+et+"*\\]",ot=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+nt+")*)|.*)\\)|)",st=new RegExp(et+"+","g"),rt=new RegExp("^"+et+"+|((?:^|[^\\\\])(?:\\\\.)*)"+et+"+$","g"),at=new RegExp("^"+et+"*,"+et+"*"),lt=new RegExp("^"+et+"*([>+~]|"+et+")"+et+"*"),ct=new RegExp(et+"|>"),ht=new RegExp(ot),dt=new RegExp("^"+it+"$"),ut={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it+"|[*])"),ATTR:new RegExp("^"+nt),PSEUDO:new RegExp("^"+ot),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+et+"*(even|odd|(([+-]|)(\\d*)n|)"+et+"*(?:([+-]|)"+et+"*(\\d+)|))"+et+"*\\)|)","i"),bool:new RegExp("^(?:"+tt+")$","i"),needsContext:new RegExp("^"+et+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+et+"*((?:-\\d)?\\d*)"+et+"*\\)|)(?=[^-]|$)","i")},pt=/HTML$/i,mt=/^(?:input|select|textarea|button)$/i,ft=/^h\d$/i,gt=/^[^{]+\{\s*\[native \w/,vt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bt=/[+~]/,yt=new RegExp("\\\\[\\da-fA-F]{1,6}"+et+"?|\\\\([^\\r\\n\\f])","g"),wt=function(t,e){var i="0x"+t.slice(1)-65536;return e||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},Ct=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,xt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},_t=function(){A()},kt=u(function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{J.apply(Y=Q.call(N.childNodes),N.childNodes),Y[N.childNodes.length].nodeType}catch(t){J={apply:Y.length?function(t,e){X.apply(t,Q.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}w=e.support={},_=e.isXML=function(t){var e=t.namespaceURI,i=(t.ownerDocument||t).documentElement;return!pt.test(e||i&&i.nodeName||"HTML")},A=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:N;return n!=U&&9===n.nodeType&&n.documentElement?(U=n,M=U.documentElement,$=!_(U),N!=U&&(i=U.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",_t,!1):i.attachEvent&&i.attachEvent("onunload",_t)),w.scope=o(function(t){return M.appendChild(t).appendChild(U.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length}),w.attributes=o(function(t){return t.className="i",!t.getAttribute("className")}),w.getElementsByTagName=o(function(t){return t.appendChild(U.createComment("")),!t.getElementsByTagName("*").length}),w.getElementsByClassName=gt.test(U.getElementsByClassName),w.getById=o(function(t){return M.appendChild(t).id=V,!U.getElementsByName||!U.getElementsByName(V).length}),w.getById?(C.filter.ID=function(t){var e=t.replace(yt,wt);return function(t){return t.getAttribute("id")===e}},C.find.ID=function(t,e){if(void 0!==e.getElementById&&$){var i=e.getElementById(t);return i?[i]:[]}}):(C.filter.ID=function(t){var e=t.replace(yt,wt);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},C.find.ID=function(t,e){if(void 0!==e.getElementById&&$){var i,n,o,s=e.getElementById(t);if(s){if((i=s.getAttributeNode("id"))&&i.value===t)return[s];for(o=e.getElementsByName(t),n=0;s=o[n++];)if((i=s.getAttributeNode("id"))&&i.value===t)return[s]}return[]}}),C.find.TAG=w.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):w.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],o=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[o++];)1===i.nodeType&&n.push(i);return n}return s},C.find.CLASS=w.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&$)return e.getElementsByClassName(t)},O=[],P=[],(w.qsa=gt.test(U.querySelectorAll))&&(o(function(t){var e;M.appendChild(t).innerHTML="<a id='"+V+"'></a><select id='"+V+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&P.push("[*^$]="+et+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||P.push("\\["+et+"*(?:value|"+tt+")"),t.querySelectorAll("[id~="+V+"-]").length||P.push("~="),e=U.createElement("input"),e.setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||P.push("\\["+et+"*name"+et+"*="+et+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||P.push(":checked"),t.querySelectorAll("a#"+V+"+*").length||P.push(".#.+[+~]"),t.querySelectorAll("\\\f"),P.push("[\\r\\n\\f]")}),o(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=U.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&P.push("name"+et+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&P.push(":enabled",":disabled"),M.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&P.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),P.push(",.*:")})),(w.matchesSelector=gt.test(L=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&o(function(t){w.disconnectedMatch=L.call(t,"*"),L.call(t,"[s!='']:x"),O.push("!=",ot)}),P=P.length&&new RegExp(P.join("|")),O=O.length&&new RegExp(O.join("|")),e=gt.test(M.compareDocumentPosition),z=e||gt.test(M.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},q=e?function(t,e){if(t===e)return D=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!w.sortDetached&&e.compareDocumentPosition(t)===i?t==U||t.ownerDocument==N&&z(N,t)?-1:e==U||e.ownerDocument==N&&z(N,e)?1:E?Z(E,t)-Z(E,e):0:4&i?-1:1)}:function(t,e){if(t===e)return D=!0,0;var i,n=0,o=t.parentNode,s=e.parentNode,a=[t],l=[e];if(!o||!s)return t==U?-1:e==U?1:o?-1:s?1:E?Z(E,t)-Z(E,e):0;if(o===s)return r(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)l.unshift(i);for(;a[n]===l[n];)n++;return n?r(a[n],l[n]):a[n]==N?-1:l[n]==N?1:0},U):U},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if(A(t),w.matchesSelector&&$&&!W[i+" "]&&(!O||!O.test(i))&&(!P||!P.test(i)))try{var n=L.call(t,i);if(n||w.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){W(i,!0)}return e(i,U,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!=U&&A(t),z(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!=U&&A(t);var i=C.attrHandle[e.toLowerCase()],n=i&&K.call(C.attrHandle,e.toLowerCase())?i(t,e,!$):void 0;return void 0!==n?n:w.attributes||!$?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.escape=function(t){return(t+"").replace(Ct,xt)},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,o=0;if(D=!w.detectDuplicates,E=!w.sortStable&&t.slice(0),t.sort(q),D){for(;e=t[o++];)e===t[o]&&(n=i.push(o));for(;n--;)t.splice(i[n],1)}return E=null,t},x=e.getText=function(t){var e,i="",n=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=x(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[n++];)i+=x(e);return i},C=e.selectors={cacheLength:50,createPseudo:n,match:ut,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(yt,wt),t[3]=(t[3]||t[4]||t[5]||"").replace(yt,wt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return ut.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&ht.test(i)&&(e=k(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(yt,wt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=F[t+" "];return e||(e=new RegExp("(^|"+et+")"+t+"("+et+"|$)"))&&F(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(o){var s=e.attr(o,t);return null==s?"!="===i:!i||(s+="","="===i?s===n:"!="===i?s!==n:"^="===i?n&&0===s.indexOf(n):"*="===i?n&&s.indexOf(n)>-1:"$="===i?n&&s.slice(-n.length)===n:"~="===i?(" "+s.replace(st," ")+" ").indexOf(n)>-1:"|="===i&&(s===n||s.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,i,n,o){var s="nth"!==t.slice(0,3),r="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===o?function(t){return!!t.parentNode}:function(e,i,l){var c,h,d,u,p,m,f=s!==r?"nextSibling":"previousSibling",g=e.parentNode,v=a&&e.nodeName.toLowerCase(),b=!l&&!a,y=!1;if(g){if(s){for(;f;){for(u=e;u=u[f];)if(a?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;m=f="only"===t&&!m&&"nextSibling"}return!0}if(m=[r?g.firstChild:g.lastChild],r&&b){for(u=g,d=u[V]||(u[V]={}),h=d[u.uniqueID]||(d[u.uniqueID]={}),c=h[t]||[],p=c[0]===R&&c[1],y=p&&c[2],u=p&&g.childNodes[p];u=++p&&u&&u[f]||(y=p=0)||m.pop();)if(1===u.nodeType&&++y&&u===e){h[t]=[R,p,y];break}}else if(b&&(u=e,d=u[V]||(u[V]={}),h=d[u.uniqueID]||(d[u.uniqueID]={}),c=h[t]||[],p=c[0]===R&&c[1],y=p),!1===y)for(;(u=++p&&u&&u[f]||(y=p=0)||m.pop())&&((a?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++y||(b&&(d=u[V]||(u[V]={}),h=d[u.uniqueID]||(d[u.uniqueID]={}),h[t]=[R,y]),u!==e)););return(y-=o)===n||y%n==0&&y/n>=0}}},PSEUDO:function(t,i){var o,s=C.pseudos[t]||C.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return s[V]?s(i):s.length>1?(o=[t,t,"",i],C.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,o=s(t,i),r=o.length;r--;)n=Z(t,o[r]),t[n]=!(e[n]=o[r])}):function(t){return s(t,0,o)}):s}},pseudos:{not:n(function(t){var e=[],i=[],o=S(t.replace(rt,"$1"));return o[V]?n(function(t,e,i,n){for(var s,r=o(t,null,n,[]),a=t.length;a--;)(s=r[a])&&(t[a]=!(e[a]=s))}):function(t,n,s){return e[0]=t,o(e,null,s,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(yt,wt),function(e){return(e.textContent||x(e)).indexOf(t)>-1}}),lang:n(function(t){return dt.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(yt,wt).toLowerCase(),function(e){var i;do{if(i=$?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===M},focus:function(t){return t===U.activeElement&&(!U.hasFocus||U.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:a(!1),disabled:a(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!C.pseudos.empty(t)},header:function(t){return ft.test(t.nodeName)},input:function(t){return mt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,i){return[i<0?i+e:i]}),even:l(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:l(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:l(function(t,e,i){for(var n=i<0?i+e:i>e?e:i;--n>=0;)t.push(n);return t}),gt:l(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}},C.pseudos.nth=C.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[y]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(y);for(y in{submit:!0,reset:!0})C.pseudos[y]=function(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}(y);return h.prototype=C.filters=C.pseudos,C.setFilters=new h,k=e.tokenize=function(t,i){var n,o,s,r,a,l,c,h=B[t+" "];if(h)return i?0:h.slice(0);for(a=t,l=[],c=C.preFilter;a;){n&&!(o=at.exec(a))||(o&&(a=a.slice(o[0].length)||a),l.push(s=[])),n=!1,(o=lt.exec(a))&&(n=o.shift(),s.push({value:n,type:o[0].replace(rt," ")}),a=a.slice(n.length));for(r in C.filter)!(o=ut[r].exec(a))||c[r]&&!(o=c[r](o))||(n=o.shift(),s.push({value:n,type:r,matches:o}),a=a.slice(n.length));if(!n)break}return i?a.length:a?e.error(t):B(t,l).slice(0)},S=e.compile=function(t,e){var i,n=[],o=[],s=j[t+" "];if(!s){for(e||(e=k(t)),i=e.length;i--;)s=v(e[i]),s[V]?n.push(s):o.push(s);s=j(t,b(o,n)),s.selector=t}return s},T=e.select=function(t,e,i,n){var o,s,r,a,l,h="function"==typeof t&&t,u=!n&&k(t=h.selector||t);if(i=i||[],1===u.length){if(s=u[0]=u[0].slice(0),s.length>2&&"ID"===(r=s[0]).type&&9===e.nodeType&&$&&C.relative[s[1].type]){if(!(e=(C.find.ID(r.matches[0].replace(yt,wt),e)||[])[0]))return i;h&&(e=e.parentNode),t=t.slice(s.shift().value.length)}for(o=ut.needsContext.test(t)?0:s.length;o--&&(r=s[o],!C.relative[a=r.type]);)if((l=C.find[a])&&(n=l(r.matches[0].replace(yt,wt),bt.test(s[0].type)&&c(e.parentNode)||e))){if(s.splice(o,1),!(t=n.length&&d(s)))return J.apply(i,n),i;break}}return(h||S(t,u))(n,e,!$,i,!e||bt.test(t)&&c(e.parentNode)||e),i},w.sortStable=V.split("").sort(q).join("")===V,w.detectDuplicates=!!D,A(),w.sortDetached=o(function(t){return 1&t.compareDocumentPosition(U.createElement("fieldset"))}),o(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||s("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),w.attributes&&o(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||s("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),o(function(t){return null==t.getAttribute("disabled")})||s(tt,function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(t);_t.find=kt,_t.expr=kt.selectors,_t.expr[":"]=_t.expr.pseudos,_t.uniqueSort=_t.unique=kt.uniqueSort,_t.text=kt.getText,_t.isXMLDoc=kt.isXML,_t.contains=kt.contains,_t.escapeSelector=kt.escape;var St=function(t,e,i){for(var n=[],o=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&_t(t).is(i))break;n.push(t)}return n},Tt=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},It=_t.expr.match.needsContext,Et=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;_t.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?_t.find.matchesSelector(n,t)?[n]:[]:_t.find.matches(t,_t.grep(e,function(t){return 1===t.nodeType}))},_t.fn.extend({find:function(t){var e,i,n=this.length,o=this;if("string"!=typeof t)return this.pushStack(_t(t).filter(function(){for(e=0;e<n;e++)if(_t.contains(o[e],this))return!0}));for(i=this.pushStack([]),e=0;e<n;e++)_t.find(t,o[e],i);return n>1?_t.uniqueSort(i):i},filter:function(t){return this.pushStack(r(this,t||[],!1))},not:function(t){return this.pushStack(r(this,t||[],!0))},is:function(t){return!!r(this,"string"==typeof t&&It.test(t)?_t(t):t||[],!1).length}});var Dt,At=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(_t.fn.init=function(t,e,i){var n,o;if(!t)return this;if(i=i||Dt,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:At.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof _t?e[0]:e,_t.merge(this,_t.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:Ct,!0)),Et.test(n[1])&&_t.isPlainObject(e))for(n in e)yt(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return o=Ct.getElementById(n[2]),o&&(this[0]=o,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):yt(t)?void 0!==i.ready?i.ready(t):t(_t):_t.makeArray(t,this)}).prototype=_t.fn,Dt=_t(Ct);var Ut=/^(?:parents|prev(?:Until|All))/,Mt={children:!0,contents:!0,next:!0,prev:!0};_t.fn.extend({has:function(t){var e=_t(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(_t.contains(this,e[t]))return!0})},closest:function(t,e){var i,n=0,o=this.length,s=[],r="string"!=typeof t&&_t(t);if(!It.test(t))for(;n<o;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(r?r.index(i)>-1:1===i.nodeType&&_t.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(s.length>1?_t.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?ut.call(_t(t),this[0]):ut.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(_t.uniqueSort(_t.merge(this.get(),_t(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),_t.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return St(t,"parentNode")},parentsUntil:function(t,e,i){return St(t,"parentNode",i)},next:function(t){return a(t,"nextSibling")},prev:function(t){return a(t,"previousSibling")},nextAll:function(t){return St(t,"nextSibling")},prevAll:function(t){return St(t,"previousSibling")},nextUntil:function(t,e,i){return St(t,"nextSibling",i)},prevUntil:function(t,e,i){return St(t,"previousSibling",i)},siblings:function(t){return Tt((t.parentNode||{}).firstChild,t)},children:function(t){return Tt(t.firstChild)},contents:function(t){return null!=t.contentDocument&&lt(t.contentDocument)?t.contentDocument:(s(t,"template")&&(t=t.content||t),_t.merge([],t.childNodes))}},function(t,e){_t.fn[t]=function(i,n){var o=_t.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=_t.filter(n,o)),this.length>1&&(Mt[t]||_t.uniqueSort(o),Ut.test(t)&&o.reverse()),this.pushStack(o)}});var $t=/[^\x20\t\r\n\f]+/g;_t.Callbacks=function(t){t="string"==typeof t?l(t):_t.extend({},t);var e,i,o,s,r=[],a=[],c=-1,h=function(){for(s=s||t.once,o=e=!0;a.length;c=-1)for(i=a.shift();++c<r.length;)!1===r[c].apply(i[0],i[1])&&t.stopOnFalse&&(c=r.length,i=!1);t.memory||(i=!1),e=!1,s&&(r=i?[]:"")},d={add:function(){return r&&(i&&!e&&(c=r.length-1,a.push(i)),function e(i){_t.each(i,function(i,o){yt(o)?t.unique&&d.has(o)||r.push(o):o&&o.length&&"string"!==n(o)&&e(o)})}(arguments),i&&!e&&h()),this},remove:function(){return _t.each(arguments,function(t,e){for(var i;(i=_t.inArray(e,r,i))>-1;)r.splice(i,1),i<=c&&c--}),this},has:function(t){return t?_t.inArray(t,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return s=a=[],r=i="",this},disabled:function(){return!r},lock:function(){return s=a=[],i||e||(r=i=""),this},locked:function(){return!!s},fireWith:function(t,i){return s||(i=i||[],i=[t,i.slice?i.slice():i],a.push(i),e||h()),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!o}};return d},_t.extend({Deferred:function(e){var i=[["notify","progress",_t.Callbacks("memory"),_t.Callbacks("memory"),2],["resolve","done",_t.Callbacks("once memory"),_t.Callbacks("once memory"),0,"resolved"],["reject","fail",_t.Callbacks("once memory"),_t.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(t){return o.then(null,t)},pipe:function(){var t=arguments;return _t.Deferred(function(e){_t.each(i,function(i,n){var o=yt(t[n[4]])&&t[n[4]];s[n[1]](function(){var t=o&&o.apply(this,arguments)
;t&&yt(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[n[0]+"With"](this,o?[t]:arguments)})}),t=null}).promise()},then:function(e,n,o){function s(e,i,n,o){return function(){var a=this,l=arguments,d=function(){var t,d;if(!(e<r)){if((t=n.apply(a,l))===i.promise())throw new TypeError("Thenable self-resolution");d=t&&("object"==typeof t||"function"==typeof t)&&t.then,yt(d)?o?d.call(t,s(r,i,c,o),s(r,i,h,o)):(r++,d.call(t,s(r,i,c,o),s(r,i,h,o),s(r,i,c,i.notifyWith))):(n!==c&&(a=void 0,l=[t]),(o||i.resolveWith)(a,l))}},u=o?d:function(){try{d()}catch(t){_t.Deferred.exceptionHook&&_t.Deferred.exceptionHook(t,u.stackTrace),e+1>=r&&(n!==h&&(a=void 0,l=[t]),i.rejectWith(a,l))}};e?u():(_t.Deferred.getStackHook&&(u.stackTrace=_t.Deferred.getStackHook()),t.setTimeout(u))}}var r=0;return _t.Deferred(function(t){i[0][3].add(s(0,t,yt(o)?o:c,t.notifyWith)),i[1][3].add(s(0,t,yt(e)?e:c)),i[2][3].add(s(0,t,yt(n)?n:h))}).promise()},promise:function(t){return null!=t?_t.extend(t,o):o}},s={};return _t.each(i,function(t,e){var r=e[2],a=e[5];o[e[1]]=r.add,a&&r.add(function(){n=a},i[3-t][2].disable,i[3-t][3].disable,i[0][2].lock,i[0][3].lock),r.add(e[3].fire),s[e[0]]=function(){return s[e[0]+"With"](this===s?void 0:this,arguments),this},s[e[0]+"With"]=r.fireWith}),o.promise(s),e&&e.call(s,s),s},when:function(t){var e=arguments.length,i=e,n=Array(i),o=ct.call(arguments),s=_t.Deferred(),r=function(t){return function(i){n[t]=this,o[t]=arguments.length>1?ct.call(arguments):i,--e||s.resolveWith(n,o)}};if(e<=1&&(d(t,s.done(r(i)).resolve,s.reject,!e),"pending"===s.state()||yt(o[i]&&o[i].then)))return s.then();for(;i--;)d(o[i],r(i),s.reject);return s.promise()}});var Pt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;_t.Deferred.exceptionHook=function(e,i){t.console&&t.console.warn&&e&&Pt.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,i)},_t.readyException=function(e){t.setTimeout(function(){throw e})};var Ot=_t.Deferred();_t.fn.ready=function(t){return Ot.then(t).catch(function(t){_t.readyException(t)}),this},_t.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--_t.readyWait:_t.isReady)||(_t.isReady=!0,!0!==t&&--_t.readyWait>0||Ot.resolveWith(Ct,[_t]))}}),_t.ready.then=Ot.then,"complete"===Ct.readyState||"loading"!==Ct.readyState&&!Ct.documentElement.doScroll?t.setTimeout(_t.ready):(Ct.addEventListener("DOMContentLoaded",u),t.addEventListener("load",u));var Lt=function(t,e,i,o,s,r,a){var l=0,c=t.length,h=null==i;if("object"===n(i)){s=!0;for(l in i)Lt(t,e,l,i[l],!0,r,a)}else if(void 0!==o&&(s=!0,yt(o)||(a=!0),h&&(a?(e.call(t,o),e=null):(h=e,e=function(t,e,i){return h.call(_t(t),i)})),e))for(;l<c;l++)e(t[l],i,a?o:o.call(t[l],l,e(t[l],i)));return s?t:h?e.call(t):c?e(t[0],i):r},zt=/^-ms-/,Vt=/-([a-z])/g,Nt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};f.uid=1,f.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Nt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,o=this.cache(t);if("string"==typeof e)o[m(e)]=i;else for(n in e)o[m(n)]=e[n];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][m(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){Array.isArray(e)?e=e.map(m):(e=m(e),e=e in n?[e]:e.match($t)||[]),i=e.length;for(;i--;)delete n[e[i]]}(void 0===e||_t.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!_t.isEmptyObject(e)}};var Rt=new f,Ht=new f,Ft=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Bt=/[A-Z]/g;_t.extend({hasData:function(t){return Ht.hasData(t)||Rt.hasData(t)},data:function(t,e,i){return Ht.access(t,e,i)},removeData:function(t,e){Ht.remove(t,e)},_data:function(t,e,i){return Rt.access(t,e,i)},_removeData:function(t,e){Rt.remove(t,e)}}),_t.fn.extend({data:function(t,e){var i,n,o,s=this[0],r=s&&s.attributes;if(void 0===t){if(this.length&&(o=Ht.get(s),1===s.nodeType&&!Rt.get(s,"hasDataAttrs"))){for(i=r.length;i--;)r[i]&&(n=r[i].name,0===n.indexOf("data-")&&(n=m(n.slice(5)),v(s,n,o[n])));Rt.set(s,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each(function(){Ht.set(this,t)}):Lt(this,function(e){var i;if(s&&void 0===e){if(void 0!==(i=Ht.get(s,t)))return i;if(void 0!==(i=v(s,t)))return i}else this.each(function(){Ht.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Ht.remove(this,t)})}}),_t.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=Rt.get(t,e),i&&(!n||Array.isArray(i)?n=Rt.access(t,e,_t.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=_t.queue(t,e),n=i.length,o=i.shift(),s=_t._queueHooks(t,e),r=function(){_t.dequeue(t,e)};"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===e&&i.unshift("inprogress"),delete s.stop,o.call(t,r,s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return Rt.get(t,i)||Rt.access(t,i,{empty:_t.Callbacks("once memory").add(function(){Rt.remove(t,[e+"queue",i])})})}}),_t.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?_t.queue(this[0],t):void 0===e?this:this.each(function(){var i=_t.queue(this,t,e);_t._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&_t.dequeue(this,t)})},dequeue:function(t){return this.each(function(){_t.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,o=_t.Deferred(),s=this,r=this.length,a=function(){--n||o.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";r--;)(i=Rt.get(s[r],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),o.promise(e)}});var jt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Wt=new RegExp("^(?:([+-])=|)("+jt+")([a-z%]*)$","i"),qt=["Top","Right","Bottom","Left"],Kt=Ct.documentElement,Yt=function(t){return _t.contains(t.ownerDocument,t)},Gt={composed:!0};Kt.getRootNode&&(Yt=function(t){return _t.contains(t.ownerDocument,t)||t.getRootNode(Gt)===t.ownerDocument});var Xt=function(t,e){return t=e||t,"none"===t.style.display||""===t.style.display&&Yt(t)&&"none"===_t.css(t,"display")},Jt={};_t.fn.extend({show:function(){return w(this,!0)},hide:function(){return w(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Xt(this)?_t(this).show():_t(this).hide()})}});var Qt=/^(?:checkbox|radio)$/i,Zt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,te=/^$|^module$|\/(?:java|ecma)script/i;!function(){var t=Ct.createDocumentFragment(),e=t.appendChild(Ct.createElement("div")),i=Ct.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),bt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",bt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,e.innerHTML="<option></option>",bt.option=!!e.lastChild}();var ee={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ee.tbody=ee.tfoot=ee.colgroup=ee.caption=ee.thead,ee.th=ee.td,bt.option||(ee.optgroup=ee.option=[1,"<select multiple='multiple'>","</select>"]);var ie=/<|&#?\w+;/,ne=/^key/,oe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,se=/^([^.]*)(?:\.(.+)|)/;_t.event={global:{},add:function(t,e,i,n,o){var s,r,a,l,c,h,d,u,p,m,f,g=Rt.get(t);if(Nt(t))for(i.handler&&(s=i,i=s.handler,o=s.selector),o&&_t.find.matchesSelector(Kt,o),i.guid||(i.guid=_t.guid++),(l=g.events)||(l=g.events=Object.create(null)),(r=g.handle)||(r=g.handle=function(e){return void 0!==_t&&_t.event.triggered!==e.type?_t.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match($t)||[""],c=e.length;c--;)a=se.exec(e[c])||[],p=f=a[1],m=(a[2]||"").split(".").sort(),p&&(d=_t.event.special[p]||{},p=(o?d.delegateType:d.bindType)||p,d=_t.event.special[p]||{},h=_t.extend({type:p,origType:f,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&_t.expr.match.needsContext.test(o),namespace:m.join(".")},s),(u=l[p])||(u=l[p]=[],u.delegateCount=0,d.setup&&!1!==d.setup.call(t,n,m,r)||t.addEventListener&&t.addEventListener(p,r)),d.add&&(d.add.call(t,h),h.handler.guid||(h.handler.guid=i.guid)),o?u.splice(u.delegateCount++,0,h):u.push(h),_t.event.global[p]=!0)},remove:function(t,e,i,n,o){var s,r,a,l,c,h,d,u,p,m,f,g=Rt.hasData(t)&&Rt.get(t);if(g&&(l=g.events)){for(e=(e||"").match($t)||[""],c=e.length;c--;)if(a=se.exec(e[c])||[],p=f=a[1],m=(a[2]||"").split(".").sort(),p){for(d=_t.event.special[p]||{},p=(n?d.delegateType:d.bindType)||p,u=l[p]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),r=s=u.length;s--;)h=u[s],!o&&f!==h.origType||i&&i.guid!==h.guid||a&&!a.test(h.namespace)||n&&n!==h.selector&&("**"!==n||!h.selector)||(u.splice(s,1),h.selector&&u.delegateCount--,d.remove&&d.remove.call(t,h));r&&!u.length&&(d.teardown&&!1!==d.teardown.call(t,m,g.handle)||_t.removeEvent(t,p,g.handle),delete l[p])}else for(p in l)_t.event.remove(t,p+e[c],i,n,!0);_t.isEmptyObject(l)&&Rt.remove(t,"handle events")}},dispatch:function(t){var e,i,n,o,s,r,a=new Array(arguments.length),l=_t.event.fix(t),c=(Rt.get(this,"events")||Object.create(null))[l.type]||[],h=_t.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,l)){for(r=_t.event.handlers.call(this,l,c),e=0;(o=r[e++])&&!l.isPropagationStopped();)for(l.currentTarget=o.elem,i=0;(s=o.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==s.namespace&&!l.rnamespace.test(s.namespace)||(l.handleObj=s,l.data=s.data,void 0!==(n=((_t.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,a))&&!1===(l.result=n)&&(l.preventDefault(),l.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,l),l.result}},handlers:function(t,e){var i,n,o,s,r,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(s=[],r={},i=0;i<l;i++)n=e[i],o=n.selector+" ",void 0===r[o]&&(r[o]=n.needsContext?_t(o,this).index(c)>-1:_t.find(o,this,null,[c]).length),r[o]&&s.push(n);s.length&&a.push({elem:c,handlers:s})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(_t.Event.prototype,t,{enumerable:!0,configurable:!0,get:yt(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[_t.expando]?t:new _t.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return Qt.test(e.type)&&e.click&&s(e,"input")&&D(e,"click",k),!1},trigger:function(t){var e=this||t;return Qt.test(e.type)&&e.click&&s(e,"input")&&D(e,"click"),!0},_default:function(t){var e=t.target;return Qt.test(e.type)&&e.click&&s(e,"input")&&Rt.get(e,"click")||s(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},_t.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},_t.Event=function(t,e){if(!(this instanceof _t.Event))return new _t.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?k:S,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&_t.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[_t.expando]=!0},_t.Event.prototype={constructor:_t.Event,isDefaultPrevented:S,isPropagationStopped:S,isImmediatePropagationStopped:S,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=k,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=k,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=k,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},_t.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&ne.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&oe.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},_t.event.addProp),_t.each({focus:"focusin",blur:"focusout"},function(t,e){_t.event.special[t]={setup:function(){return D(this,t,T),!1},trigger:function(){return D(this,t),!0},delegateType:e}}),_t.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){_t.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,o=t.relatedTarget,s=t.handleObj;return o&&(o===n||_t.contains(n,o))||(t.type=s.origType,i=s.handler.apply(this,arguments),t.type=e),i}}}),_t.fn.extend({on:function(t,e,i,n){return E(this,t,e,i,n)},one:function(t,e,i,n){return E(this,t,e,i,n,1)},off:function(t,e,i){var n,o;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,_t(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=S),this.each(function(){_t.event.remove(this,t,i,e)})}});var re=/<script|<style|<link/i,ae=/checked\s*(?:[^=]|=\s*.checked.)/i,le=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;_t.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var n,o,s,r,a=t.cloneNode(!0),l=Yt(t);if(!(bt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||_t.isXMLDoc(t)))for(r=C(a),s=C(t),n=0,o=s.length;n<o;n++)P(s[n],r[n]);if(e)if(i)for(s=s||C(t),r=r||C(a),n=0,o=s.length;n<o;n++)$(s[n],r[n]);else $(t,a);return r=C(a,"script"),r.length>0&&x(r,!l&&C(t,"script")),a},cleanData:function(t){for(var e,i,n,o=_t.event.special,s=0;void 0!==(i=t[s]);s++)if(Nt(i)){if(e=i[Rt.expando]){if(e.events)for(n in e.events)o[n]?_t.event.remove(i,n):_t.removeEvent(i,n,e.handle);i[Rt.expando]=void 0}i[Ht.expando]&&(i[Ht.expando]=void 0)}}}),_t.fn.extend({detach:function(t){return L(this,t,!0)},remove:function(t){return L(this,t)},text:function(t){return Lt(this,function(t){return void 0===t?_t.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return O(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){A(this,t).appendChild(t)}})},prepend:function(){return O(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=A(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return O(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return O(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(_t.cleanData(C(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return _t.clone(this,t,e)})},html:function(t){return Lt(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!re.test(t)&&!ee[(Zt.exec(t)||["",""])[1].toLowerCase()]){t=_t.htmlPrefilter(t);try{for(;i<n;i++)e=this[i]||{},1===e.nodeType&&(_t.cleanData(C(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return O(this,arguments,function(e){var i=this.parentNode;_t.inArray(this,t)<0&&(_t.cleanData(C(this)),i&&i.replaceChild(e,this))},t)}}),_t.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){_t.fn[t]=function(t){for(var i,n=[],o=_t(t),s=o.length-1,r=0;r<=s;r++)i=r===s?this:this.clone(!0),_t(o[r])[e](i),dt.apply(n,i.get());return this.pushStack(n)}});var ce=new RegExp("^("+jt+")(?!px)[a-z%]+$","i"),he=function(e){var i=e.ownerDocument.defaultView;return i&&i.opener||(i=t),i.getComputedStyle(e)},de=function(t,e,i){var n,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];n=i.call(t);for(o in e)t.style[o]=s[o];return n},ue=new RegExp(qt.join("|"),"i");!function(){function e(){if(h){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",h.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Kt.appendChild(c).appendChild(h);var e=t.getComputedStyle(h);n="1%"!==e.top,l=12===i(e.marginLeft),h.style.right="60%",r=36===i(e.right),o=36===i(e.width),h.style.position="absolute",s=12===i(h.offsetWidth/3),Kt.removeChild(c),h=null}}function i(t){return Math.round(parseFloat(t))}var n,o,s,r,a,l,c=Ct.createElement("div"),h=Ct.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",bt.clearCloneStyle="content-box"===h.style.backgroundClip,_t.extend(bt,{boxSizingReliable:function(){return e(),o},pixelBoxStyles:function(){return e(),r},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),s},reliableTrDimensions:function(){var e,i,n,o;return null==a&&(e=Ct.createElement("table"),i=Ct.createElement("tr"),n=Ct.createElement("div"),e.style.cssText="position:absolute;left:-11111px",i.style.height="1px",n.style.height="9px",Kt.appendChild(e).appendChild(i).appendChild(n),o=t.getComputedStyle(i),a=parseInt(o.height)>3,Kt.removeChild(e)),a}}))}();var pe=["Webkit","Moz","ms"],me=Ct.createElement("div").style,fe={},ge=/^(none|table(?!-c[ea]).+)/,ve=/^--/,be={position:"absolute",visibility:"hidden",display:"block"},ye={letterSpacing:"0",fontWeight:"400"};_t.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=z(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,s,r,a=m(e),l=ve.test(e),c=t.style;if(l||(e=R(a)),r=_t.cssHooks[e]||_t.cssHooks[a],void 0===i)return r&&"get"in r&&void 0!==(o=r.get(t,!1,n))?o:c[e];s=typeof i,"string"===s&&(o=Wt.exec(i))&&o[1]&&(i=b(t,e,o),s="number"),null!=i&&i===i&&("number"!==s||l||(i+=o&&o[3]||(_t.cssNumber[a]?"":"px")),bt.clearCloneStyle||""!==i||0!==e.indexOf("background")||(c[e]="inherit"),r&&"set"in r&&void 0===(i=r.set(t,i,n))||(l?c.setProperty(e,i):c[e]=i))}},css:function(t,e,i,n){var o,s,r,a=m(e);return ve.test(e)||(e=R(a)),r=_t.cssHooks[e]||_t.cssHooks[a],r&&"get"in r&&(o=r.get(t,!0,i)),void 0===o&&(o=z(t,e,n)),"normal"===o&&e in ye&&(o=ye[e]),""===i||i?(s=parseFloat(o),!0===i||isFinite(s)?s||0:o):o}}),_t.each(["height","width"],function(t,e){_t.cssHooks[e]={get:function(t,i,n){if(i)return!ge.test(_t.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?B(t,e,n):de(t,be,function(){return B(t,e,n)})},set:function(t,i,n){var o,s=he(t),r=!bt.scrollboxSize()&&"absolute"===s.position,a=r||n,l=a&&"border-box"===_t.css(t,"boxSizing",!1,s),c=n?F(t,e,n,l,s):0;return l&&r&&(c-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-F(t,e,"border",!1,s)-.5)),c&&(o=Wt.exec(i))&&"px"!==(o[3]||"px")&&(t.style[e]=i,i=_t.css(t,e)),H(t,i,c)}}}),_t.cssHooks.marginLeft=V(bt.reliableMarginLeft,function(t,e){if(e)return(parseFloat(z(t,"marginLeft"))||t.getBoundingClientRect().left-de(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),_t.each({margin:"",padding:"",border:"Width"},function(t,e){_t.cssHooks[t+e]={expand:function(i){for(var n=0,o={},s="string"==typeof i?i.split(" "):[i];n<4;n++)o[t+qt[n]+e]=s[n]||s[n-2]||s[0];return o}},"margin"!==t&&(_t.cssHooks[t+e].set=H)}),_t.fn.extend({css:function(t,e){return Lt(this,function(t,e,i){var n,o,s={},r=0;if(Array.isArray(e)){for(n=he(t),o=e.length;r<o;r++)s[e[r]]=_t.css(t,e[r],!1,n);return s}return void 0!==i?_t.style(t,e,i):_t.css(t,e)},t,e,arguments.length>1)}}),_t.Tween=j,j.prototype={constructor:j,init:function(t,e,i,n,o,s){this.elem=t,this.prop=i,this.easing=o||_t.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(_t.cssNumber[i]?"":"px")},cur:function(){var t=j.propHooks[this.prop];return t&&t.get?t.get(this):j.propHooks._default.get(this)},run:function(t){var e,i=j.propHooks[this.prop];return this.options.duration?this.pos=e=_t.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):j.propHooks._default.set(this),this}},j.prototype.init.prototype=j.prototype,j.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=_t.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){_t.fx.step[t.prop]?_t.fx.step[t.prop](t):1!==t.elem.nodeType||!_t.cssHooks[t.prop]&&null==t.elem.style[R(t.prop)]?t.elem[t.prop]=t.now:_t.style(t.elem,t.prop,t.now+t.unit)}}},j.propHooks.scrollTop=j.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},_t.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},_t.fx=j.prototype.init,_t.fx.step={};var we,Ce,xe=/^(?:toggle|show|hide)$/,_e=/queueHooks$/;_t.Animation=_t.extend(J,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return b(i.elem,t,Wt.exec(e),i),i}]},tweener:function(t,e){yt(t)?(e=t,t=["*"]):t=t.match($t);for(var i,n=0,o=t.length;n<o;n++)i=t[n],J.tweeners[i]=J.tweeners[i]||[],J.tweeners[i].unshift(e)},prefilters:[G],prefilter:function(t,e){e?J.prefilters.unshift(t):J.prefilters.push(t)}}),_t.speed=function(t,e,i){var n=t&&"object"==typeof t?_t.extend({},t):{complete:i||!i&&e||yt(t)&&t,duration:t,easing:i&&e||e&&!yt(e)&&e};return _t.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in _t.fx.speeds?n.duration=_t.fx.speeds[n.duration]:n.duration=_t.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){yt(n.old)&&n.old.call(this),n.queue&&_t.dequeue(this,n.queue)},n},_t.fn.extend({fadeTo:function(t,e,i,n){return this.filter(Xt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var o=_t.isEmptyObject(t),s=_t.speed(e,i,n),r=function(){var e=J(this,_t.extend({},t),s);(o||Rt.get(this,"finish"))&&e.stop(!0)};return r.finish=r,o||!1===s.queue?this.each(r):this.queue(s.queue,r)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each(function(){var e=!0,o=null!=t&&t+"queueHooks",s=_t.timers,r=Rt.get(this);if(o)r[o]&&r[o].stop&&n(r[o]);else for(o in r)r[o]&&r[o].stop&&_e.test(o)&&n(r[o]);for(o=s.length;o--;)s[o].elem!==this||null!=t&&s[o].queue!==t||(s[o].anim.stop(i),e=!1,s.splice(o,1));!e&&i||_t.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,i=Rt.get(this),n=i[t+"queue"],o=i[t+"queueHooks"],s=_t.timers,r=n?n.length:0;for(i.finish=!0,_t.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;e<r;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),_t.each(["toggle","show","hide"],function(t,e){var i=_t.fn[e];_t.fn[e]=function(t,n,o){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(K(e,!0),t,n,o)}}),_t.each({slideDown:K("show"),slideUp:K("hide"),slideToggle:K("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){_t.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),_t.timers=[],_t.fx.tick=function(){var t,e=0,i=_t.timers;for(we=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||_t.fx.stop(),we=void 0},_t.fx.timer=function(t){_t.timers.push(t),_t.fx.start()},_t.fx.interval=13,_t.fx.start=function(){Ce||(Ce=!0,W())},_t.fx.stop=function(){Ce=null},_t.fx.speeds={slow:600,fast:200,_default:400},_t.fn.delay=function(e,i){return e=_t.fx?_t.fx.speeds[e]||e:e,i=i||"fx",this.queue(i,function(i,n){var o=t.setTimeout(i,e);n.stop=function(){t.clearTimeout(o)}})},function(){var t=Ct.createElement("input"),e=Ct.createElement("select"),i=e.appendChild(Ct.createElement("option"));t.type="checkbox",bt.checkOn=""!==t.value,bt.optSelected=i.selected,t=Ct.createElement("input"),t.value="t",t.type="radio",bt.radioValue="t"===t.value}();var ke,Se=_t.expr.attrHandle;_t.fn.extend({attr:function(t,e){return Lt(this,_t.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){_t.removeAttr(this,t)})}}),_t.extend({attr:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?_t.prop(t,e,i):(1===s&&_t.isXMLDoc(t)||(o=_t.attrHooks[e.toLowerCase()]||(_t.expr.match.bool.test(e)?ke:void 0)),void 0!==i?null===i?void _t.removeAttr(t,e):o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:(t.setAttribute(e,i+""),i):o&&"get"in o&&null!==(n=o.get(t,e))?n:(n=_t.find.attr(t,e),null==n?void 0:n))},attrHooks:{type:{set:function(t,e){if(!bt.radioValue&&"radio"===e&&s(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,o=e&&e.match($t);if(o&&1===t.nodeType)for(;i=o[n++];)t.removeAttribute(i)}}),ke={set:function(t,e,i){return!1===e?_t.removeAttr(t,i):t.setAttribute(i,i),i}},_t.each(_t.expr.match.bool.source.match(/\w+/g),function(t,e){var i=Se[e]||_t.find.attr;Se[e]=function(t,e,n){var o,s,r=e.toLowerCase();return n||(s=Se[r],Se[r]=o,o=null!=i(t,e,n)?r:null,Se[r]=s),o}});var Te=/^(?:input|select|textarea|button)$/i,Ie=/^(?:a|area)$/i;_t.fn.extend({prop:function(t,e){return Lt(this,_t.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[_t.propFix[t]||t]})}}),_t.extend({prop:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&_t.isXMLDoc(t)||(e=_t.propFix[e]||e,o=_t.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:t[e]=i:o&&"get"in o&&null!==(n=o.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=_t.find.attr(t,"tabindex");return e?parseInt(e,10):Te.test(t.nodeName)||Ie.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),bt.optSelected||(_t.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),_t.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){_t.propFix[this.toLowerCase()]=this}),_t.fn.extend({addClass:function(t){var e,i,n,o,s,r,a,l=0;if(yt(t))return this.each(function(e){_t(this).addClass(t.call(this,e,Z(this)))});if(e=tt(t),e.length)for(;i=this[l++];)if(o=Z(i),n=1===i.nodeType&&" "+Q(o)+" "){for(r=0;s=e[r++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");a=Q(n),o!==a&&i.setAttribute("class",a)}return this},removeClass:function(t){var e,i,n,o,s,r,a,l=0;if(yt(t))return this.each(function(e){_t(this).removeClass(t.call(this,e,Z(this)))});if(!arguments.length)return this.attr("class","");if(e=tt(t),e.length)for(;i=this[l++];)if(o=Z(i),n=1===i.nodeType&&" "+Q(o)+" "){for(r=0;s=e[r++];)for(;n.indexOf(" "+s+" ")>-1;)n=n.replace(" "+s+" "," ");a=Q(n),o!==a&&i.setAttribute("class",a)}return this},toggleClass:function(t,e){var i=typeof t,n="string"===i||Array.isArray(t);return"boolean"==typeof e&&n?e?this.addClass(t):this.removeClass(t):yt(t)?this.each(function(i){_t(this).toggleClass(t.call(this,i,Z(this),e),e)}):this.each(function(){var e,o,s,r;if(n)for(o=0,s=_t(this),r=tt(t);e=r[o++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else void 0!==t&&"boolean"!==i||(e=Z(this),e&&Rt.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Rt.get(this,"__className__")||""))})},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+Q(Z(i))+" ").indexOf(e)>-1)return!0;return!1}});var Ee=/\r/g;_t.fn.extend({val:function(t){var e,i,n,o=this[0];{if(arguments.length)return n=yt(t),this.each(function(i){var o;1===this.nodeType&&(o=n?t.call(this,i,_t(this).val()):t,null==o?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=_t.map(o,function(t){return null==t?"":t+""})),(e=_t.valHooks[this.type]||_t.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))});if(o)return(e=_t.valHooks[o.type]||_t.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(o,"value"))?i:(i=o.value,"string"==typeof i?i.replace(Ee,""):null==i?"":i)}}}),_t.extend({valHooks:{option:{get:function(t){var e=_t.find.attr(t,"value");return null!=e?e:Q(_t.text(t))}},select:{get:function(t){var e,i,n,o=t.options,r=t.selectedIndex,a="select-one"===t.type,l=a?null:[],c=a?r+1:o.length;for(n=r<0?c:a?r:0;n<c;n++)if(i=o[n],(i.selected||n===r)&&!i.disabled&&(!i.parentNode.disabled||!s(i.parentNode,"optgroup"))){if(e=_t(i).val(),a)return e;l.push(e)}return l},set:function(t,e){for(var i,n,o=t.options,s=_t.makeArray(e),r=o.length;r--;)n=o[r],(n.selected=_t.inArray(_t.valHooks.option.get(n),s)>-1)&&(i=!0);return i||(t.selectedIndex=-1),s}}}}),_t.each(["radio","checkbox"],function(){_t.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=_t.inArray(_t(t).val(),e)>-1}},bt.checkOn||(_t.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),bt.focusin="onfocusin"in t;var De=/^(?:focusinfocus|focusoutblur)$/,Ae=function(t){t.stopPropagation()};_t.extend(_t.event,{trigger:function(e,i,n,o){var s,r,a,l,c,h,d,u,p=[n||Ct],m=ft.call(e,"type")?e.type:e,f=ft.call(e,"namespace")?e.namespace.split("."):[];if(r=u=a=n=n||Ct,3!==n.nodeType&&8!==n.nodeType&&!De.test(m+_t.event.triggered)&&(m.indexOf(".")>-1&&(f=m.split("."),m=f.shift(),f.sort()),c=m.indexOf(":")<0&&"on"+m,e=e[_t.expando]?e:new _t.Event(m,"object"==typeof e&&e),e.isTrigger=o?2:3,e.namespace=f.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:_t.makeArray(i,[e]),d=_t.event.special[m]||{},o||!d.trigger||!1!==d.trigger.apply(n,i))){if(!o&&!d.noBubble&&!wt(n)){for(l=d.delegateType||m,De.test(l+m)||(r=r.parentNode);r;r=r.parentNode)p.push(r),a=r;a===(n.ownerDocument||Ct)&&p.push(a.defaultView||a.parentWindow||t)}for(s=0;(r=p[s++])&&!e.isPropagationStopped();)u=r,e.type=s>1?l:d.bindType||m,h=(Rt.get(r,"events")||Object.create(null))[e.type]&&Rt.get(r,"handle"),h&&h.apply(r,i),(h=c&&r[c])&&h.apply&&Nt(r)&&(e.result=h.apply(r,i),!1===e.result&&e.preventDefault());return e.type=m,o||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(p.pop(),i)||!Nt(n)||c&&yt(n[m])&&!wt(n)&&(a=n[c],a&&(n[c]=null),_t.event.triggered=m,e.isPropagationStopped()&&u.addEventListener(m,Ae),n[m](),
e.isPropagationStopped()&&u.removeEventListener(m,Ae),_t.event.triggered=void 0,a&&(n[c]=a)),e.result}},simulate:function(t,e,i){var n=_t.extend(new _t.Event,i,{type:t,isSimulated:!0});_t.event.trigger(n,null,e)}}),_t.fn.extend({trigger:function(t,e){return this.each(function(){_t.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return _t.event.trigger(t,e,i,!0)}}),bt.focusin||_t.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){_t.event.simulate(e,t.target,_t.event.fix(t))};_t.event.special[e]={setup:function(){var n=this.ownerDocument||this.document||this,o=Rt.access(n,e);o||n.addEventListener(t,i,!0),Rt.access(n,e,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,o=Rt.access(n,e)-1;o?Rt.access(n,e,o):(n.removeEventListener(t,i,!0),Rt.remove(n,e))}}});var Ue=t.location,Me={guid:Date.now()},$e=/\?/;_t.parseXML=function(e){var i;if(!e||"string"!=typeof e)return null;try{i=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){i=void 0}return i&&!i.getElementsByTagName("parsererror").length||_t.error("Invalid XML: "+e),i};var Pe=/\[\]$/,Oe=/\r?\n/g,Le=/^(?:submit|button|image|reset|file)$/i,ze=/^(?:input|select|textarea|keygen)/i;_t.param=function(t,e){var i,n=[],o=function(t,e){var i=yt(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!_t.isPlainObject(t))_t.each(t,function(){o(this.name,this.value)});else for(i in t)et(i,t[i],e,o);return n.join("&")},_t.fn.extend({serialize:function(){return _t.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=_t.prop(this,"elements");return t?_t.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!_t(this).is(":disabled")&&ze.test(this.nodeName)&&!Le.test(t)&&(this.checked||!Qt.test(t))}).map(function(t,e){var i=_t(this).val();return null==i?null:Array.isArray(i)?_t.map(i,function(t){return{name:e.name,value:t.replace(Oe,"\r\n")}}):{name:e.name,value:i.replace(Oe,"\r\n")}}).get()}});var Ve=/%20/g,Ne=/#.*$/,Re=/([?&])_=[^&]*/,He=/^(.*?):[ \t]*([^\r\n]*)$/gm,Fe=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Be=/^(?:GET|HEAD)$/,je=/^\/\//,We={},qe={},Ke="*/".concat("*"),Ye=Ct.createElement("a");Ye.href=Ue.href,_t.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ue.href,type:"GET",isLocal:Fe.test(Ue.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ke,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":_t.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?ot(ot(t,_t.ajaxSettings),e):ot(_t.ajaxSettings,t)},ajaxPrefilter:it(We),ajaxTransport:it(qe),ajax:function(e,i){function n(e,i,n,a){var c,u,p,w,C,x=i;h||(h=!0,l&&t.clearTimeout(l),o=void 0,r=a||"",_.readyState=e>0?4:0,c=e>=200&&e<300||304===e,n&&(w=st(m,_,n)),!c&&_t.inArray("script",m.dataTypes)>-1&&(m.converters["text script"]=function(){}),w=rt(m,w,_,c),c?(m.ifModified&&(C=_.getResponseHeader("Last-Modified"),C&&(_t.lastModified[s]=C),(C=_.getResponseHeader("etag"))&&(_t.etag[s]=C)),204===e||"HEAD"===m.type?x="nocontent":304===e?x="notmodified":(x=w.state,u=w.data,p=w.error,c=!p)):(p=x,!e&&x||(x="error",e<0&&(e=0))),_.status=e,_.statusText=(i||x)+"",c?v.resolveWith(f,[u,x,_]):v.rejectWith(f,[_,x,p]),_.statusCode(y),y=void 0,d&&g.trigger(c?"ajaxSuccess":"ajaxError",[_,m,c?u:p]),b.fireWith(f,[_,x]),d&&(g.trigger("ajaxComplete",[_,m]),--_t.active||_t.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=void 0),i=i||{};var o,s,r,a,l,c,h,d,u,p,m=_t.ajaxSetup({},i),f=m.context||m,g=m.context&&(f.nodeType||f.jquery)?_t(f):_t.event,v=_t.Deferred(),b=_t.Callbacks("once memory"),y=m.statusCode||{},w={},C={},x="canceled",_={readyState:0,getResponseHeader:function(t){var e;if(h){if(!a)for(a={};e=He.exec(r);)a[e[1].toLowerCase()+" "]=(a[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=a[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return h?r:null},setRequestHeader:function(t,e){return null==h&&(t=C[t.toLowerCase()]=C[t.toLowerCase()]||t,w[t]=e),this},overrideMimeType:function(t){return null==h&&(m.mimeType=t),this},statusCode:function(t){var e;if(t)if(h)_.always(t[_.status]);else for(e in t)y[e]=[y[e],t[e]];return this},abort:function(t){var e=t||x;return o&&o.abort(e),n(0,e),this}};if(v.promise(_),m.url=((e||m.url||Ue.href)+"").replace(je,Ue.protocol+"//"),m.type=i.method||i.type||m.method||m.type,m.dataTypes=(m.dataType||"*").toLowerCase().match($t)||[""],null==m.crossDomain){c=Ct.createElement("a");try{c.href=m.url,c.href=c.href,m.crossDomain=Ye.protocol+"//"+Ye.host!=c.protocol+"//"+c.host}catch(t){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=_t.param(m.data,m.traditional)),nt(We,m,i,_),h)return _;d=_t.event&&m.global,d&&0==_t.active++&&_t.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Be.test(m.type),s=m.url.replace(Ne,""),m.hasContent?m.data&&m.processData&&0===(m.contentType||"").indexOf("application/x-www-form-urlencoded")&&(m.data=m.data.replace(Ve,"+")):(p=m.url.slice(s.length),m.data&&(m.processData||"string"==typeof m.data)&&(s+=($e.test(s)?"&":"?")+m.data,delete m.data),!1===m.cache&&(s=s.replace(Re,"$1"),p=($e.test(s)?"&":"?")+"_="+Me.guid+++p),m.url=s+p),m.ifModified&&(_t.lastModified[s]&&_.setRequestHeader("If-Modified-Since",_t.lastModified[s]),_t.etag[s]&&_.setRequestHeader("If-None-Match",_t.etag[s])),(m.data&&m.hasContent&&!1!==m.contentType||i.contentType)&&_.setRequestHeader("Content-Type",m.contentType),_.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Ke+"; q=0.01":""):m.accepts["*"]);for(u in m.headers)_.setRequestHeader(u,m.headers[u]);if(m.beforeSend&&(!1===m.beforeSend.call(f,_,m)||h))return _.abort();if(x="abort",b.add(m.complete),_.done(m.success),_.fail(m.error),o=nt(qe,m,i,_)){if(_.readyState=1,d&&g.trigger("ajaxSend",[_,m]),h)return _;m.async&&m.timeout>0&&(l=t.setTimeout(function(){_.abort("timeout")},m.timeout));try{h=!1,o.send(w,n)}catch(t){if(h)throw t;n(-1,t)}}else n(-1,"No Transport");return _},getJSON:function(t,e,i){return _t.get(t,e,i,"json")},getScript:function(t,e){return _t.get(t,void 0,e,"script")}}),_t.each(["get","post"],function(t,e){_t[e]=function(t,i,n,o){return yt(i)&&(o=o||n,n=i,i=void 0),_t.ajax(_t.extend({url:t,type:e,dataType:o,data:i,success:n},_t.isPlainObject(t)&&t))}}),_t.ajaxPrefilter(function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")}),_t._evalUrl=function(t,e,i){return _t.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){_t.globalEval(t,e,i)}})},_t.fn.extend({wrapAll:function(t){var e;return this[0]&&(yt(t)&&(t=t.call(this[0])),e=_t(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return yt(t)?this.each(function(e){_t(this).wrapInner(t.call(this,e))}):this.each(function(){var e=_t(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=yt(t);return this.each(function(i){_t(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){_t(this).replaceWith(this.childNodes)}),this}}),_t.expr.pseudos.hidden=function(t){return!_t.expr.pseudos.visible(t)},_t.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},_t.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var Ge={0:200,1223:204},Xe=_t.ajaxSettings.xhr();bt.cors=!!Xe&&"withCredentials"in Xe,bt.ajax=Xe=!!Xe,_t.ajaxTransport(function(e){var i,n;if(bt.cors||Xe&&!e.crossDomain)return{send:function(o,s){var r,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)a[r]=e.xhrFields[r];e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(r in o)a.setRequestHeader(r,o[r]);i=function(t){return function(){i&&(i=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(Ge[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=i(),n=a.onerror=a.ontimeout=i("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&t.setTimeout(function(){i&&n()})},i=i("abort");try{a.send(e.hasContent&&e.data||null)}catch(t){if(i)throw t}},abort:function(){i&&i()}}}),_t.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),_t.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return _t.globalEval(t),t}}}),_t.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),_t.ajaxTransport("script",function(t){if(t.crossDomain||t.scriptAttrs){var e,i;return{send:function(n,o){e=_t("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&o("error"===t.type?404:200,t.type)}),Ct.head.appendChild(e[0])},abort:function(){i&&i()}}}});var Je=[],Qe=/(=)\?(?=&|$)|\?\?/;_t.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Je.pop()||_t.expando+"_"+Me.guid++;return this[t]=!0,t}}),_t.ajaxPrefilter("json jsonp",function(e,i,n){var o,s,r,a=!1!==e.jsonp&&(Qe.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qe.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return o=e.jsonpCallback=yt(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Qe,"$1"+o):!1!==e.jsonp&&(e.url+=($e.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return r||_t.error(o+" was not called"),r[0]},e.dataTypes[0]="json",s=t[o],t[o]=function(){r=arguments},n.always(function(){void 0===s?_t(t).removeProp(o):t[o]=s,e[o]&&(e.jsonpCallback=i.jsonpCallback,Je.push(o)),r&&yt(s)&&s(r[0]),r=s=void 0}),"script"}),bt.createHTMLDocument=function(){var t=Ct.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),_t.parseHTML=function(t,e,i){if("string"!=typeof t)return[];"boolean"==typeof e&&(i=e,e=!1);var n,o,s;return e||(bt.createHTMLDocument?(e=Ct.implementation.createHTMLDocument(""),n=e.createElement("base"),n.href=Ct.location.href,e.head.appendChild(n)):e=Ct),o=Et.exec(t),s=!i&&[],o?[e.createElement(o[1])]:(o=_([t],e,s),s&&s.length&&_t(s).remove(),_t.merge([],o.childNodes))},_t.fn.load=function(t,e,i){var n,o,s,r=this,a=t.indexOf(" ");return a>-1&&(n=Q(t.slice(a)),t=t.slice(0,a)),yt(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),r.length>0&&_t.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done(function(t){s=arguments,r.html(n?_t("<div>").append(_t.parseHTML(t)).find(n):t)}).always(i&&function(t,e){r.each(function(){i.apply(this,s||[t.responseText,e,t])})}),this},_t.expr.pseudos.animated=function(t){return _t.grep(_t.timers,function(e){return t===e.elem}).length},_t.offset={setOffset:function(t,e,i){var n,o,s,r,a,l,c,h=_t.css(t,"position"),d=_t(t),u={};"static"===h&&(t.style.position="relative"),a=d.offset(),s=_t.css(t,"top"),l=_t.css(t,"left"),c=("absolute"===h||"fixed"===h)&&(s+l).indexOf("auto")>-1,c?(n=d.position(),r=n.top,o=n.left):(r=parseFloat(s)||0,o=parseFloat(l)||0),yt(e)&&(e=e.call(t,i,_t.extend({},a))),null!=e.top&&(u.top=e.top-a.top+r),null!=e.left&&(u.left=e.left-a.left+o),"using"in e?e.using.call(t,u):("number"==typeof u.top&&(u.top+="px"),"number"==typeof u.left&&(u.left+="px"),d.css(u))}},_t.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){_t.offset.setOffset(this,t,e)});var e,i,n=this[0];if(n)return n.getClientRects().length?(e=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var t,e,i,n=this[0],o={top:0,left:0};if("fixed"===_t.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===_t.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&(o=_t(t).offset(),o.top+=_t.css(t,"borderTopWidth",!0),o.left+=_t.css(t,"borderLeftWidth",!0))}return{top:e.top-o.top-_t.css(n,"marginTop",!0),left:e.left-o.left-_t.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===_t.css(t,"position");)t=t.offsetParent;return t||Kt})}}),_t.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i="pageYOffset"===e;_t.fn[t]=function(n){return Lt(this,function(t,n,o){var s;if(wt(t)?s=t:9===t.nodeType&&(s=t.defaultView),void 0===o)return s?s[e]:t[n];s?s.scrollTo(i?s.pageXOffset:o,i?o:s.pageYOffset):t[n]=o},t,n,arguments.length)}}),_t.each(["top","left"],function(t,e){_t.cssHooks[e]=V(bt.pixelPosition,function(t,i){if(i)return i=z(t,e),ce.test(i)?_t(t).position()[e]+"px":i})}),_t.each({Height:"height",Width:"width"},function(t,e){_t.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){_t.fn[n]=function(o,s){var r=arguments.length&&(i||"boolean"!=typeof o),a=i||(!0===o||!0===s?"margin":"border");return Lt(this,function(e,i,o){var s;return wt(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===o?_t.css(e,i,a):_t.style(e,i,o,a)},e,r?o:void 0,r)}})}),_t.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){_t.fn[e]=function(t){return this.on(e,t)}}),_t.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),_t.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){_t.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}});var Ze=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;_t.proxy=function(t,e){var i,n,o;if("string"==typeof e&&(i=t[e],e=t,t=i),yt(t))return n=ct.call(arguments,2),o=function(){return t.apply(e||this,n.concat(ct.call(arguments)))},o.guid=t.guid=t.guid||_t.guid++,o},_t.holdReady=function(t){t?_t.readyWait++:_t.ready(!0)},_t.isArray=Array.isArray,_t.parseJSON=JSON.parse,_t.nodeName=s,_t.isFunction=yt,_t.isWindow=wt,_t.camelCase=m,_t.type=n,_t.now=Date.now,_t.isNumeric=function(t){var e=_t.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},_t.trim=function(t){return null==t?"":(t+"").replace(Ze,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return _t});var ti=t.jQuery,ei=t.$;return _t.noConflict=function(e){return t.$===_t&&(t.$=ei),e&&t.jQuery===_t&&(t.jQuery=ti),_t},void 0===e&&(t.jQuery=t.$=_t),_t}),function(){var t,e=this,i=e.Backbone,n=[],o=n.slice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="1.1.0";var s=e._;s||"undefined"==typeof require||(s=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var r=t.Events={on:function(t,e,i){return l(this,"on",t,[e,i])&&e?(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this}),this):this},once:function(t,e,i){if(!l(this,"once",t,[e,i])||!e)return this;var n=this,o=s.once(function(){n.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,i)},off:function(t,e,i){var n,o,r,a,c,h,d,u;if(!this._events||!l(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(a=t?[t]:s.keys(this._events),c=0,h=a.length;c<h;c++)if(t=a[c],r=this._events[t]){if(this._events[t]=n=[],e||i)for(d=0,u=r.length;d<u;d++)o=r[d],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&n.push(o);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!l(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&c(i,e),n&&c(n,arguments),this},stopListening:function(t,e,i){var n=this._listeningTo;if(!n)return this;var o=!e&&!i;i||"object"!=typeof e||(i=this),t&&((n={})[t._listenId]=t);for(var r in n)t=n[r],t.off(e,i,this),(o||s.isEmpty(t._events))&&delete this._listeningTo[r];return this}},a=/\s+/,l=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var o in i)t[e].apply(t,[o,i[o]].concat(n));return!1}if(a.test(i)){for(var s=i.split(a),r=0,l=s.length;r<l;r++)t[e].apply(t,[s[r]].concat(n));return!1}return!0},c=function(t,e){var i,n=-1,o=t.length,s=e[0],r=e[1],a=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,r);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,r,a);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e)}},h={listenTo:"on",listenToOnce:"once"};s.each(h,function(t,e){r[e]=function(e,i,n){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=s.uniqueId("l"))]=e,n||"object"!=typeof i||(n=this),e[t](i,n,this),this}}),r.bind=r.on,r.unbind=r.off,s.extend(t,r);var d=t.Model=function(t,e){var i=t||{};e||(e={}),this.cid=s.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=s.defaults({},i,s.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};s.extend(d.prototype,r,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return s.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return s.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,o,r,a,l,c,h,d;if(null==t)return this;if("object"==typeof t?(o=t,i=e):(o={})[t]=e,i||(i={}),!this._validate(o,i))return!1;r=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=s.clone(this.attributes),this.changed={}),d=this.attributes,h=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(n in o)e=o[n],s.isEqual(d[n],e)||a.push(n),s.isEqual(h[n],e)?delete this.changed[n]:this.changed[n]=e,r?delete d[n]:d[n]=e;if(!l){a.length&&(this._pending=!0);for(var u=0,p=a.length;u<p;u++)this.trigger("change:"+a[u],this,d[a[u]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,s.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,s.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!s.isEmpty(this.changed):s.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&s.clone(this.changed);var e,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var o in t)s.isEqual(n[o],e=t[o])||((i||(i={}))[o]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){if(!e.set(e.parse(n,t),t))return!1;i&&i(e,n,t),e.trigger("sync",e,n,t)},L(this,t),this.sync("read",this,t)},save:function(t,e,i){var n,o,r,a=this.attributes;if(null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e,i=s.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=s.extend({},a,n)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(t){l.attributes=a;var e=l.parse(t,i);if(i.wait&&(e=s.extend(n||{},e)),s.isObject(e)&&!l.set(e,i))return!1;c&&c(l,t,i),l.trigger("sync",l,t,i)},L(this,i),o=this.isNew()?"create":i.patch?"patch":"update","patch"===o&&(i.attrs=n),r=this.sync(o,this,i),n&&i.wait&&(this.attributes=a),r},destroy:function(t){t=t?s.clone(t):{};var e=this,i=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(o){(t.wait||e.isNew())&&n(),i&&i(e,o,t),e.isNew()||e.trigger("sync",e,o,t)},this.isNew())return t.success(),!1;L(this,t);var o=this.sync("delete",this,t);return t.wait||n(),o},url:function(){var t=s.result(this,"urlRoot")||s.result(this.collection,"url")||O();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},s.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=s.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,s.extend(e,{validationError:i})),!1)}});var u=["keys","values","pairs","invert","pick","omit"];s.each(u,function(t){d.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),s[t].apply(s,e)}});var p=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,s.extend({silent:!0},e))},m={add:!0,remove:!0,merge:!0},f={add:!0,remove:!1};s.extend(p.prototype,r,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,s.extend({merge:!1},e,f))},remove:function(t,e){var i=!s.isArray(t);t=i?[t]:s.clone(t),e||(e={});var n,o,r,a;for(n=0,o=t.length;n<o;n++)(a=t[n]=this.get(t[n]))&&(delete this._byId[a.id],delete this._byId[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,e.silent||(e.index=r,a.trigger("remove",a,this,e)),this._removeReference(a));return i?t[0]:t},set:function(t,e){e=s.defaults({},e,m),e.parse&&(t=this.parse(t,e));var i=!s.isArray(t);t=i?t?[t]:[]:s.clone(t);var n,o,r,a,l,c,h,u=e.at,p=this.model,f=this.comparator&&null==u&&!1!==e.sort,g=s.isString(this.comparator)?this.comparator:null,v=[],b=[],y={},w=e.add,C=e.merge,x=e.remove,_=!(f||!w||!x)&&[];for(n=0,o=t.length;n<o;n++){if(l=t[n],r=l instanceof d?a=l:l[p.prototype.idAttribute],c=this.get(r))x&&(y[c.cid]=!0),C&&(l=l===a?a.attributes:l,e.parse&&(l=c.parse(l,e)),c.set(l,e),f&&!h&&c.hasChanged(g)&&(h=!0)),t[n]=c;else if(w){if(!(a=t[n]=this._prepareModel(l,e)))continue;v.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)}_&&_.push(c||a)}if(x){for(n=0,o=this.length;n<o;++n)y[(a=this.models[n]).cid]||b.push(a);b.length&&this.remove(b,e)}if(v.length||_&&_.length)if(f&&(h=!0),this.length+=v.length,null!=u)for(n=0,o=v.length;n<o;n++)this.models.splice(u+n,0,v[n]);else{_&&(this.models.length=0);var k=_||v;for(n=0,o=k.length;n<o;n++)this.models.push(k[n])}if(h&&this.sort({silent:!0}),!e.silent){for(n=0,o=v.length;n<o;n++)(a=v[n]).trigger("add",a,this,e);(h||_&&_.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,n=this.models.length;i<n;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),t=this.add(t,s.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,s.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,s.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){return s.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return s.invoke(this.models,"get",t)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var o=t.reset?"reset":"set";i[o](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},L(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?s.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,n=e.success;return e.success=function(t,e,o){o.wait&&i.add(t,o),n&&n(t,e,o)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t.collection||(t.collection=this),t;e=e?s.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(g,function(t){p.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),s[t].apply(s,e)}});var v=["groupBy","countBy","sortBy"];s.each(v,function(t){p.prototype[t]=function(e,i){var n=s.isFunction(e)?e:function(t){return t.get(e)};return s[t](this.models,n,i)}});var b=t.View=function(t){this.cid=s.uniqueId("view"),t||(t={}),s.extend(this,s.pick(t,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},y=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];s.extend(b.prototype,r,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=s.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(s.isFunction(i)||(i=this[t[e]]),i){var n=e.match(y),o=n[1],r=n[2];i=s.bind(i,this),o+=".delegateEvents"+this.cid,""===r?this.$el.on(o,i):this.$el.on(o,r,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var e=s.extend({},s.result(this,"attributes"));this.id&&(e.id=s.result(this,"id")),this.className&&(e.class=s.result(this,"className"));var i=t.$("<"+s.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,n){var o=x[e];s.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:o,dataType:"json"};if(n.url||(r.url=s.result(i,"url")||O()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",n.emulateJSON&&(r.data._method=o);var a=n.beforeSend;n.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===r.type||n.emulateJSON||(r.processData=!1),"PATCH"===r.type&&C&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=t.ajax(s.extend(r,n));return i.trigger("request",i,l,n),l};var C=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),x={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var _=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},k=/\((.*?)\)/g,S=/(\(\?)?:\w+/g,T=/\*\w+/g,I=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(_.prototype,r,{initialize:function(){},route:function(e,i,n){s.isRegExp(e)||(e=this._routeToRegExp(e)),s.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var o=this;return t.history.route(e,function(s){var r=o._extractParameters(e,s);n&&n.apply(o,r),o.trigger.apply(o,["route:"+i].concat(r)),o.trigger("route",i,r),t.history.trigger("route",o,i,r)}),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var t,e=s.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(I,"\\$&").replace(k,"(?:$1)?").replace(S,function(t,e){return e?t:"([^/]+)"}).replace(T,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return s.map(i,function(t){return t?decodeURIComponent(t):null})}});var E=t.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,A=/^\/+|\/+$/g,U=/msie [\w.]+/,M=/\/$/,$=/[?#].*$/;E.started=!1,s.extend(E.prototype,r,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(M,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(D,"")},start:function(e){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=s.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,o=U.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7)
;this.root=("/"+this.root+"/").replace(A,"/"),o&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var r=this.location,a=r.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!a)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&a&&r.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment+r.search))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return t=this.fragment=this.getFragment(t),s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(t,e){if(!E.started)return!1;e&&!0!==e||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace($,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),t.history=new E;var P=function(t,e){var i,n=this;i=t&&s.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,e);var o=function(){this.constructor=i};return o.prototype=n.prototype,i.prototype=new o,t&&s.extend(i.prototype,t),i.__super__=n.prototype,i};d.extend=p.extend=_.extend=b.extend=E.extend=P;var O=function(){throw new Error('A "url" property or function must be specified')},L=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}}}.call(this),define("backbone",["underscore","jquery"],function(t){return function(){return t.Backbone}}(this)),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");if(function(t){"use strict";var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||e[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one("bsTransitionEnd",function(){i=!0});var o=function(){i||t(n).trigger(t.support.transition.end)};return setTimeout(o,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.alert");o||i.data("bs.alert",o=new n(this)),"string"==typeof e&&o[e].call(i)})}var i='[data-dismiss="alert"]',n=function(e){t(e).on("click",i,this.close)};n.VERSION="3.4.1",n.TRANSITION_DURATION=150,n.prototype.close=function(e){function i(){r.detach().trigger("closed.bs.alert").remove()}var o=t(this),s=o.attr("data-target");s||(s=o.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),s="#"===s?[]:s;var r=t(document).find(s);e&&e.preventDefault(),r.length||(r=o.closest(".alert")),r.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(r.removeClass("in"),t.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i())};var o=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=n,t.fn.alert.noConflict=function(){return t.fn.alert=o,this},t(document).on("click.bs.alert.data-api",i,n.prototype.close)}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.button"),s="object"==typeof e&&e;o||n.data("bs.button",o=new i(this,s)),"toggle"==e?o.toggle():e&&o.setState(e)})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.isLoading=!1};i.VERSION="3.4.1",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(e){var i="disabled",n=this.$element,o=n.is("input")?"val":"html",s=n.data();e+="Text",null==s.resetText&&n.data("resetText",n[o]()),setTimeout(t.proxy(function(){n[o](null==s[e]?this.options[e]:s[e]),"loadingText"==e?(this.isLoading=!0,n.addClass(i).attr(i,i).prop(i,!0)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i).prop(i,!1))},this),0)},i.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")?(i.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==i.prop("type")&&(i.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),i.prop("checked",this.$element.hasClass("active")),t&&i.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=e,t.fn.button.Constructor=i,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var n=t(i.target).closest(".btn");e.call(n,"toggle"),t(i.target).is('input[type="radio"], input[type="checkbox"]')||(i.preventDefault(),n.is("input,button")?n.trigger("focus"):n.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.carousel"),s=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e),r="string"==typeof e?e:s.slide;o||n.data("bs.carousel",o=new i(this,s)),"number"==typeof e?o.to(e):r?o[r]():s.interval&&o.pause().cycle()})}var i=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};i.VERSION="3.4.1",i.TRANSITION_DURATION=600,i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},i.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},i.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},i.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e);if(("prev"==t&&0===i||"next"==t&&i==this.$items.length-1)&&!this.options.wrap)return e;var n="prev"==t?-1:1,o=(i+n)%this.$items.length;return this.$items.eq(o)},i.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},i.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){if(!this.sliding)return this.slide("next")},i.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},i.prototype.slide=function(e,n){var o=this.$element.find(".item.active"),s=n||this.getItemForDirection(e,o),r=this.interval,a="next"==e?"left":"right",l=this;if(s.hasClass("active"))return this.sliding=!1;var c=s[0],h=t.Event("slide.bs.carousel",{relatedTarget:c,direction:a});if(this.$element.trigger(h),!h.isDefaultPrevented()){if(this.sliding=!0,r&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var d=t(this.$indicators.children()[this.getItemIndex(s)]);d&&d.addClass("active")}var u=t.Event("slid.bs.carousel",{relatedTarget:c,direction:a});return t.support.transition&&this.$element.hasClass("slide")?(s.addClass(e),"object"==typeof s&&s.length&&s[0].offsetWidth,o.addClass(a),s.addClass(a),o.one("bsTransitionEnd",function(){s.removeClass([e,a].join(" ")).addClass("active"),o.removeClass(["active",a].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(u)},0)}).emulateTransitionEnd(i.TRANSITION_DURATION)):(o.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(u)),r&&this.cycle(),this}};var n=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=i,t.fn.carousel.noConflict=function(){return t.fn.carousel=n,this};var o=function(i){var n=t(this),o=n.attr("href");o&&(o=o.replace(/.*(?=#[^\s]+$)/,""));var s=n.attr("data-target")||o,r=t(document).find(s);if(r.hasClass("carousel")){var a=t.extend({},r.data(),n.data()),l=n.attr("data-slide-to");l&&(a.interval=!1),e.call(r,a),l&&r.data("bs.carousel").to(l),i.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",o).on("click.bs.carousel.data-api","[data-slide-to]",o),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var i=t(this);e.call(i,i.data())})})}(jQuery),function(t){"use strict";function e(e){var i,n=e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return t(document).find(n)}function i(e){return this.each(function(){var i=t(this),o=i.data("bs.collapse"),s=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e);!o&&s.toggle&&/show|hide/.test(e)&&(s.toggle=!1),o||i.data("bs.collapse",o=new n(this,s)),"string"==typeof e&&o[e]()})}var n=function(e,i){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,i),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};n.VERSION="3.4.1",n.TRANSITION_DURATION=350,n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,o=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(o&&o.length&&(e=o.data("bs.collapse"))&&e.transitioning)){var s=t.Event("show.bs.collapse");if(this.$element.trigger(s),!s.isDefaultPrevented()){o&&o.length&&(i.call(o,"hide"),e||o.data("bs.collapse",null));var r=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[r](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[r](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var l=t.camelCase(["scroll",r].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(n.TRANSITION_DURATION)[r](this.$element[0][l])}}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!t.support.transition)return o.call(this);this.$element[i](0).one("bsTransitionEnd",t.proxy(o,this)).emulateTransitionEnd(n.TRANSITION_DURATION)}}},n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},n.prototype.getParent=function(){return t(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(i,n){var o=t(n);this.addAriaAndCollapsedClass(e(o),o)},this)).end()},n.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var o=t.fn.collapse;t.fn.collapse=i,t.fn.collapse.Constructor=n,t.fn.collapse.noConflict=function(){return t.fn.collapse=o,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(n){var o=t(this);o.attr("data-target")||n.preventDefault();var s=e(o),r=s.data("bs.collapse"),a=r?"toggle":o.data();i.call(s,a)})}(jQuery),function(t){"use strict";function e(e){var i=e.attr("data-target");i||(i=e.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n="#"!==i?t(document).find(i):null;return n&&n.length?n:e.parent()}function i(i){i&&3===i.which||(t(o).remove(),t(s).each(function(){var n=t(this),o=e(n),s={relatedTarget:this};o.hasClass("open")&&(i&&"click"==i.type&&/input|textarea/i.test(i.target.tagName)&&t.contains(o[0],i.target)||(o.trigger(i=t.Event("hide.bs.dropdown",s)),i.isDefaultPrevented()||(n.attr("aria-expanded","false"),o.removeClass("open").trigger(t.Event("hidden.bs.dropdown",s)))))}))}function n(e){return this.each(function(){var i=t(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new r(this)),"string"==typeof e&&n[e].call(i)})}var o=".dropdown-backdrop",s='[data-toggle="dropdown"]',r=function(e){t(e).on("click.bs.dropdown",this.toggle)};r.VERSION="3.4.1",r.prototype.toggle=function(n){var o=t(this);if(!o.is(".disabled, :disabled")){var s=e(o),r=s.hasClass("open");if(i(),!r){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",i);var a={relatedTarget:this};if(s.trigger(n=t.Event("show.bs.dropdown",a)),n.isDefaultPrevented())return;o.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger(t.Event("shown.bs.dropdown",a))}return!1}},r.prototype.keydown=function(i){if(/(38|40|27|32)/.test(i.which)&&!/input|textarea/i.test(i.target.tagName)){var n=t(this);if(i.preventDefault(),i.stopPropagation(),!n.is(".disabled, :disabled")){var o=e(n),r=o.hasClass("open");if(!r&&27!=i.which||r&&27==i.which)return 27==i.which&&o.find(s).trigger("focus"),n.trigger("click");var a=o.find(".dropdown-menu li:not(.disabled):visible a");if(a.length){var l=a.index(i.target);38==i.which&&l>0&&l--,40==i.which&&l<a.length-1&&l++,~l||(l=0),a.eq(l).trigger("focus")}}}};var a=t.fn.dropdown;t.fn.dropdown=n,t.fn.dropdown.Constructor=r,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=a,this},t(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,r.prototype.toggle).on("keydown.bs.dropdown.data-api",s,r.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",r.prototype.keydown)}(jQuery),function(t){"use strict";function e(e,n){return this.each(function(){var o=t(this),s=o.data("bs.modal"),r=t.extend({},i.DEFAULTS,o.data(),"object"==typeof e&&e);s||o.data("bs.modal",s=new i(this,r)),"string"==typeof e?s[e](n):r.show&&s.show(n)})}var i=function(e,i){this.options=i,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.4.1",i.TRANSITION_DURATION=300,i.BACKDROP_TRANSITION_DURATION=150,i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},i.prototype.show=function(e){var n=this,o=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(o),this.isShown||o.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){n.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(n.$element)&&(n.ignoreBackdropClick=!0)})}),this.backdrop(function(){var o=t.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),n.adjustDialog(),o&&n.$element[0].offsetWidth,n.$element.addClass("in"),n.enforceFocus();var s=t.Event("shown.bs.modal",{relatedTarget:e});o?n.$dialog.one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(i.TRANSITION_DURATION):n.$element.trigger("focus").trigger(s)}))},i.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(i.TRANSITION_DURATION):this.hideModal())},i.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},i.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},i.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(e){var n=this,o=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=t.support.transition&&o;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+o).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){if(this.ignoreBackdropClick)return void(this.ignoreBackdropClick=!1);t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;s?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var r=function(){n.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",r).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):r()}else e&&e()},i.prototype.handleUpdate=function(){this.adjustDialog()},i.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},i.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},i.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},i.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";var i=this.scrollbarWidth;this.bodyIsOverflowing&&(this.$body.css("padding-right",e+i),t(this.fixedContent).each(function(e,n){var o=n.style.paddingRight,s=t(n).css("padding-right");t(n).data("padding-right",o).css("padding-right",parseFloat(s)+i+"px")}))},i.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),t(this.fixedContent).each(function(e,i){var n=t(i).data("padding-right");t(i).removeData("padding-right"),i.style.paddingRight=n||""})},i.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var n=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=i,t.fn.modal.noConflict=function(){return t.fn.modal=n,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var n=t(this),o=n.attr("href"),s=n.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,""),r=t(document).find(s),a=r.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(o)&&o},r.data(),n.data());n.is("a")&&i.preventDefault(),r.one("show.bs.modal",function(t){t.isDefaultPrevented()||r.one("hidden.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})}),e.call(r,a,this)})}(jQuery),function(t){"use strict";function e(e,i){var n=e.nodeName.toLowerCase();if(-1!==t.inArray(n,i))return-1===t.inArray(n,s)||Boolean(e.nodeValue.match(l)||e.nodeValue.match(c));for(var o=t(i).filter(function(t,e){return e instanceof RegExp}),r=0,a=o.length;r<a;r++)if(n.match(o[r]))return!0;return!1}function i(i,n,o){if(0===i.length)return i;if(o&&"function"==typeof o)return o(i);if(!document.implementation||!document.implementation.createHTMLDocument)return i;var s=document.implementation.createHTMLDocument("sanitization");s.body.innerHTML=i;for(var r=t.map(n,function(t,e){return e}),a=t(s.body).find("*"),l=0,c=a.length;l<c;l++){var h=a[l],d=h.nodeName.toLowerCase();if(-1!==t.inArray(d,r))for(var u=t.map(h.attributes,function(t){return t}),p=[].concat(n["*"]||[],n[d]||[]),m=0,f=u.length;m<f;m++)e(u[m],p)||h.removeAttribute(u[m].nodeName);else h.parentNode.removeChild(h)}return s.body.innerHTML}function n(e){return this.each(function(){var i=t(this),n=i.data("bs.tooltip"),o="object"==typeof e&&e;!n&&/destroy|hide/.test(e)||(n||i.data("bs.tooltip",n=new h(this,o)),"string"==typeof e&&n[e]())})}var o=["sanitize","whiteList","sanitizeFn"],s=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],r=/^aria-[\w-]*$/i,a={"*":["class","dir","id","lang","role",r],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},l=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,c=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i,h=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};h.VERSION="3.4.1",h.TRANSITION_DURATION=150,h.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:a},h.prototype.init=function(e,i,n){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&t(document).find(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),s=o.length;s--;){var r=o[s];if("click"==r)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=r){var a="hover"==r?"mouseenter":"focusin",l="hover"==r?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},h.prototype.getDefaults=function(){return h.DEFAULTS},h.prototype.getOptions=function(e){var n=this.$element.data();for(var s in n)n.hasOwnProperty(s)&&-1!==t.inArray(s,o)&&delete n[s];return e=t.extend({},this.getDefaults(),n,e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e.sanitize&&(e.template=i(e.template,e.whiteList,e.sanitizeFn)),e},h.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,n){i[t]!=n&&(e[t]=n)}),e},h.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusin"==e.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState?void(i.hoverState="in"):(clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},h.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},h.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusout"==e.type?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)}},h.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var n=this,o=this.tip(),s=this.getUID(this.type);this.setContent(),o.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&o.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,l=a.test(r);l&&(r=r.replace(a,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?o.appendTo(t(document).find(this.options.container)):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var c=this.getPosition(),d=o[0].offsetWidth,u=o[0].offsetHeight;if(l){var p=r,m=this.getPosition(this.$viewport);r="bottom"==r&&c.bottom+u>m.bottom?"top":"top"==r&&c.top-u<m.top?"bottom":"right"==r&&c.right+d>m.width?"left":"left"==r&&c.left-d<m.left?"right":r,o.removeClass(p).addClass(r)}var f=this.getCalculatedOffset(r,c,d,u);this.applyPlacement(f,r);var g=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==t&&n.leave(n)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",g).emulateTransitionEnd(h.TRANSITION_DURATION):g()}},h.prototype.applyPlacement=function(e,i){var n=this.tip(),o=n[0].offsetWidth,s=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),a=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),e.top+=r,e.left+=a,t.offset.setOffset(n[0],t.extend({using:function(t){n.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),n.addClass("in");var l=n[0].offsetWidth,c=n[0].offsetHeight;"top"==i&&c!=s&&(e.top=e.top+s-c);var h=this.getViewportAdjustedDelta(i,e,l,c);h.left?e.left+=h.left:e.top+=h.top;var d=/top|bottom/.test(i),u=d?2*h.left-o+l:2*h.top-s+c,p=d?"offsetWidth":"offsetHeight";n.offset(e),this.replaceArrow(u,n[0][p],d)},h.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},h.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();this.options.html?(this.options.sanitize&&(e=i(e,this.options.whiteList,this.options.sanitizeFn)),t.find(".tooltip-inner").html(e)):t.find(".tooltip-inner").text(e),t.removeClass("fade in top bottom left right")},h.prototype.hide=function(e){function i(){"in"!=n.hoverState&&o.detach(),n.$element&&n.$element.removeAttr("aria-describedby").trigger("hidden.bs."+n.type),e&&e()}var n=this,o=t(this.$tip),s=t.Event("hide.bs."+this.type);if(this.$element.trigger(s),!s.isDefaultPrevented())return o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",i).emulateTransitionEnd(h.TRANSITION_DURATION):i(),this.hoverState=null,this},h.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},h.prototype.hasContent=function(){return this.getTitle()},h.prototype.getPosition=function(e){e=e||this.$element;var i=e[0],n="BODY"==i.tagName,o=i.getBoundingClientRect();null==o.width&&(o=t.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var s=window.SVGElement&&i instanceof window.SVGElement,r=n?{top:0,left:0}:s?null:e.offset(),a={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},l=n?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},o,a,l,r)},h.prototype.getCalculatedOffset=function(t,e,i,n){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-n,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-n/2,left:e.left-i}:{top:e.top+e.height/2-n/2,left:e.left+e.width}},
h.prototype.getViewportAdjustedDelta=function(t,e,i,n){var o={top:0,left:0};if(!this.$viewport)return o;var s=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-s-r.scroll,l=e.top+s-r.scroll+n;a<r.top?o.top=r.top-a:l>r.top+r.height&&(o.top=r.top+r.height-l)}else{var c=e.left-s,h=e.left+s+i;c<r.left?o.left=r.left-c:h>r.right&&(o.left=r.left+r.width-h)}return o},h.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},h.prototype.getUID=function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},h.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},h.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},h.prototype.enable=function(){this.enabled=!0},h.prototype.disable=function(){this.enabled=!1},h.prototype.toggleEnabled=function(){this.enabled=!this.enabled},h.prototype.toggle=function(e){var i=this;e&&((i=t(e.currentTarget).data("bs."+this.type))||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),e?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},h.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})},h.prototype.sanitizeHtml=function(t){return i(t,this.options.whiteList,this.options.sanitizeFn)};var d=t.fn.tooltip;t.fn.tooltip=n,t.fn.tooltip.Constructor=h,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=d,this}}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.popover"),s="object"==typeof e&&e;!o&&/destroy|hide/.test(e)||(o||n.data("bs.popover",o=new i(this,s)),"string"==typeof e&&o[e]())})}var i=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");i.VERSION="3.4.1",i.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),i.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();if(this.options.html){var n=typeof i;this.options.sanitize&&(e=this.sanitizeHtml(e),"string"===n&&(i=this.sanitizeHtml(i))),t.find(".popover-title").html(e),t.find(".popover-content").children().detach().end()["string"===n?"html":"append"](i)}else t.find(".popover-title").text(e),t.find(".popover-content").children().detach().end().text(i);t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},i.prototype.hasContent=function(){return this.getTitle()||this.getContent()},i.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var n=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=i,t.fn.popover.noConflict=function(){return t.fn.popover=n,this}}(jQuery),function(t){"use strict";function e(i,n){this.$body=t(document.body),this.$scrollElement=t(t(i).is(document.body)?window:i),this.options=t.extend({},e.DEFAULTS,n),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function i(i){return this.each(function(){var n=t(this),o=n.data("bs.scrollspy"),s="object"==typeof i&&i;o||n.data("bs.scrollspy",o=new e(this,s)),"string"==typeof i&&o[i]()})}e.VERSION="3.4.1",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,i="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(i="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),o=e.data("target")||e.attr("href"),s=/^#./.test(o)&&t(o);return s&&s.length&&s.is(":visible")&&[[s[i]().top+n,o]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),o=this.offsets,s=this.targets,r=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),e>=n)return r!=(t=s[s.length-1])&&this.activate(t);if(r&&e<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)r!=s[t]&&e>=o[t]&&(void 0===o[t+1]||e<o[t+1])&&this.activate(s[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',n=t(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var n=t.fn.scrollspy;t.fn.scrollspy=i,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=n,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);i.call(e,e.data())})})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.tab");o||n.data("bs.tab",o=new i(this)),"string"==typeof e&&o[e]()})}var i=function(e){this.element=t(e)};i.VERSION="3.4.1",i.TRANSITION_DURATION=150,i.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),n=e.data("target");if(n||(n=e.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var o=i.find(".active:last a"),s=t.Event("hide.bs.tab",{relatedTarget:e[0]}),r=t.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(s),e.trigger(r),!r.isDefaultPrevented()&&!s.isDefaultPrevented()){var a=t(document).find(n);this.activate(e.closest("li"),i),this.activate(a,a.parent(),function(){o.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:o[0]})})}}},i.prototype.activate=function(e,n,o){function s(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),o&&o()}var r=n.find("> .active"),a=o&&t.support.transition&&(r.length&&r.hasClass("fade")||!!n.find("> .fade").length);r.length&&a?r.one("bsTransitionEnd",s).emulateTransitionEnd(i.TRANSITION_DURATION):s(),r.removeClass("in")};var n=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=i,t.fn.tab.noConflict=function(){return t.fn.tab=n,this};var o=function(i){i.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',o).on("click.bs.tab.data-api",'[data-toggle="pill"]',o)}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.affix"),s="object"==typeof e&&e;o||n.data("bs.affix",o=new i(this,s)),"string"==typeof e&&o[e]()})}var i=function(e,n){this.options=t.extend({},i.DEFAULTS,n);var o=this.options.target===i.DEFAULTS.target?t(this.options.target):t(document).find(this.options.target);this.$target=o.on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.4.1",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getState=function(t,e,i,n){var o=this.$target.scrollTop(),s=this.$element.offset(),r=this.$target.height();if(null!=i&&"top"==this.affixed)return o<i&&"top";if("bottom"==this.affixed)return null!=i?!(o+this.unpin<=s.top)&&"bottom":!(o+r<=t-n)&&"bottom";var a=null==this.affixed,l=a?o:s.top,c=a?r:e;return null!=i&&o<=i?"top":null!=n&&l+c>=t-n&&"bottom"},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},i.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),n=this.options.offset,o=n.top,s=n.bottom,r=Math.max(t(document).height(),t(document.body).height());"object"!=typeof n&&(s=o=n),"function"==typeof o&&(o=n.top(this.$element)),"function"==typeof s&&(s=n.bottom(this.$element));var a=this.getState(r,e,o,s);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var l="affix"+(a?"-"+a:""),c=t.Event(l+".bs.affix");if(this.$element.trigger(c),c.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:r-e-s})}};var n=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=i,t.fn.affix.noConflict=function(){return t.fn.affix=n,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var i=t(this),n=i.data();n.offset=n.offset||{},null!=n.offsetBottom&&(n.offset.bottom=n.offsetBottom),null!=n.offsetTop&&(n.offset.top=n.offsetTop),e.call(i,n)})})}(jQuery),define("bootstrap",["jquery"],function(){}),void 0===Common)var Common={};if(define("notification",["backbone"],function(t){"use strict";var e=function(){};if(_.extend(e.prototype,t.Events),void 0!==Common.NotificationCenter)throw"Native Common.NotificationCenter instance already defined.";e.extend=t.Model.extend,Common.NotificationCenter=new e}),function(){var t=function(t,e){for(var i=t.split("."),n=e||window,o=0,s=i.length;o<s;o++)n=n[i[o]]||{};return n},e=function(t){_.extend(this,t||{}),this.eventbus=new n({application:this}),this.createApplicationNamespace(),this.initialize.apply(this,arguments),!1!==this.autoCreate&&$($.proxy(this.onReady,this))};if(_.extend(e.prototype,{nameSpace:"Application",models:{},collections:{},controllers:{},allocationMap:{model:"Models",collection:"Collections",controller:"Controllers",view:"Views"},createApplicationNamespace:function(){var t=window;this.nameSpace&&void 0===t[this.nameSpace]&&(t[this.nameSpace]={}),t[this.nameSpace]=this,_.each(this.allocationMap,function(t,e){this[t]=this[t]||{}},this)},initialize:function(){},onReady:function(){this.start()},start:function(){this.initializeControllers(this.controllers||{}),this.launchControllers(),this.launch.call(this)},getClasseRefs:function(e,i){var n={},o=this.allocationMap[e],s=this[o];return _.each(i,function(e){n[e]=t(e,e.indexOf(".")>-1?window:s)},this),n},initializeControllers:function(e){this.controllers={},_.each(e,function(e){var i=e.indexOf(".")>-1?window:this[this.allocationMap.controller],n=t(e,i),o=(e.split(".").pop(),new n({id:e,application:this}));o.views=this.getClasseRefs("view",o.views||[]),_.extend(this.models,this.getClasseRefs("model",o.models||[])),_.extend(this.collections,this.getClasseRefs("collection",o.collections||{})),this.buildCollections(),this.controllers[e]=o},this)},launchControllers:function(){_.each(this.controllers,function(t,e){t.onLaunch(this)},this)},launch:function(){},addListeners:function(t,e){this.eventbus.addListeners(t,e)},getController:function(t){return this.controllers[t]},getModel:function(t){this._modelsCache=this._modelsCache||{};var e=this._modelsCache[t],i=this.getModelConstructor(t);return!e&&i&&(e=this.createModel(t),this._modelsCache[t]=e),e||null},getModelConstructor:function(t){return this.models[t]},createModel:function(t,e){var i=this.getModelConstructor(t),n=null;return i&&(n=new i(_.extend(e||{}))),n},getCollection:function(t){this._collectionsCache=this._collectionsCache||{};var e=this._collectionsCache[t],i=this.getCollectionConstructor(t);return!e&&i&&(e=this.createCollection(t),this._collectionsCache[t]=e),e||null},getCollectionConstructor:function(t){return this.collections[t]},createCollection:function(t){var e=this.getCollectionConstructor(t),i=null;return e&&(i=new e),i},buildCollections:function(){_.each(this.collections,function(t,e){this.getCollection(e)},this)}}),void 0!==Backbone.Application)throw"Native Backbone.Application instance already defined.";Backbone.Application=e,Backbone.Application.extend=Backbone.Model.extend;var i=function(t){_.extend(this,t||{}),this.initialize.apply(this,arguments)};if(_.extend(i.prototype,{name:null,views:{},models:{},collections:{},initialize:function(t){},addListeners:function(t){this.getApplication().addListeners(t,this)},onLaunch:function(t){},getApplication:function(){return this.application},getView:function(t){return this._viewsCache[t]},getViewConstructor:function(t){return this.views[t]},createView:function(t,e){var i=this.getViewConstructor(t),n=_.extend(e||{},{alias:t});return this._viewsCache=this._viewsCache||{},this._viewsCache[t]=new i(n),this._viewsCache[t].options=_.extend({},n),this._viewsCache[t]},getModel:function(t){return this.application.getModel(t)},getModelConstructor:function(t){return this.application.getModelConstructor(t)},createModel:function(t,e){return this.application.createModel(t)},getCollection:function(t){return this.application.getCollection(t)},getCollectionConstructor:function(t){return this.application.getCollectionConstructor(t)},createCollection:function(t){return this.application.createCollection(t)},fireEvent:function(t,e,i){this.application.eventbus.fireEvent(t,e,i)},bindViewEvents:function(t,e){this.unbindViewEvents(t),e=_.isFunction(e)?e.call(this):e;for(var i in e){var n=e[i];_.isFunction(n)||(n=this[e[i]]);var o=i.match(/^(\S+)\s*(.*)$/),s=o[1],r=o[2];n=_.bind(n,this),s+=".bindViewEvents"+t.cid,t.$el.on(s,r,n)}return this},unbindViewEvents:function(t){return t.$el.off(".bindViewEvents"+t.cid),this}}),void 0!==Backbone.Controller)throw"Native Backbone.Controller instance already defined.";Backbone.Controller=i,Backbone.Controller.extend=Backbone.Model.extend;var n=function(t){var e=this;_.extend(this,t||{}),_.extend(Backbone.View.prototype,{alias:null,hidden:!1,getAlias:function(){return this.options.alias},fireEvent:function(t,i){this.trigger.apply(this,arguments),e.fireEvent(this.getAlias(),t,i)},hide:function(){this.$el.hide(),this.hidden=!0},show:function(){this.$el.show(),this.hidden=!1}})};if(_.extend(n.prototype,{pool:{},addListeners:function(t,e){this.pool[e.id]=this.pool[e.id]||{};var i=this.pool[e.id];_.isArray(t)?_.each(t,function(t){this.addListeners(t,e)},this):_.isObject(t)&&_.each(t,function(t,e){_.each(t,function(t,n){i[e]=i[e]||{},i[e][n]=i[e][n]||[],i[e][n].push(t)},this)},this)},fireEvent:function(t,e,i){var n=this.getApplication();_.each(this.pool,function(o,s){var r=o[t];if(r){var a=r[e],l=n.getController(s);_.each(a,function(t){t.apply(l,i)})}},this)},getApplication:function(){return this.application}}),void 0!==Backbone.EventBus)throw"Native Backbone.Application instance already defined.";Backbone.EventBus=n}(),define("core",["backbone","notification"],function(){}),void 0===window.Common&&(window.Common={}),Common.component=Common.component||{},Common.Analytics=Common.component.Analytics=new function(){var t;return{initialize:function(e,i){if(void 0===e)throw"Analytics: invalid id.";if(void 0===i||"[object String]"!==Object.prototype.toString.apply(i))throw"Analytics: invalid category type.";t=i,$("head").append('<script type="text/javascript">var _gaq = _gaq || [];_gaq.push(["_setAccount", "'+e+'"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);})();<\/script>')},trackEvent:function(e,i,n){if(void 0!==e&&"[object String]"!==Object.prototype.toString.apply(e))throw"Analytics: invalid action type.";if(void 0!==i&&"[object String]"!==Object.prototype.toString.apply(i))throw"Analytics: invalid label type.";if(void 0!==n&&("[object Number]"!==Object.prototype.toString.apply(n)||!isFinite(n)))throw"Analytics: invalid value type.";if("undefined"!=typeof _gaq){if("undefined"===t)throw"Analytics is not initialized.";_gaq.push(["_trackEvent",t,e,i,n])}}}},define("analytics",["jquery"],function(){}),void 0===window.Common&&(window.Common={}),Common.Gateway=new function(){var t=this,e=$(t),i={init:function(t){e.trigger("init",t)},openDocument:function(t){e.trigger("opendocument",t)},showMessage:function(t){e.trigger("showmessage",t)},applyEditRights:function(t){e.trigger("applyeditrights",t)},processSaveResult:function(t){e.trigger("processsaveresult",t)},processRightsChange:function(t){e.trigger("processrightschange",t)},refreshHistory:function(t){e.trigger("refreshhistory",t)},setHistoryData:function(t){e.trigger("sethistorydata",t)},setEmailAddresses:function(t){e.trigger("setemailaddresses",t)},setActionLink:function(t){e.trigger("setactionlink",t.url)},processMailMerge:function(t){e.trigger("processmailmerge",t)},downloadAs:function(t){e.trigger("downloadas",t)},processMouse:function(t){e.trigger("processmouse",t)},internalCommand:function(t){e.trigger("internalcommand",t)},resetFocus:function(t){e.trigger("resetfocus",t)},setUsers:function(t){e.trigger("setusers",t)},showSharingSettings:function(t){e.trigger("showsharingsettings",t)},setSharingSettings:function(t){e.trigger("setsharingsettings",t)},insertImage:function(t){e.trigger("insertimage",t)},setMailMergeRecipients:function(t){e.trigger("setmailmergerecipients",t)},setRevisedFile:function(t){e.trigger("setrevisedfile",t)},setFavorite:function(t){e.trigger("setfavorite",t)},requestClose:function(t){e.trigger("requestclose",t)},blurFocus:function(t){e.trigger("blurfocus",t)},grabFocus:function(t){e.trigger("grabfocus",t)},setReferenceData:function(t){e.trigger("setreferencedata",t)}},n=function(t){window.parent&&window.JSON&&(t.frameEditorId=window.frameEditorId,window.parent.postMessage(window.JSON.stringify(t),"*"))},o=function(t){if(t.origin===window.parentOrigin||t.origin===window.location.origin||"null"===t.origin&&("file://"===window.parentOrigin||"file://"===window.location.origin)){var e=t.data;if("[object String]"===Object.prototype.toString.apply(e)&&window.JSON){var n,o;try{n=window.JSON.parse(e)}catch(t){n=""}n&&(o=i[n.command])&&o.call(this,n.data)}}},s=function(t){o(t)};return window.attachEvent?window.attachEvent("onmessage",s):window.addEventListener("message",s,!1),{appReady:function(){n({event:"onAppReady"})},requestEditRights:function(){n({event:"onRequestEditRights"})},requestHistory:function(){n({event:"onRequestHistory"})},requestHistoryData:function(t){n({event:"onRequestHistoryData",data:t})},requestRestore:function(t,e,i){n({event:"onRequestRestore",data:{version:t,url:e,fileType:i}})},requestEmailAddresses:function(){n({event:"onRequestEmailAddresses"})},requestStartMailMerge:function(){n({event:"onRequestStartMailMerge"})},requestHistoryClose:function(t){n({event:"onRequestHistoryClose"})},reportError:function(t,e){n({event:"onError",data:{errorCode:t,errorDescription:e}})},reportWarning:function(t,e){n({event:"onWarning",data:{warningCode:t,warningDescription:e}})},sendInfo:function(t){n({event:"onInfo",data:t})},setDocumentModified:function(t){n({event:"onDocumentStateChange",data:t})},internalMessage:function(t,e){n({event:"onInternalMessage",data:{type:t,data:e}})},updateVersion:function(){n({event:"onOutdatedVersion"})},downloadAs:function(t,e){n({event:"onDownloadAs",data:{url:t,fileType:e}})},requestSaveAs:function(t,e,i){n({event:"onRequestSaveAs",data:{url:t,title:e,fileType:i}})},collaborativeChanges:function(){n({event:"onCollaborativeChanges"})},requestRename:function(t){n({event:"onRequestRename",data:t})},metaChange:function(t){n({event:"onMetaChange",data:t})},documentReady:function(){n({event:"onDocumentReady"})},requestClose:function(){n({event:"onRequestClose"})},requestMakeActionLink:function(t){n({event:"onMakeActionLink",data:t})},requestUsers:function(){n({event:"onRequestUsers"})},requestSendNotify:function(t){n({event:"onRequestSendNotify",data:t})},requestInsertImage:function(t){n({event:"onRequestInsertImage",data:{c:t}})},requestMailMergeRecipients:function(){n({event:"onRequestMailMergeRecipients"})},requestCompareFile:function(){n({event:"onRequestCompareFile"})},requestSharingSettings:function(){n({event:"onRequestSharingSettings"})},requestCreateNew:function(){n({event:"onRequestCreateNew"})},requestReferenceData:function(t){n({event:"onRequestReferenceData",data:t})},pluginsReady:function(){n({event:"onPluginsReady"})},on:function(i,n){var o=function(e,i){n.call(t,i)};e.on(i,o)}}},define("gateway",["jquery"],function(){}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("../vendor/es6-promise/es6-promise.auto.min",e):t.ES6Promise=e()}(this,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}function i(t){z=t}function n(t){V=t}function o(){return void 0!==L?function(){L(r)}:s()}function s(){var t=setTimeout;return function(){return t(r,1)}}function r(){for(var t=0;t<O;t+=2){(0,j[t])(j[t+1]),j[t]=void 0,j[t+1]=void 0}O=0}function a(t,e){var i=this,n=new this.constructor(c);void 0===n[q]&&S(n);var o=i._state;if(o){var s=arguments[o-1];V(function(){return x(o,n,s,i._result)})}else w(i,n,t,e);return n}function l(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var i=new e(c);return g(i,t),i}function c(){}function h(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function u(t,e,i,n){try{t.call(e,i,n)}catch(t){return t}}function p(t,e,i){V(function(t){var n=!1,o=u(i,e,function(i){n||(n=!0,e!==i?g(t,i):b(t,i))},function(e){n||(n=!0,y(t,e))},"Settle: "+(t._label||" unknown promise"));!n&&o&&(n=!0,y(t,o))},t)}function m(t,e){e._state===Y?b(t,e._result):e._state===G?y(t,e._result):w(e,void 0,function(e){return g(t,e)},function(e){return y(t,e)})}function f(t,i,n){i.constructor===t.constructor&&n===a&&i.constructor.resolve===l?m(t,i):void 0===n?b(t,i):e(n)?p(t,i,n):b(t,i)}function g(e,i){if(e===i)y(e,h());else if(t(i)){var n=void 0;try{n=i.then}catch(t){return void y(e,t)}f(e,i,n)}else b(e,i)}function v(t){t._onerror&&t._onerror(t._result),C(t)}function b(t,e){t._state===K&&(t._result=e,t._state=Y,0!==t._subscribers.length&&V(C,t))}function y(t,e){t._state===K&&(t._state=G,t._result=e,V(v,t))}function w(t,e,i,n){var o=t._subscribers,s=o.length;t._onerror=null,o[s]=e,o[s+Y]=i,o[s+G]=n,0===s&&t._state&&V(C,t)}function C(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var n=void 0,o=void 0,s=t._result,r=0;r<e.length;r+=3)n=e[r],o=e[r+i],n?x(i,n,o,s):o(s);t._subscribers.length=0}}function x(t,i,n,o){var s=e(n),r=void 0,a=void 0,l=!0;if(s){try{r=n(o)}catch(t){l=!1,a=t}if(i===r)return void y(i,d())}else r=o;i._state!==K||(s&&l?g(i,r):!1===l?y(i,a):t===Y?b(i,r):t===G&&y(i,r))}function _(t,e){try{e(function(e){g(t,e)},function(e){y(t,e)})}catch(e){y(t,e)}}function k(){return X++}function S(t){t[q]=X++,t._state=void 0,t._result=void 0,t._subscribers=[]}function T(){return new Error("Array Methods must be provided an Array")}function I(t){return new J(this,t).promise}function E(t){var e=this;return new e(P(t)?function(i,n){for(var o=t.length,s=0;s<o;s++)e.resolve(t[s]).then(i,n)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function D(t){var e=this,i=new e(c);return y(i,t),i}function A(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function M(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===i&&!e.cast)return}t.Promise=Q}var $=void 0;$=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var P=$,O=0,L=void 0,z=void 0,V=function(t,e){j[O]=t,j[O+1]=e,2===(O+=2)&&(z?z(r):W())},N="undefined"!=typeof window?window:void 0,R=N||{},H=R.MutationObserver||R.WebKitMutationObserver,F="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),B="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,j=new Array(1e3),W=void 0;W=F?function(){return function(){return process.nextTick(r)}}():H?function(){var t=0,e=new H(r),i=document.createTextNode("");return e.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}():B?function(){var t=new MessageChannel;return t.port1.onmessage=r,function(){return t.port2.postMessage(0)}}():void 0===N&&"function"==typeof require?function(){try{var t=Function("return this")().require("vertx");return L=t.runOnLoop||t.runOnContext,o()}catch(t){return s()}}():s();var q=Math.random().toString(36).substring(2),K=void 0,Y=1,G=2,X=0,J=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(c),this.promise[q]||S(this.promise),P(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&b(this.promise,this._result))):y(this.promise,T())}return t.prototype._enumerate=function(t){for(var e=0;this._state===K&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,n=i.resolve;if(n===l){var o=void 0,s=void 0,r=!1;try{o=t.then}catch(t){r=!0,s=t}if(o===a&&t._state!==K)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(i===Q){var h=new i(c);r?y(h,s):f(h,t,o),this._willSettleAt(h,e)}else this._willSettleAt(new i(function(e){return e(t)}),e)}else this._willSettleAt(n(t),e)},t.prototype._settledAt=function(t,e,i){var n=this.promise;n._state===K&&(this._remaining--,t===G?y(n,i):this._result[e]=i),0===this._remaining&&b(n,this._result)},t.prototype._willSettleAt=function(t,e){var i=this;w(t,void 0,function(t){return i._settledAt(Y,e,t)},function(t){return i._settledAt(G,e,t)})},t}(),Q=function(){function t(e){this[q]=k(),this._result=this._state=void 0,this._subscribers=[],c!==e&&("function"!=typeof e&&A(),this instanceof t?_(this,e):U())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var i=this,n=i.constructor;return e(t)?i.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})}):i.then(t,t)},t}();return Q.prototype.then=a,Q.all=I,Q.race=E,Q.resolve=l,Q.reject=D,Q._setScheduler=i,Q._setAsap=n,Q._asap=V,Q.polyfill=M,Q.Promise=Q,Q.polyfill(),Q}),void 0===Common)var Common={};if(Common.Locale=new function(){"use strict";var l10n=null,loadcallback,apply=!1,defLang="en",currentLang=defLang,_4letterLangs=["pt-pt","zh-tw"],_applyLocalization=function(t){try{if(t&&(loadcallback=t),l10n){for(var e in l10n){var i=e.split(".");if(i&&i.length>2){for(var n=window,o=0;o<i.length-1;++o)void 0===n[i[o]]&&(n[i[o]]=new Object),n=n[i[o]];n&&(n[i[i.length-1]]=l10n[e])}}loadcallback&&loadcallback()}else apply=!0}catch(t){}},_get=function(prop,scope){var res="";return l10n&&scope&&scope.name&&!(res=l10n[scope.name+"."+prop])&&scope.default&&(res=scope.default),res||(scope?eval(scope.name).prototype[prop]:"")},_getCurrentLanguage=function(){return currentLang},_getDefaultLanguage=function(){return defLang},_getLoadedLanguage=function(){return loadedLang},_getUrlParameterByName=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)"),i=e.exec(location.search);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))},_requireLang=function(t){"string"!=typeof t&&(t=null);var e=t||_getUrlParameterByName("lang")||defLang,i=_4letterLangs.indexOf(e.replace("_","-").toLowerCase());e=i<0?e.split(/[\-_]/)[0]:_4letterLangs[i],currentLang=e,fetch("locale/"+e+".json").then(function(t){if(!t.ok){if(i>=0)throw new Error("4letters error");if(currentLang=defLang,e!=defLang)return fetch("locale/"+defLang+".json");throw new Error("server error")}return t.json()}).then(function(t){if(t.json){if(!t.ok)throw new Error("server error");return t.json()}throw l10n=t,new Error("loaded")}).then(function(t){l10n=t||{},apply&&_applyLocalization()}).catch(function(t){return/4letters/.test(t)?setTimeout(function(){_requireLang(e.split(/[\-_]/)[0])},0):!/loaded/.test(t)&&currentLang!=defLang&&defLang&&defLang.length<3?setTimeout(function(){_requireLang(defLang)},0):(l10n=l10n||{},apply&&_applyLocalization(),void("loaded"==t.message||(currentLang=null,console.log("fetch error: "+t))))})};if(window.fetch)_requireLang();else{var polyfills=["../vendor/fetch/fetch.umd"];window.Promise?require(polyfills,_requireLang):require(["../vendor/es6-promise/es6-promise.auto.min"],function(){require(polyfills,_requireLang)})}return{apply:_applyLocalization,get:_get,getCurrentLanguage:_getCurrentLanguage,getDefaultLanguage:_getDefaultLanguage}},define("locale",function(){}),void 0===Common)var Common={};if(Common.IrregularStack=function(t){var e=[],i=function(t,e){return"object"==typeof t&&"object"==typeof e&&window.JSON?window.JSON.stringify(t)===window.JSON.stringify(e):t===e};t=t||{};var n=t.strongCompare||i,o=t.weakCompare||i,s=function(t,i){for(var n=e.length-1;n>=0;n--)if(i(e[n],t))return n;return-1};return{push:function(t){e.push(t)},pop:function(t){var i=s(t,n);if(-1!=i)return e.splice(i,1)[0]},get:function(t){var i="object"==typeof t?s(t,o):t;if(-1!=i)return e[i]},exist:function(t){return!(s(t,n)<0)},length:function(){return e.length}}},define("irregularstack",function(){}),void 0===Common)var Common={};if(define("common/main/lib/component/BaseView",["backbone"],function(t){"use strict";Common.UI=_.extend(Common.UI||{},{Keys:{BACKSPACE:8,TAB:9,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,HOME:36,END:35,SPACE:32,PAGEUP:33,PAGEDOWN:34,INSERT:45,EQUALITY_FF:61,NUM_PLUS:107,NUM_MINUS:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,MINUS_FF:173,EQUALITY:187,MINUS:189},BaseView:t.View.extend({isSuspendEvents:!1,initialize:function(t){
this.options=this.options?_({}).extend(this.options,t):t},setVisible:function(t){return this[t?"show":"hide"]()},isVisible:function(){return $(this.el).is(":visible")},suspendEvents:function(){this.isSuspendEvents=!0},resumeEvents:function(){this.isSuspendEvents=!1}}),getId:function(t){return _.uniqueId(t||"asc-gen")}})}),void 0===Common)var Common={};if(define("common/main/lib/component/CheckBox",["common/main/lib/component/BaseView","underscore"],function(t,e){"use strict";Common.UI.CheckBox=Common.UI.BaseView.extend({options:{labelText:""},disabled:!1,rendered:!1,indeterminate:!1,checked:!1,value:"unchecked",template:e.template('<label class="checkbox-indeterminate"><input id="<%= id %>" type="checkbox" class="checkbox__native"><label for="<%= id %>" class="checkbox__shape" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"></label><span></span></label>'),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(t){var e=this;if(!e.rendered){var i=this.template({id:Common.UI.getId("chb-"),dataHint:e.options.dataHint,dataHintDirection:e.options.dataHintDirection,dataHintOffset:e.options.dataHintOffset});t?(this.setElement(t,!1),t.html(i)):e.$el.html(i),this.$chk=e.$el.find("input[type=checkbox]"),this.$label=e.$el.find("label.checkbox-indeterminate"),this.$span=e.$label.find("span"),this.$chk.on("click",this.onItemCheck.bind(this)),this.$label.on("keydown",this.onKeyDown.bind(this)),this.rendered=!0}return this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.value&&this.setValue(this.options.value,!0),this.setCaption(this.options.labelText),this},setDisabled:function(t){this.rendered&&(t=!0===t,t!==this.disabled&&(this.$label.toggleClass("disabled",t),t?this.$chk.attr({disabled:t}):this.$chk.removeAttr("disabled"),void 0!==this.tabindex&&(t&&(this.tabindex=this.$label.attr("tabindex")),this.$label.attr("tabindex",t?"-1":this.tabindex))),this.disabled=t)},isDisabled:function(){return this.disabled},onItemCheck:function(t){this.disabled||(this.indeterminate?(this.indeterminate=!1,this.setValue(!1)):this.setValue(!this.checked))},setRawValue:function(t){this.checked=!0===t||"true"===t||"1"===t||1===t||"checked"===t,this.indeterminate="indeterminate"===t,this.value=this.indeterminate?"indeterminate":this.checked?"checked":"unchecked",this.$chk.prop({indeterminate:this.indeterminate,checked:this.checked})},setValue:function(t,e){this.rendered?t!=this.value&&(this.lastValue=this.value,this.setRawValue(t),!0!==e&&this.trigger("change",this,this.value,this.lastValue)):this.options.value=t},getValue:function(){return this.value},isChecked:function(){return this.checked},setCaption:function(t){this.$span.text(t),this.$span.css("visibility",t?"visible":"hidden")},onKeyDown:function(t){t.isDefaultPrevented()||t.keyCode===Common.UI.Keys.SPACE&&this.onItemCheck(t)},focus:function(){this.$label&&this.$label.focus()},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),!this.disabled&&this.$label.attr("tabindex",this.tabindex))}})}),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.FocusManager=new function(){var t=1,e=[],i=0,n=function(e){var i=[];return e.forEach||(e=[e]),e.forEach(function(e){if(e){var n={};e.cmp&&"string"==typeof e.selector?n=e:(n.cmp=e,e instanceof Common.UI.ListView?n.selector=".listview":e instanceof Common.UI.CheckBox?n.selector=".checkbox-indeterminate":e instanceof Common.UI.RadioBox?n.selector=".radiobox":e instanceof Common.UI.TreeView?n.selector=".treeview":e instanceof Common.UI.Button?n.selector="button":n.selector=".form-control"),n.el=(n.cmp.$el||$(n.cmp.el||n.cmp)).find(n.selector).addBack().filter(n.selector),n.el&&n.el.attr&&(n.cmp.setTabIndex?n.cmp.setTabIndex(t):n.el.attr("tabindex",t.toString())),i.push(n)}}),i},o=function(e){if(e&&!e.traps&&e.fields&&!(e.fields.length<1)){var i=$('<span aria-hidden="true" tabindex="'+t+'"></span>');i.on("focus",function(){if(!e.hidden)for(var t=e.fields,i=t.length-1;i>=0;i--){var n=t[i];if((n.cmp.isVisible?n.cmp.isVisible():n.cmp.is(":visible"))&&(!n.cmp.isDisabled||!n.cmp.isDisabled())){var o=n.selector?(n.cmp.$el||$(n.cmp.el||n.cmp)).find(n.selector).addBack().filter(n.selector):n.el;o&&setTimeout(function(){o.focus()},10);break}}}),e.parent.$window.prepend(i);var n=$('<span aria-hidden="true" tabindex="'+(t+1)+'"></span>');n.on("focus",function(){if(!e.hidden)for(var t=e.fields,i=0;i<t.length;i++){var n=t[i];if((n.cmp.isVisible?n.cmp.isVisible():n.cmp.is(":visible"))&&(!n.cmp.isDisabled||!n.cmp.isDisabled())){var o=n.selector?(n.cmp.$el||$(n.cmp.el||n.cmp)).find(n.selector).addBack().filter(n.selector):n.el;o&&setTimeout(function(){o.focus()},10);break}}}),e.parent.$window.append(n),e.traps=[i,n]}},s=function(t){var n=t?1:-1;for(var o in e)if(e.hasOwnProperty(o)){var s=e[o];s&&s.index<i-1&&s.traps&&s.traps[1].attr("tabindex",(parseInt(s.traps[1].attr("tabindex"))+n).toString())}},r=function(t,s){t&&t.cid&&(e[t.cid]?e[t.cid].fields=(e[t.cid].fields||[]).concat(n(s)):e[t.cid]={parent:t,fields:n(s),hidden:!1,index:i++},o(e[t.cid]))};return{init:function(){Common.NotificationCenter.on({"modal:show":function(t){t&&t.cid&&(e[t.cid]?e[t.cid].hidden=!1:(e[t.cid]={parent:t,hidden:!1,index:i++},s(!0)))},"window:show":function(t){t&&t.cid&&e[t.cid]&&!e[t.cid].fields&&(e[t.cid].fields=n(t.getFocusedComponents()),o(e[t.cid]));var i=t?t.getDefaultFocusableComponent():null;i&&setTimeout(function(){i.focus()},100)},"modal:close":function(t,n){t&&t.cid&&e[t.cid]&&(s(!1),delete e[t.cid],i--)},"modal:hide":function(t,i){t&&t.cid&&e[t.cid]&&(e[t.cid].hidden=!0)}})},add:r}},define("common/main/lib/controller/FocusManager",function(){}),void 0===Common)var Common={};if(define("common/main/lib/component/Window",["common/main/lib/component/BaseView","common/main/lib/component/CheckBox","common/main/lib/controller/FocusManager"],function(){"use strict";Common.UI.Window=Common.UI.BaseView.extend(_.extend(function(){function t(){var t=$(".modals-mask");return 0==t.length&&(t=$("<div class='modals-mask'>").appendTo(document.body).hide(),t.attr("counter",0)),t}function e(t){if(!this.isLocked()&&this.isVisible()&&this.initConfig.enableKeyEvents&&!1!==this.pauseKeyEvents)switch(t.keyCode){case Common.UI.Keys.ESC:if($(".asc-loadmask").length<1)return t.preventDefault(),t.stopPropagation(),!1!==this.initConfig.closable&&(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close()),!1;break;case Common.UI.Keys.RETURN:if(this.$window.find(".btn.primary").length&&$(".asc-loadmask").length<1&&!1===(this.initConfig.onprimary||this.onPrimary).call(this))return t.preventDefault(),!1}}function i(){if(void 0==window.innerHeight)var t=document.documentElement.offsetWidth,e=document.documentElement.offsetHeight;else t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight();return e-=Common.Utils.InternalSettings.get("window-inactive-area-top"),{width:t,height:e,top:Common.Utils.InternalSettings.get("window-inactive-area-top")}}function n(){if("auto"==this.initConfig.height){var t=Math.ceil(parseFloat(this.$window.find("> .body").css("height")));this.initConfig.header&&(t+=parseInt(this.$window.find("> .header").css("height"))),this.$window.height(t)}}function o(){var t=i(),e=t.width,n=t.height;if("auto"==this.initConfig.height){var o=parseInt(this.$window.find(".body").css("height"));this.initConfig.header&&(o+=parseInt(this.$window.find(".header").css("height")))}else(o=this.initConfig.height)>n&&(o=n);var s="auto"==this.initConfig.width?parseInt(this.$window.find(".body").css("width")):this.initConfig.width,r=t.top+Math.floor((parseInt(n)-parseInt(o))/2),a=Math.floor((parseInt(e)-parseInt(s))/2);this.$window.css("left",a),this.$window.css("top",r)}function s(){var t=i(),e=t.width,n=t.height;this.getLeft()+this.getWidth()>e&&this.$window.css("left",e-this.getWidth()),this.getTop()<t.top?this.$window.css("top",t.top):this.getTop()+this.getHeight()>n&&(n-this.getHeight()<0?this.$window.css("top",t.top):this.$window.css("top",t.top+n-this.getHeight()))}function r(t){return{"-webkit-transition":"0.3s opacity","-moz-transition":"0.3s opacity","-ms-transition":"0.3s opacity","-o-transition":"0.3s opacity",opacity:t}}function a(t){if(!$(t.target).hasClass("close")&&!$(t.target).hasClass("help")){Common.UI.Menu.Manager.hideAll();var e=t instanceof jQuery.Event?Common.Utils.zoom():1;this.dragging.enabled=!0,this.dragging.initx=t.pageX*e-this.getLeft(),this.dragging.inity=t.pageY*e-this.getTop();var n=i(),o=n.width,s=n.height;this.dragging.maxx=o-this.getWidth(),this.dragging.maxy=s-this.getHeight(),this.dragging.maxy<0&&(this.dragging.maxy=0),this.dragging.maxy+=n.top,$(document).on("mousemove",this.binding.drag),$(document).on("mouseup",this.binding.dragStop),this.fireEvent("drag",[this,"start"])}}function l(){$(document).off("mousemove",this.binding.drag),$(document).off("mouseup",this.binding.dragStop),this.dragging.enabled=!1,this.fireEvent("drag",[this,"end"])}function c(t){if(this.dragging.enabled){var e=t instanceof jQuery.Event?Common.Utils.zoom():1,i=t.pageX*e-this.dragging.initx,n=t.pageY*e-this.dragging.inity,o=Common.Utils.InternalSettings.get("window-inactive-area-top");i<0?i=0:i>this.dragging.maxx&&(i=this.dragging.maxx),n<o?n=o:n>this.dragging.maxy&&(n=this.dragging.maxy),this.$window.css({left:i,top:n})}}function h(t){"mouseup"==t.type&&this.dragging.enabled&&l.call(this)}function d(t){Common.UI.Menu.Manager.hideAll();var e=$(t.target),n=this.getLeft(),o=this.getTop();this.resizing.enabled=!0,this.resizing.initpage_x=t.pageX*Common.Utils.zoom(),this.resizing.initpage_y=t.pageY*Common.Utils.zoom(),this.resizing.initx=this.resizing.initpage_x-n,this.resizing.inity=this.resizing.initpage_y-o,this.resizing.initw=this.getWidth(),this.resizing.inith=this.getHeight(),this.resizing.type=[e.hasClass("left")?-1:e.hasClass("right")?1:0,e.hasClass("top")?-1:e.hasClass("bottom")?1:0];var s=i(),r=s.width,a=s.height,l=this.initConfig.maxwidth?this.initConfig.maxwidth:r,c=this.initConfig.maxheight?this.initConfig.maxheight:a;this.resizing.minw=this.initConfig.minwidth,this.resizing.maxw=this.resizing.type[0]>0?Math.min(r-n,l):Math.min(n+this.resizing.initw,l),this.resizing.minh=this.initConfig.minheight,this.resizing.maxh=this.resizing.type[1]>0?Math.min(a-o,c):Math.min(o+this.resizing.inith,c),$(document.body).css("cursor",e.css("cursor")),this.$window.find(".resize-border").addClass("resizing"),this.$window.find(".header").addClass("resizing"),$(document).on("mousemove",this.binding.resize),$(document).on("mouseup",this.binding.resizeStop),this.fireEvent("resize",[this,"start"])}function u(t){if(this.resizing.enabled){var e=!1,i=t instanceof jQuery.Event?Common.Utils.zoom():1,n=t.pageX*i,o=t.pageY*i;if(this.resizing.type[0]){var s=this.resizing.initw+(n-this.resizing.initpage_x)*this.resizing.type[0];s>this.resizing.maxw?(n-=(s-this.resizing.maxw)*this.resizing.type[0],s=this.resizing.maxw):s<this.resizing.minw&&(n-=(s-this.resizing.minw)*this.resizing.type[0],s=this.resizing.minw),this.resizing.type[0]<0&&this.$window.css({left:n-this.resizing.initx}),this.setWidth(s),e=!0}if(this.resizing.type[1]){var r=this.resizing.inith+(o-this.resizing.initpage_y)*this.resizing.type[1];r>this.resizing.maxh?(o-=(r-this.resizing.maxh)*this.resizing.type[1],r=this.resizing.maxh):r<this.resizing.minh&&(o-=(r-this.resizing.minh)*this.resizing.type[1],r=this.resizing.minh),this.resizing.type[1]<0&&this.$window.css({top:o-this.resizing.inity}),this.setHeight(r),e=!0}e&&this.fireEvent("resizing")}}function p(){$(document).off("mousemove",this.binding.resize),$(document).off("mouseup",this.binding.resizeStop),$(document.body).css("cursor","auto"),this.$window.find(".resize-border").removeClass("resizing"),this.$window.find(".header").removeClass("resizing"),this.resizing.enabled=!1,this.fireEvent("resize",[this,"end"])}var m={closable:!0,header:!0,modal:!0,width:"auto",height:"auto",title:"Title",alias:"Window",cls:"",toolclose:"close",help:!1,maxwidth:void 0,maxheight:void 0,minwidth:0,minheight:0,enableKeyEvents:!0};return Common.UI.alert=function(t){function e(e){var i=e.getChild(".info-box"),n=e.getChild(".info-box .text > span"),o=e.getChild(".footer"),s=e.getChild(".header"),r=e.getChild(".body"),a=e.getChild(".icon"),l=a.length>0?a.height():0,c=e.getChild(".info-box .dont-show-checkbox");if(t.dontshow||r.css("padding-bottom","10px"),t.maxwidth&&"auto"==t.width&&n.position().left+n.width()+parseInt(i.css("padding-right"))>t.maxwidth&&(t.width=t.maxwidth),"auto"==t.width){i.height(Math.max(n.height(),l)+(c.length>0?c.height()+parseInt(c.css("margin-top")):0)),r.height(parseInt(i.css("height"))+parseInt(o.css("height")));var h=c.find("span");e.setSize(Math.max(n.width(),h.length>0?h.position().left+h.width():0)+n.position().left+parseInt(i.css("padding-right")),parseInt(r.css("height"))+parseInt(s.css("height")))}else n.css("white-space","normal"),e.setWidth(t.width),i.height(Math.max(n.height(),l)+(c.length>0?c.height()+parseInt(c.css("margin-top")):0)),r.height(parseInt(i.css("height"))+parseInt(o.css("height"))),e.setHeight(parseInt(r.css("height"))+parseInt(s.css("height")));n.height()<l-10&&n.css({"vertical-align":"baseline","line-height":l+"px"})}function i(e){t.callback&&t.callback.call(o,e.currentTarget.attributes.result.value,!!s&&"checked"==s.getValue()),o.close(!0)}function n(t){return i({currentTarget:o.getChild(".footer .dlg-btn")[0]}),!1}this.Window.prototype;t.buttons||(t.buttons=["ok"]),t.dontshow=t.dontshow||!1,t.width||(t.width="auto");_.extend(t,{cls:"alert",onprimary:n,tpl:_.template('<div class="info-box"><% if (typeof iconCls !== "undefined") { %><div class="icon <%= iconCls %>"></div><% } %><div class="text" <% if (typeof iconCls == "undefined") { %> style="padding-left:10px;" <% } %>><span><%= msg %></span><% if (dontshow) { %><div class="dont-show-checkbox"></div><% } %></div></div><% if (dontshow) { %><div class="separator horizontal" style="width: 100%;"></div><% } %>')(t)});var o=new Common.UI.Window(t),s=null;return o.on({"render:after":function(n){var r=n.getChild(".footer");t.dontshow&&r.addClass("dontshow"),r.find(".dlg-btn").on("click",i),s=new Common.UI.CheckBox({el:o.$window.find(".dont-show-checkbox"),labelText:t.textDontShow||o.textDontShow}),e(n)},show:function(t){t.getChild(".footer .dlg-btn").focus()},close:function(){t.callback&&t.callback.call(o,"close")}}),o.show(),o},Common.UI.error=function(t){return t=t||{},!t.title&&(t.title=this.Window.prototype.textError),Common.UI.alert(_.extend(t,{iconCls:"error"}))},Common.UI.confirm=function(t){return t=t||{},!t.title&&(t.title=this.Window.prototype.textConfirmation),Common.UI.alert(_.extend(t,{iconCls:"confirm"}))},Common.UI.info=function(t){return t=t||{},!t.title&&(t.title=this.Window.prototype.textInformation),Common.UI.alert(_.extend(t,{iconCls:"info"}))},Common.UI.warning=function(t){return t=t||{},!t.title&&(t.title=this.Window.prototype.textWarning),Common.UI.alert(_.extend(t,{iconCls:"warn"}))},{$window:void 0,$lastmodal:void 0,dragging:{enabled:!1},resizing:{enabled:!1},initialize:function(t){this.initConfig={},this.binding={};var e={ok:this.okButtonText,cancel:this.cancelButtonText,yes:this.yesButtonText,no:this.noButtonText,close:this.closeButtonText};if(t.buttons&&_.isArray(t.buttons)){void 0==t.primary&&(t.primary="ok");var i={};_.each(t.buttons,function(n){"object"==typeof n?void 0!==n.value&&(i[n.value]={text:n.caption,cls:"custom"+(n.primary||t.primary==n.value?" primary":"")}):(i[n]={text:"custom"==n?t.customButtonText:e[n],cls:t.primary==n||_.indexOf(t.primary,n)>-1?"primary":""},"custom"==n&&(i[n].cls+=" custom"))}),t.buttons=i,t.footerCls=t.footerCls||"center"}_.extend(this.initConfig,m,t||{}),!this.initConfig.id&&(this.initConfig.id="window-"+this.cid),!this.initConfig.tpl&&(this.initConfig.tpl=""),Common.UI.BaseView.prototype.initialize.call(this,this.initConfig)},render:function(){var t=this.initConfig.renderTo||document.body;if($(t).append(_.template('<div class="asc-window<%= modal?" modal":"" %><%= cls?" "+cls:"" %>" id="<%= id %>" style="width:<%= width %>px;"><% if (header==true) { %><div class="header"><div class="tools"><% if (closable!==false) %><div class="tool close"></div><% %><% if (help===true) %><div class="tool help">?</div><% %></div><div class="title"><%= title %></div> </div><% } %><div class="body"><%= tpl %><% if (typeof (buttons) !== "undefined" && _.size(buttons) > 0) { %><div class="footer"><% for(var bt in buttons) { %><button class="btn normal dlg-btn <%= buttons[bt].cls %>" result="<%= bt %>"><%= buttons[bt].text %></button><% } %></div><% } %></div></div>')(this.initConfig)),this.$window=$("#"+this.initConfig.id),Common.Locale.getCurrentLanguage()&&"en"!==Common.Locale.getCurrentLanguage()&&this.$window.attr("applang",Common.Locale.getCurrentLanguage()),this.binding.keydown=_.bind(e,this),this.initConfig.header){this.binding.drag=_.bind(c,this),this.binding.dragStop=_.bind(l,this),this.binding.dragStart=_.bind(a,this);var i=function(){this.$window.find(".tool.close").hasClass("disabled")||(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close())},n=function(){this.$window.find(".tool.help").hasClass("disabled")||this.fireEvent("help",this)};this.$window.find(".header").on("mousedown",this.binding.dragStart),this.$window.find(".tool.close").on("click",_.bind(i,this)),this.$window.find(".tool.help").on("click",_.bind(n,this)),this.initConfig.modal||Common.Gateway.on("processmouse",_.bind(h,this))}else this.$window.find(".body").css({top:0,"border-radius":"5px"});"auto"!==this.initConfig.height&&this.$window.css("height",this.initConfig.height),this.initConfig.resizable&&this.setResizable(this.initConfig.resizable);var o=this;return this.binding.winclose=function(t){o.$window&&o.isVisible()&&o.$window==t.$window&&o.close()},Common.NotificationCenter.on("window:close",this.binding.winclose),this.initConfig.footerCls&&this.$window.find(".footer").addClass(this.initConfig.footerCls),this.menuAddAlign=function(t,e,i){var n=this;o.$window.hasClass("notransform")?(t.css({left:e,top:i}),n.options.additionalAlign=null):(o.$window.addClass("notransform"),t.addClass("hidden"),setTimeout(function(){t.removeClass("hidden"),t.css({left:e,top:i}),n.options.additionalAlign=null},300))},this.fireEvent("render:after",this),this},show:function(e,i){if(this.initConfig.modal){var a=t();if(!1===this.options.animate||this.options.animate&&!1===this.options.animate.mask)a.attr("counter",parseInt(a.attr("counter"))+1),a.show();else{var l=$(":root").css("--modal-window-mask-opacity");a.css("opacity",0),a.attr("counter",parseInt(a.attr("counter"))+1),a.show(),setTimeout(function(){a.css(r(l))},1)}Common.NotificationCenter.trigger("modal:show",this),this.$lastmodal=$(".asc-window.modal:not(.dethrone):visible").first().addClass("dethrone")}this.$window?this.$window.is(":visible")||(this.$window.css({opacity:0}),s.call(this),this.$window.show()):(this.render(),n.call(this),_.isNumber(e)&&_.isNumber(i)?(this.$window.css("left",Math.floor(e)),this.$window.css("top",Math.floor(i))):o.call(this)),$(document).on("keydown."+this.cid,this.binding.keydown);var c=this;setTimeout(function(){c.fireEvent("animate:before",c)},10),!1!==this.options.animate?(this.$window.css({"-webkit-transform":"scale(0.8)","-moz-transform":"scale(0.8)","-ms-transform":"scale(0.8)","-o-transform":"scale(0.8)",opacity:0}),setTimeout(function(){c.$window.css({"-webkit-transition":"0.2s opacity, 0.2s -webkit-transform","-webkit-transform":"scale(1)","-moz-transition":"0.2s opacity, 0.2s -moz-transform","-moz-transform":"scale(1)","-ms-transition":"0.2s opacity, 0.2s -ms-transform","-ms-transform":"scale(1)","-o-transition":"0.2s opacity, 0.2s -o-transform","-o-transform":"scale(1)",opacity:"1"}),setTimeout(function(){c.fireEvent("animate:after",c)},210)},1),setTimeout(function(){c.$window.addClass("notransform"),c.fireEvent("show",c)},this.initConfig.modal?1e3:350)):(this.$window.css({opacity:1}),this.$window.addClass("notransform"),this.fireEvent("show",this),setTimeout(function(){c.fireEvent("animate:after",c)},10)),Common.NotificationCenter.trigger("window:show",this)},close:function(e){if($(document).off("keydown."+this.cid),this.initConfig.header&&this.$window.find(".header").off("mousedown",this.binding.dragStart),Common.NotificationCenter.off({"window:close":this.binding.winclose}),this.initConfig.modal){var i=t(),n=!0;if(i.attr("counter",parseInt(i.attr("counter"))-1),this.$lastmodal.length>0&&(this.$lastmodal.removeClass("dethrone"),n=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),n)if(!1!==this.options.animate){var o=$(":root").css("--modal-window-mask-opacity");i.css(r(0)),setTimeout(function(){parseInt(i.attr("counter"))<1&&(i.css("opacity",o),i.hide(),i.attr("counter",0))},300)}else parseInt(i.attr("counter"))<1&&(i.hide(),i.attr("counter",0));Common.NotificationCenter.trigger("modal:close",this,n&&parseInt(i.attr("counter"))<1)}this.$window.remove(),!0!==e&&this.fireEvent("close",this)},hide:function(){if($(document).off("keydown."+this.cid),this.$window){if(this.initConfig.modal){var e=t(),i=!0;if(e.attr("counter",parseInt(e.attr("counter"))-1),this.$lastmodal.length>0&&(this.$lastmodal.removeClass("dethrone"),i=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),i)if(!1!==this.options.animate){var n=$(":root").css("--modal-window-mask-opacity");e.css(r(0)),setTimeout(function(){parseInt(e.attr("counter"))<1&&(e.css("opacity",n),e.hide(),e.attr("counter",0))},300)}else parseInt(e.attr("counter"))<1&&(e.hide(),e.attr("counter",0));Common.NotificationCenter.trigger("modal:hide",this,i&&parseInt(e.attr("counter"))<1)}this.$window.hide(),this.$window.removeClass("notransform"),this.fireEvent("hide",this)}},isLocked:function(){return this.$window.hasClass("dethrone")||!this.initConfig.modal&&this.$window.parent().find(".asc-window.modal:visible").length},getChild:function(t){return t?this.$window.find(t):this.$window},setWidth:function(t){if(t>=0){var e=parseInt(this.$window.css("min-width"));t<e&&(t=e),t-=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),this.$window.width(t)}},getWidth:function(){return parseInt(this.$window.css("width"))},setHeight:function(t){if(t>=0){var e=parseInt(this.$window.css("min-height"));t<e&&(t=e),t-=parseInt(this.$window.css("border-bottom-width"))+parseInt(this.$window.css("border-top-width")),this.$window.height(t),this.initConfig.header&&(t-=parseInt(this.$window.find("> .header").css("height"))),this.$window.find("> .body").css("height",t)}},getHeight:function(){return parseInt(this.$window.css("height"))},setSize:function(t,e){this.setWidth(t),this.setHeight(e)},getSize:function(){return[this.getWidth(),this.getHeight()]},setTitle:function(t){this.$window.find("> .header > .title").text(t)},getTitle:function(){return this.$window.find("> .header > .title").text()},getLeft:function(){return parseInt(this.$window.css("left"))},getTop:function(){return parseInt(this.$window.css("top"))},isVisible:function(){return this.$window&&this.$window.is(":visible")},setResizable:function(t,e,i){if(t!==this.resizable){if(t){var n='<div class="resize-border left" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-right-style: solid; cursor: w-resize;"></div><div class="resize-border left bottom" style="border-bottom-left-radius: 5px; cursor: sw-resize;"></div><div class="resize-border bottom" style="left: 4px; right: 4px; width: auto; z-index: 2; border-top-style: solid; cursor: s-resize;"></div><div class="resize-border right bottom" style="border-bottom-right-radius: 5px; cursor: se-resize;"></div><div class="resize-border right" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-left-style: solid; cursor: e-resize;"></div><div class="resize-border left top" style="border-top-left-radius: 5px; cursor: nw-resize;"></div><div class="resize-border top" style="left: 4px; right: 4px; width: auto; z-index: 2; border-bottom-style:'+(this.initConfig.header?"none":"solid")+'; cursor: n-resize;"></div><div class="resize-border right top" style="border-top-right-radius: 5px; cursor: ne-resize;"></div>';this.initConfig.header&&(n+='<div class="resize-border left" style="top: 5px; height: 28px; cursor: w-resize;"></div><div class="resize-border right" style="top: 5px; height: 28px; cursor: e-resize;"></div>'),this.$window.append(_.template(n)),this.binding.resize=_.bind(u,this),this.binding.resizeStop=_.bind(p,this),this.binding.resizeStart=_.bind(d,this),e&&e.length>1&&(this.initConfig.minwidth=e[0]),e&&e.length>1&&(this.initConfig.minheight=e[1]),i&&i.length>1&&(this.initConfig.maxwidth=i[0]),i&&i.length>1&&(this.initConfig.maxheight=i[1]),this.$window.find(".resize-border").on("mousedown",this.binding.resizeStart)}else this.$window.find(".resize-border").remove();this.resizable=t}else t&&(e&&e.length>1&&(this.initConfig.minwidth=e[0]),e&&e.length>1&&(this.initConfig.minheight=e[1]),i&&i.length>1&&(this.initConfig.maxwidth=i[0]),i&&i.length>1&&(this.initConfig.maxheight=i[1]))},suspendKeyEvents:function(){this.pauseKeyEvents=!1},resumeKeyEvents:function(){this.initConfig.enableKeyEvents&&(this.pauseKeyEvents=!0)},onPrimary:function(){},getFocusedComponents:function(){return[]},getDefaultFocusableComponent:function(){},cancelButtonText:"Cancel",okButtonText:"OK",yesButtonText:"Yes",noButtonText:"No",closeButtonText:"Close",textWarning:"Warning",textError:"Error",textConfirmation:"Confirmation",textInformation:"Information",textDontShow:"Don't show this message again"}}(),Common.UI.Window||{}))}),void 0===Common)var Common={};if(define("common/main/lib/component/LoadMask",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.LoadMask=Common.UI.BaseView.extend(function(){return{options:{cls:"",style:"",title:"Loading...",owner:document.body},template:_.template(['<div id="<%= id %>" class="asc-loadmask-body <%= cls %>" role="presentation" tabindex="-1">','<i id="loadmask-spinner" class="asc-loadmask-image"></i>','<div class="asc-loadmask-title"><%= title %></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.template=this.options.template||this.template,this.title=this.options.title,this.ownerEl=this.options.owner instanceof Common.UI.BaseView?$(this.options.owner.el):$(this.options.owner),this.loaderEl=$(this.template({id:this.id,cls:this.options.cls,style:this.options.style,title:this.title})),this.maskeEl=$('<div class="asc-loadmask"></div>'),this.timerId=0},render:function(){return this},internalShowLoader:function(){this.ownerEl.append(this.loaderEl),this.loaderEl.css("min-width",$(".asc-loadmask-title",this.loaderEl).width()+105),this.ownerEl&&0==this.ownerEl.closest(".asc-window.modal").length&&Common.util.Shortcuts.suspendEvents()},internalShowMask:function(){this.ownerEl.ismasked||(this.ownerEl.ismasked=!0,this.ownerEl.append(this.maskeEl))},show:function(t){if(this.internalShowMask(),this.ownerEl.hasloader)return this;this.ownerEl.hasloader=!0;var e=this;return e.title!=e.options.title&&(e.options.title=e.title,$(".asc-loadmask-title",this.loaderEl).html(e.title)),t?e.internalShowLoader():e.timerId||(e.timerId=setTimeout(function(){e.internalShowLoader()},500)),this},hide:function(){var t=this.ownerEl;this.timerId&&(clearTimeout(this.timerId),this.timerId=0),t&&t.ismasked&&this.maskeEl&&this.maskeEl.remove(),delete t.ismasked,t&&t.hasloader&&(0!=t.closest(".asc-window.modal").length||Common.Utils.ModalWindow.isVisible()||Common.util.Shortcuts.resumeEvents(),this.loaderEl&&this.loaderEl.remove()),delete t.hasloader},setTitle:function(t){if(this.title=t,this.ownerEl&&this.ownerEl.hasloader&&this.loaderEl){var e=$(".asc-loadmask-title",this.loaderEl);e.html(t),this.loaderEl.css("min-width",e.width()+105)}},isVisible:function(){return!!this.ownerEl.ismasked},updatePosition:function(){var t=this.ownerEl,e=this.loaderEl;t&&t.hasloader&&e&&(e.css({top:Math.round(t.height()/2-(e.height()+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom")))/2)+"px",left:Math.round(t.width()/2-(e.width()+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right")))/2)+"px"}),e.css({visibility:"visible"}))}}}())}),function(t){var e=t.fn.tooltip;e.prototype=t.fn.tooltip.Constructor.prototype,t.extend(t.fn.tooltip.Constructor.DEFAULTS,{container:"body",delay:{show:500},arrow:!1});var i=function(t,e){this.init("tooltip",t,e)};i.prototype=t.extend({},t.fn.tooltip.Constructor.prototype,{constructor:i,init:function(){e.prototype.init.apply(this,arguments),"cursor"==this.options.placement&&/hover/.exec(this.options.trigger)&&this.$element.on("mousemove.tooltip",this.options.selector,t.proxy(this.mousemove,this)),this.options.zIndex&&this.tip().css("z-index",this.options.zIndex);var i=this;Common.NotificationCenter.on({"layout:changed":function(t){i.options.keepvisible||i.options.hideonclick||!i.tip().is(":visible")||i.hide()}}),this.isDesktopApp=Common.Controllers.Desktop.isActive()},mousemove:function(t){var e=t.clientX*Common.Utils.zoom(),i=t.clientY*Common.Utils.zoom();this.targetXY=[e,this.isDesktopApp?Math.max(i,14):i]},leave:function(t){e.prototype.leave.apply(this,arguments),this.dontShow=void 0},show:function(i){if(this.hasContent()&&this.enabled&&!this.dontShow){if(!this.$element.is(":visible")&&this.$element.closest("[role=menu]").length>0)return;var n=this.tip();!1===this.options.arrow&&n.addClass("arrow-free"),this.options.cls&&n.addClass(this.options.cls);var o="function"!=typeof this.options.placement?/^([a-zA-Z]+)-?([a-zA-Z]*)$/.exec(this.options.placement):null;if(i||!o||o[2].length){var s=t.Event("show.bs.tooltip");if(this.$element.trigger(s),s.isDefaultPrevented())return;if(this.setContent(),this.options.animation&&n.addClass("fade"),n.detach().css({top:0,left:0,display:"block"}),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element),"function"==typeof this.options.placement)this.options.placement.call(this,n[0],this.$element[0]);else if("object"==typeof i){var r={top:i[1]+15,left:i[0]+18},a=Common.Utils.innerWidth(),l=Common.Utils.innerHeight();r.left+n.width()>a&&(r.left=a-n.width()-30),r.top+n.height()>l&&(r.top=l-n.height()-30),n.offset(r).addClass("in")}else{var c=this.getPosition(),h=n[0].offsetWidth,d=n[0].offsetHeight;switch(o[1]){case"bottom":r={top:c.top+c.height+10};break;case"top":r={top:c.top-d-10}}switch(o[2]){case"left":r.left=c.left,this.$element.outerWidth()<=18&&(r.left-=4);break;case"right":r.left=c.left+c.width-h,this.$element.outerWidth()<=18&&(r.left+=4)}this.applyPlacement(r,o[1]),this.moveArrow(),n.addClass(o[1]).addClass(o[0])}this.$element.trigger("shown.bs.tooltip")}else e.prototype.show.apply(this,arguments);var u=this;clearTimeout(u.timeout),u.timeout=setTimeout(function(){"in"==u.hoverState&&u.hide(),u.dontShow=!1},5e3)}},moveArrow:function(){var t=this.tip().find(".tooltip-arrow, .arrow");switch(this.options.placement){case"top-left":case"bottom-left":t.css("left",10);break;case"top-right":case"bottom-right":t.css("right",10)}},enter:function(e){if("mouseenter"===e.type){var i=t(e.target);if(!(i.is("[role=menu]")||i.parentsUntil(e.currentTarget,"[role=menu]").length&&e.target!==e.currentTarget||this.tip().is(":visible"))){var n=e instanceof this.constructor?e:t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs.tooltip");clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show("cursor"==n.options.placement?n.targetXY:void 0)},n.options.delay.show):n.show()}}},replaceArrow:function(t,i,n){
!1===this.options.arrow?this.arrow().hide():e.prototype.replaceArrow.apply(this,arguments)},getCalculatedOffset:function(t,i,n,o){var s=e.prototype.getCalculatedOffset.apply(this,arguments);if(this.options.offset>0||this.options.offset<0)switch(/(bottom|top)/.exec(t)[1]){case"bottom":s.top+=this.options.offset;break;case"top":s.top-=this.options.offset}return s}});var n=t.fn.tooltip;t.fn.tooltip=function(e){return this.each(function(){var n=t(this),o=n.data("bs.tooltip"),s="object"==typeof e&&e;o||n.data("bs.tooltip",o=new i(this,s)),"string"==typeof e&&o[e]()})},t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=n,this}}(window.jQuery),define("tip",function(){}),define("common/main/lib/component/Tooltip",["tip","backbone"],function(){"use strict";var t=function(t){this.$element=this.placement=void 0,this.init.call(this,t)};_.extend(t.prototype,Backbone.Events,{init:function(t){if(this.$element=t.owner instanceof Backbone.View?t.owner.$el:$(t.owner),this.placement=t.placement,this.$element.data("bs.tooltip")&&this.$element.removeData("bs.tooltip"),this.$element.tooltip({title:t.title,trigger:"manual",placement:t.placement,offset:t.offset,cls:t.cls,html:t.html,hideonclick:t.hideonclick,keepvisible:t.keepvisible}),t.hideonclick){var e=this,i=this.$element.data("bs.tooltip");i&&i.tip().on("click",function(){i.hide(),e.trigger("tooltip:hideonclick",this)})}this.$element.on("shown.bs.tooltip",_.bind(this.onTipShown,this)),this.$element.on("hidden.bs.tooltip",_.bind(this.onTipHidden,this))},show:function(t){this.getBSTip().show(t)},hide:function(t){this.getBSTip().hide(t)},setTitle:function(t){var e=this.getBSTip();e&&(e.options.title=t)},updateTitle:function(){var t=this.getBSTip();t.$tip.find(".tooltip-inner")[t.options.html?"html":"text"](t.options.title)},getBSTip:function(){return this.$element.data("bs.tooltip")},onTipShown:function(){this.trigger("tooltip:show",this)},onTipHidden:function(){this.trigger("tooltip:hide",this)},isVisible:function(){return this.getBSTip().tip().is(":visible")}}),Common.UI=Common.UI||{},Common.UI.Tooltip=t}),void 0===Common)var Common={};if(define("common/main/lib/component/SynchronizeTip",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.SynchronizeTip=Common.UI.BaseView.extend(_.extend(function(){return{options:{target:$(document.body),text:"",placement:"right-bottom",showLink:!0,showButton:!1,closable:!0},template:_.template(['<div class="synch-tip-root <% if (!!scope.options.extCls) {print(scope.options.extCls + " ");} %><%= scope.placement %>" style="<%= scope.style %>">','<div class="asc-synchronizetip">','<div class="tip-arrow <%= scope.placement %>"></div>',"<div>",'<div class="tip-text"><%= scope.text %></div>',"<% if ( scope.closable ) { %>",'<div class="close"></div>',"<% } %>","</div>","<% if ( scope.showLink ) { %>",'<div class="show-link"><label><%= scope.textLink %></label></div>',"<% } %>","<% if ( scope.showButton ) { %>",'<div class="btn-div"><%= scope.textButton %></div>',"<% } %>","</div>","</div>"].join("")),initialize:function(t){this.textSynchronize+=Common.Utils.String.platformKey("Ctrl+S"),Common.UI.BaseView.prototype.initialize.call(this,t),this.target=this.options.target,this.text=_.isEmpty(this.options.text)?this.textSynchronize:this.options.text,this.textLink=_.isEmpty(this.options.textLink)?this.textDontShow:this.options.textLink,this.placement=this.options.placement,this.showLink=this.options.showLink,this.showButton=this.options.showButton,this.closable=this.options.closable,this.textButton=this.options.textButton||"",this.position=this.options.position,this.style=this.options.style||""},render:function(){return this.cmpEl||(this.cmpEl=$(this.template({scope:this})),$(document.body).append(this.cmpEl),this.cmpEl.find(".close").on("click",_.bind(function(){this.trigger("closeclick")},this)),this.cmpEl.find(".show-link label").on("click",_.bind(function(){this.trigger("dontshowclick")},this)),this.cmpEl.find(".btn-div").on("click",_.bind(function(){this.trigger("buttonclick")},this)),this.closable&&this.cmpEl.addClass("closable")),this.applyPlacement(),this},show:function(){this.cmpEl?(this.applyPlacement(),this.cmpEl.show()):this.render()},hide:function(){this.cmpEl&&this.cmpEl.hide(),this.trigger("hide")},close:function(){this.cmpEl&&this.cmpEl.remove()},applyPlacement:function(){var t=this.target&&this.target.length>0?this.target:$(document.body),e=t.offset();if("target"==this.placement&&!this.position)return void this.cmpEl.css({top:e.top+5+"px",left:e.left+5+"px"});if(this.position&&"object"==typeof this.position){var i=this.position.top,n=this.position.left,o=this.position.bottom,s=this.position.right;return void 0!==o||void 0!==i?n=e.left+(t.width()-this.cmpEl.width())/2:i=e.top+(t.height()-this.cmpEl.height())/2,i=void 0!==i?i+"px":"auto",o=void 0!==o?o+"px":"auto",s=void 0!==s?s+"px":"auto",n=void 0!==n?n+"px":"auto",void this.cmpEl.css({top:i,left:n,right:s,bottom:o})}var r=this.placement.split("-");if(r.length>0){var i,n,o,s,a=r[0];if("top"==a?o=Common.Utils.innerHeight()-e.top:"bottom"==a?i=e.top+t.height():"left"==a?s=Common.Utils.innerWidth()-e.left:"right"==a&&(n=e.left+t.width()),"top"==(a=r[1]))o=Common.Utils.innerHeight()-e.top-t.height()/2;else if("bottom"==a){i=e.top+t.height()/2;var l=this.cmpEl.height();i+l>Common.Utils.innerHeight()&&(i=Common.Utils.innerHeight()-l-10)}else"left"==a?s=Common.Utils.innerWidth()-e.left-t.width()/2:"right"==a?n=e.left+t.width()/2:void 0!==o||void 0!==i?n=e.left+(t.width()-this.cmpEl.width())/2:i=e.top+(t.height()-this.cmpEl.height())/2;if(i=void 0!==i?i+"px":"auto",o=void 0!==o?o+"px":"auto",s=void 0!==s?s+"px":"auto",void 0!==n){var c=this.cmpEl.width();n+c>Common.Utils.innerWidth()&&(n=Common.Utils.innerWidth()-c-10),n+="px"}else n="auto";this.cmpEl.css({top:i,left:n,right:s,bottom:o})}},isVisible:function(){return this.cmpEl&&this.cmpEl.is(":visible")},textDontShow:"Don't show this message again",textSynchronize:"The document has been changed by another user.<br>Please click to save your changes and reload the updates."}}(),Common.UI.SynchronizeTip||{}))}),function(t){"function"==typeof define&&define.amd?define("jmousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var r=e||window.event,a=l.call(arguments,1),c=0,h=0,d=0,u=0;if(e=t.event.fix(r),e.type="mousewheel","detail"in r&&(d=-1*r.detail),"wheelDelta"in r&&(d=r.wheelDelta),"wheelDeltaY"in r&&(d=r.wheelDeltaY),"wheelDeltaX"in r&&(h=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(h=-1*d,d=0),c=0===d?h:d,"deltaY"in r&&(d=-1*r.deltaY,c=d),"deltaX"in r&&(h=r.deltaX,0===d&&(c=-1*h)),0!==d||0!==h){if(1===r.deltaMode){var p=t.data(this,"mousewheel-line-height");c*=p,d*=p,h*=p}else if(2===r.deltaMode){var m=t.data(this,"mousewheel-page-height");c*=m,d*=m,h*=m}return u=Math.max(Math.abs(d),Math.abs(h)),(!s||u<s)&&(s=u,n(r,u)&&(s/=40)),n(r,u)&&(c/=40,h/=40,d/=40),c=Math[c>=1?"floor":"ceil"](c/s),h=Math[h>=1?"floor":"ceil"](h/s),d=Math[d>=1?"floor":"ceil"](d/s),e.deltaX=h,e.deltaY=d,e.deltaFactor=s,e.deltaMode=0,a.unshift(e,c,h,d),o&&clearTimeout(o),o=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,a)}}function i(){s=null}function n(t,e){return h.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var o,s,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var c=r.length;c;)t.event.fixHooks[r[--c]]=t.event.mouseHooks;var h=t.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",h.getLineHeight(this)),t.data(this,"mousewheel-page-height",h.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=a.length;t;)this.removeEventListener(a[--t],e,!1);else this.onmousewheel=null},getLineHeight:function(e){return parseInt(t(e)["offsetParent"in t.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),function(t){"use strict";"function"==typeof define&&define.amd?define("perfectscrollbar",["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";var e={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1,includeMargin:!0},i=function(){var t=0;return function(){var e=t;return t+=1,".perfect-scrollbar-"+e}}();t.fn.perfectScrollbar=function(n,o){return this.each(function(){var s=t.extend(!0,{},e),r=t(this);if("object"==typeof n?t.extend(!0,s,n):o=n,"update"===o)return r.data("perfect-scrollbar-update")&&r.data("perfect-scrollbar-update")(),r;if("destroy"===o)return r.data("perfect-scrollbar-destroy")&&r.data("perfect-scrollbar-destroy")(),r;if(r.data("perfect-scrollbar"))return r.data("perfect-scrollbar");r.addClass("ps-container oo");var a,l,c,h,d,u,p,m,f,g,v,b,y=t("<div class='ps-scrollbar-x-rail'></div>").appendTo(r),w=t("<div class='ps-scrollbar-y-rail'></div>").appendTo(r),C=t("<div class='ps-scrollbar-x'></div>").appendTo(y),x=t("<div class='ps-scrollbar-y'></div>").appendTo(w),_=parseInt(y.css("bottom"),10),k=parseInt(w.css("right"),10),S=i(),T=function(t,e){var i=t+e,n=b-g;v=i<0?0:i>n?n:i;var o=parseInt(v*(u-h)/(b-g),10);r.scrollTop(o),y.css({bottom:_-o})},I=function(t,e){var i=t+e,n=f-p;m=i<0?0:i>n?n:i;var o=parseInt(m*(d-c)/(f-p),10);r.scrollLeft(o),w.css({right:k-o})},E=function(t){return s.minScrollbarLength&&(t=Math.max(t,s.minScrollbarLength)),t},D=function(){y.css({left:r.scrollLeft(),bottom:_-r.scrollTop(),width:f,display:a?"inherit":"none"}),w.hasClass("in-scrolling")?w.css({right:k-r.scrollLeft(),height:b,display:l?"inherit":"none"}):w.css({top:r.scrollTop(),right:k-r.scrollLeft(),height:b,display:l?"inherit":"none"}),C&&C.css({left:m,width:p}),x&&x.css({top:v,height:g})},A=function(){c=s.includePadding?r.innerWidth():r.width(),h=s.includePadding?r.innerHeight():r.height(),b=h-(s.includeMargin?parseInt(w.css("margin-top"))+parseInt(w.css("margin-bottom")):0),f=c-(s.includeMargin?parseInt(y.css("margin-left"))+parseInt(y.css("margin-right")):0),d=r.prop("scrollWidth"),u=r.prop("scrollHeight"),!s.suppressScrollX&&c+s.scrollXMarginOffset<d?(a=!0,p=E(parseInt(f*c/d,10)),m=parseInt(r.scrollLeft()*(f-p)/(d-c),10)):(a=!1,p=0,m=0,r.scrollLeft(0)),!s.suppressScrollY&&h+s.scrollYMarginOffset<u?(l=!0,g=E(parseInt(b*h/u,10)),v=parseInt(r.scrollTop()*(b-g)/(u-h),10)):(l=!1,g=0,v=0,r.scrollTop(0)),v>=b-g&&(v=b-g),m>=f-p&&(m=f-p),D(),s.onChange&&s.onChange(this)},U=function(){var e,i;C.bind("mousedown"+S,function(t){Common.NotificationCenter.trigger("hints:clear"),i=t.pageX,e=C.position().left,y.addClass("in-scrolling"),t.stopPropagation(),t.preventDefault()}),t(document).bind("mousemove"+S,function(t){y.hasClass("in-scrolling")&&(I(e,t.pageX-i),t.stopPropagation(),t.preventDefault())}),t(document).bind("mouseup"+S,function(t){y.hasClass("in-scrolling")&&y.removeClass("in-scrolling")}),e=i=null},M=function(){var e,i;x.bind("mousedown"+S,function(t){Common.NotificationCenter.trigger("hints:clear"),i=t.pageY,e=x.position().top,w.addClass("in-scrolling");var n=parseInt(w.css("margin-top")),o=w[0].getBoundingClientRect();w.css({position:"fixed",left:o.left,top:o.top-n}),t.stopPropagation(),t.preventDefault()}),t(document).bind("mousemove"+S,function(t){w.hasClass("in-scrolling")&&(T(e,t.pageY-i),t.stopPropagation(),t.preventDefault())}),t(document).bind("mouseup"+S,function(t){w.hasClass("in-scrolling")&&(w.removeClass("in-scrolling"),w.css({position:"",left:"",top:""}),D())}),e=i=null},$=function(t,e){var i=r.scrollTop();if(0===t){if(!l)return!1;if(0===i&&e>0||i>=u-h&&e<0)return!s.wheelPropagation}var n=r.scrollLeft();if(0===e){if(!a)return!1;if(0===n&&t<0||n>=d-c&&t>0)return!s.wheelPropagation}return!0},P=function(){s.wheelSpeed/=10;var e=!1;r.bind("mousewheel"+S,function(i,n,o,c){Common.NotificationCenter.trigger("hints:clear");var h=i.deltaX*i.deltaFactor||o,d=i.deltaY*i.deltaFactor||c;if(i&&i.target&&("textarea"===i.target.type||"input"===i.target.type)){i.stopImmediatePropagation(),i.preventDefault();var u=t(i.target).scrollTop(),p=0;return i.originalEvent?i.originalEvent.wheelDelta?p=i.originalEvent.wheelDelta:i.originalEvent.deltaY?p=40*-i.originalEvent.deltaY:i.originalEvent.detail&&(p=i.originalEvent.detail):p=void 0!==i.wheelDelta?i.wheelDelta:i.deltaY,void t(i.target).scrollTop(u-p)}e=!1,s.useBothWheelAxes?l&&!a?(d?r.scrollTop(r.scrollTop()-d*s.wheelSpeed):r.scrollTop(r.scrollTop()+h*s.wheelSpeed),e=!0):a&&!l&&(h?r.scrollLeft(r.scrollLeft()+h*s.wheelSpeed):r.scrollLeft(r.scrollLeft()-d*s.wheelSpeed),e=!0):(r.scrollTop(r.scrollTop()-d*s.wheelSpeed),r.scrollLeft(r.scrollLeft()+h*s.wheelSpeed)),A(),(e=e||$(h,d))&&(i.stopPropagation(),i.preventDefault())}),r.bind("MozMousePixelScroll"+S,function(t){e&&t.preventDefault()})},O=function(){var e=!1;r.bind("mouseenter"+S,function(t){e=!0}),r.bind("mouseleave"+S,function(t){e=!1});var i=!1;t(document).bind("keydown"+S,function(n){if(e&&!t(document.activeElement).is(":input,[contenteditable]")){var o=0,s=0;switch(n.which){case 37:o=-30;break;case 38:s=30;break;case 39:o=30;break;case 40:s=-30;break;case 33:s=90;break;case 32:case 34:s=-90;break;case 35:s=-h;break;case 36:s=h;break;default:return}r.scrollTop(r.scrollTop()-s),r.scrollLeft(r.scrollLeft()+o),i=$(o,s),i&&n.preventDefault()}})},L=function(){var t=function(t){t.stopPropagation()};x.bind("click"+S,t),w.bind("click"+S,function(t){var e=parseInt(g/2,10),i=t.pageY-w.offset().top-e,n=b-g,o=i/n;o<0?o=0:o>1&&(o=1),r.scrollTop((u-h)*o)}),C.bind("click"+S,t),y.bind("click"+S,function(t){var e=parseInt(p/2,10),i=t.pageX-y.offset().left-e,n=f-p,o=i/n;o<0?o=0:o>1&&(o=1),r.scrollLeft((d-c)*o)})},z=function(){var e=function(t,e){r.scrollTop(r.scrollTop()-e),r.scrollLeft(r.scrollLeft()-t),A()},i={},n=0,o={},s=null,a=!1;t(window).bind("touchstart"+S,function(t){a=!0}),t(window).bind("touchend"+S,function(t){a=!1}),r.bind("touchstart"+S,function(t){var e=t.originalEvent.targetTouches[0];i.pageX=e.pageX,i.pageY=e.pageY,n=(new Date).getTime(),null!==s&&clearInterval(s),t.stopPropagation()}),r.bind("touchmove"+S,function(t){if(!a&&1===t.originalEvent.targetTouches.length){var s=t.originalEvent.targetTouches[0],r={};r.pageX=s.pageX,r.pageY=s.pageY;var l=r.pageX-i.pageX,c=r.pageY-i.pageY;e(l,c),i=r;var h=(new Date).getTime(),d=h-n;d>0&&(o.x=l/d,o.y=c/d,n=h),t.preventDefault()}}),r.bind("touchend"+S,function(t){clearInterval(s),s=setInterval(function(){if(Math.abs(o.x)<.01&&Math.abs(o.y)<.01)return void clearInterval(s);e(30*o.x,30*o.y),o.x*=.8,o.y*=.8},10)})},V=function(){r.bind("scroll"+S,function(t){A()})},N=function(){r.unbind(S),t(window).unbind(S),t(document).unbind(S),r.data("perfect-scrollbar",null),r.data("perfect-scrollbar-update",null),r.data("perfect-scrollbar-destroy",null),C.remove(),x.remove(),y.remove(),w.remove(),C=x=c=h=d=u=p=m=_=g=v=k=null},R=function(e){r.addClass("ie").addClass("ie"+e);6===e&&(function(){var e=function(){t(this).addClass("hover")},i=function(){t(this).removeClass("hover")};r.bind("mouseenter"+S,e).bind("mouseleave"+S,i),y.bind("mouseenter"+S,e).bind("mouseleave"+S,i),w.bind("mouseenter"+S,e).bind("mouseleave"+S,i),C.bind("mouseenter"+S,e).bind("mouseleave"+S,i),x.bind("mouseenter"+S,e).bind("mouseleave"+S,i)}(),function(){D=function(){C.css({left:m+r.scrollLeft(),bottom:_,width:p}),x.css({top:v+r.scrollTop(),right:k,height:g}),C.hide().show(),x.hide().show()}}())},H="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;return function(){var t=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/);t&&"msie"===t[1]&&R(parseInt(t[2],10)),A(),V(),U(),M(),L(),H&&z(),r.mousewheel&&P(),s.useKeyboard&&O(),r.data("perfect-scrollbar",r),r.data("perfect-scrollbar-update",A),r.data("perfect-scrollbar-destroy",N)}(),r})}}),void 0===Common)var Common={};if(define("common/main/lib/component/Scroller",["jmousewheel","perfectscrollbar","common/main/lib/component/BaseView"],function(){"use strict";Common.UI.Scroller=function(){var t;return _.extend(Common.UI.BaseView.extend({options:{wheelSpeed:20,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:5,scrollYMarginOffset:5,includePadding:!0,includeMargin:!0,alwaysVisibleX:!1,alwaysVisibleY:!1},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(){var t=this;return t.cmpEl=t.$el||$(this.el),t.rendered||(t.cmpEl.perfectScrollbar(_.extend({},t.options)),t.rendered=!0,this.setAlwaysVisibleX(t.options.alwaysVisibleX),this.setAlwaysVisibleY(t.options.alwaysVisibleY)),this},remove:function(){this.destroy(),Backbone.View.prototype.remove.call(this)},update:function(e){var i=this.options;e?(this.destroy(),i=_.extend(this.options,e),this.cmpEl.perfectScrollbar(i)):this.cmpEl.perfectScrollbar("update"),this.setAlwaysVisibleX(i.alwaysVisibleX),this.setAlwaysVisibleY(i.alwaysVisibleY);var n=function(e){t=!0;var i=function(e){$(document).unbind("mouseup",i),_.delay(function(){t=!1},10)};$(document).mouseup(i)};$(".ps-scrollbar-x-rail, .ps-scrollbar-y-rail, .ps-scrollbar-x, .ps-scrollbar-y",this.cmpEl).off("mousedown",n).on("mousedown",n)},destroy:function(){this.cmpEl.perfectScrollbar("destroy")},scrollLeft:function(t){this.cmpEl.scrollLeft(t),this.update()},scrollTop:function(t){this.cmpEl.scrollTop(t),this.update()},getScrollTop:function(){return this.cmpEl.scrollTop()},getScrollLeft:function(){return this.cmpEl.scrollLeft()},setAlwaysVisibleX:function(t){t?($(this.el).find(".ps-scrollbar-x-rail").addClass("always-visible-x"),$(this.el).find(".ps-scrollbar-x").addClass("always-visible-x")):($(this.el).find(".ps-scrollbar-x-rail").removeClass("always-visible-x"),$(this.el).find(".ps-scrollbar-x").addClass("always-visible-x"))},setAlwaysVisibleY:function(t){t?($(this.el).find(".ps-scrollbar-y-rail").addClass("always-visible-y"),$(this.el).find(".ps-scrollbar-y").addClass("always-visible-y")):($(this.el).find(".ps-scrollbar-y-rail").removeClass("always-visible-y"),$(this.el).find(".ps-scrollbar-y").addClass("always-visible-y"))},isVisible:function(){return $(this.el).find(".ps-scrollbar-y-rail").is(":visible")}}),{isMouseCapture:function(){return t}})}()}),void 0===Common)var Common={};define("common/main/lib/component/DataView",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],function(){"use strict";Common.UI.DataViewGroupModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),caption:"",inline:!1,headername:void 0}}}),Common.UI.DataViewGroupStore=Backbone.Collection.extend({model:Common.UI.DataViewGroupModel}),Common.UI.DataViewModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),selected:!1,allowSelected:!0,value:null,disabled:!1}}}),Common.UI.DataViewStore=Backbone.Collection.extend({model:Common.UI.DataViewModel}),Common.UI.DataViewItem=Common.UI.BaseView.extend({options:{},template:_.template(['<div id="<%= id %>"><%= value %></div>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.dataHint=e.options.dataHint||"",e.dataHintDirection=e.options.dataHintDirection||"",e.dataHintOffset=e.options.dataHintOffset||"",e.listenTo(e.model,"change",this.model.get("skipRenderOnChange")?e.onChange:e.render),e.listenTo(e.model,"change:selected",e.onSelectChange),e.listenTo(e.model,"remove",e.remove)},render:function(){if(_.isUndefined(this.model.id))return this;var t=this.$el||$(this.el);t.html(this.template(this.model.toJSON())),t.addClass("item"),t.toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),""!==this.dataHint&&(t.attr("data-hint",this.dataHint),t.attr("data-hint-direction",this.dataHintDirection),t.attr("data-hint-offset",this.dataHintOffset)),_.isUndefined(this.model.get("contentTarget"))||t.attr("content-target",this.model.get("contentTarget")),t.off("click dblclick contextmenu"),t.on({click:_.bind(this.onClick,this),dblclick:_.bind(this.onDblClick,this),contextmenu:_.bind(this.onContextMenu,this)}),t.toggleClass("disabled",!!this.model.get("disabled")),_.isUndefined(this.model.get("cls"))||t.addClass(this.model.get("cls"));var e=t.data("bs.tooltip");return e&&void 0===e.dontShow&&t.is(":hover")&&(e.dontShow=!0),this.trigger("change",this,this.model),this},remove:function(){this.stopListening(this.model),this.trigger("remove",this,this.model),Common.UI.BaseView.prototype.remove.call(this)},onClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("click",this,this.model,t)},onDblClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("dblclick",this,this.model,t)},onContextMenu:function(t){this.trigger("contextmenu",this,this.model,t)},onSelectChange:function(t,e){this.trigger("select",this,t,e)},onChange:function(){if(_.isUndefined(this.model.id))return this;var t=this.$el||$(this.el);return t.toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),t.toggleClass("disabled",!!this.model.get("disabled")),this.trigger("change",this,this.model),this}}),Common.UI.DataView=Common.UI.BaseView.extend({options:{multiSelect:!1,handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,emptyText:"",listenStoreEvents:!0,allowScrollbar:!0,scrollAlwaysVisible:!1,minScrollbarLength:40,showLast:!0,useBSKeydown:!1,cls:""},template:_.template(['<div class="dataview inner <%= cls %>" style="<%= style %>">',"<% _.each(groups, function(group) { %>","<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.store=e.options.store||new Common.UI.DataViewStore,e.groups=e.options.groups||null,e.itemTemplate=e.options.itemTemplate||null,e.itemDataHint=e.options.itemDataHint||"",e.itemDataHintDirection=e.options.itemDataHintDirection||"",e.itemDataHintOffset=e.options.itemDataHintOffset||"",e.multiSelect=e.options.multiSelect,e.handleSelect=e.options.handleSelect,e.parentMenu=e.options.parentMenu,e.outerMenu=e.options.outerMenu,e.enableKeyEvents=e.options.enableKeyEvents,e.useBSKeydown=e.options.useBSKeydown,e.showLast=e.options.showLast,e.style=e.options.style||"",e.cls=e.options.cls||"",e.emptyText=e.options.emptyText||"",e.listenStoreEvents=void 0===e.options.listenStoreEvents||e.options.listenStoreEvents,e.allowScrollbar=void 0===e.options.allowScrollbar||e.options.allowScrollbar,e.scrollAlwaysVisible=e.options.scrollAlwaysVisible||!1,e.minScrollbarLength=e.options.minScrollbarLength||40,e.tabindex=e.options.tabindex||0,e.delayRenderTips=e.options.delayRenderTips||!1,e.parentMenu&&(e.parentMenu.options.restoreHeight=e.options.restoreHeight>0),e.delaySelect=e.options.delaySelect||!1,e.rendered=!1,e.dataViewItems=[],"vertical"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],e.options.el&&e.render()},render:function(t){var e=this;this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({groups:e.groups?e.groups.toJSON():null,style:e.style,cls:e.cls,options:e.options})),t.html(this.cmpEl)):(this.cmpEl=e.$el||$(this.el),this.cmpEl.html(this.template({groups:e.groups?e.groups.toJSON():null,style:e.style,cls:e.cls,options:e.options})));var i=this.cmpEl.closest(".asc-window");return i.length<1&&(i=this.cmpEl.closest('[id^="menu-container-"]')),i.length>0&&(this.tipZIndex=parseInt(i.css("z-index"))+10),this.rendered||(this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems),this.groups&&this.listenTo(this.groups,"add",this.onAddGroup)),this.onResetItems(),this.parentMenu&&(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this))),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(e.showLast||this.parentMenu.on("show:before",function(t){e.deselectAll()}),this.parentMenu.on("show:after",function(t,i){i&&t.el!==i.target||(e.showLast&&e.showLastSelected(),Common.NotificationCenter.trigger("dataview:focus"),_.delay(function(){t.cmpEl.find(".dataview").focus()},10))}).on("hide:after",function(){Common.NotificationCenter.trigger("dataview:blur")}))),_.isUndefined(this.scroller)&&this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,this.cmpEl.on("click",function(t){if(/dataview/.test(t.target.className))return!1}),this.trigger("render:after",this),this},setStore:function(t){t&&(this.stopListening(this.store),this.store=t,this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems)))},selectRecord:function(t,e){if(this.handleSelect){if(e&&this.suspendEvents(),this.extremeSeletedRec=t,!this.multiSelect||!this.pressedShift&&!this.pressedCtrl||!this.currentSelectedRec||this.pressedShift&&this.currentSelectedRec==t)_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),t&&(t.set({selected:!0}),this.currentSelectedRec=t);else if(t)if(this.pressedCtrl)t.set({selected:!t.get("selected")}),this.currentSelectedRec=t;else if(this.pressedShift){var i=this,n=!1;_.each(i.store.models,function(e){i.currentSelectedRec==e||t==e?(n=!n,e.set({selected:!0})):e.set({selected:n})})}return e&&this.resumeEvents(),t}},selectByIndex:function(t,e){if(this.store.length>0&&t>-1&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),t&&this.resumeEvents()},getSelectedRec:function(){return this.multiSelect?this.store.where({selected:!0}):this.store.findWhere({selected:!0})},onAddItem:function(t,e,i){var n=new Common.UI.DataViewItem({template:this.itemTemplate,model:t,dataHint:this.itemDataHint,dataHintDirection:this.itemDataHintDirection,dataHintOffset:this.itemDataHintOffset});if(n){var o=$(this.el).find(".inner").addBack().filter(".inner");if(this.groups&&this.groups.length>0){var s=this.groups.findWhere({id:t.get("group")});s&&(o=o.find("#"+s.id+" .group-items-container"))}var r=_.indexOf(this.store.models,t);if(o){if(i&&"number"==typeof i.at&&i.at>=0)if(0==i.at)o.prepend(n.render().el);else if(this.groups&&this.groups.length>0)o.append(n.render().el);else{var a=o.find("> div");r>0?$(a.get(r-1)).after(n.render().el):a.length>0?$(a[r]).before(n.render().el):o.append(n.render().el)}else o.append(n.render().el);this.dataViewItems.length<1&&o.find(".empty-text").remove(),this.dataViewItems=this.dataViewItems.slice(0,r).concat(n).concat(this.dataViewItems.slice(r));var l=this,c=$(n.el),h=t.get("tip");void 0!==h&&null!==h&&(this.delayRenderTips?c.one("mouseenter",function(){c.attr("data-toggle","tooltip"),c.tooltip({title:t.get("tip"),placement:"cursor",zIndex:l.tipZIndex}),c.mouseenter()}):(c.attr("data-toggle","tooltip"),c.tooltip({title:t.get("tip"),placement:"cursor",zIndex:l.tipZIndex}))),this.listenTo(n,"change",this.onChangeItem),this.listenTo(n,"remove",this.onRemoveItem),this.listenTo(n,"click",this.onClickItem),this.listenTo(n,"dblclick",this.onDblClickItem),this.listenTo(n,"select",this.onSelectItem),this.listenTo(n,"contextmenu",this.onContextMenuItem),this.isSuspendEvents||this.trigger("item:add",this,n,t)}}},onAddGroup:function(t){var e=$(_.template(["<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> group.inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>"].join(""))({group:t.toJSON()})),i=$(this.el).find(".inner").addBack().filter(".inner");if(i){var n=_.indexOf(this.groups.models,t),o=i.find(".grouped-data");n>0?$(o.get(n-1)).after(e):o.length>0?$(o[n]).before(e):i.append(e)}},onResetItems:function(){_.each(this.dataViewItems,function(t){var e=t.$el.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.tip().remove())},this),$(this.el).html(this.template({groups:this.groups?this.groups.toJSON():null,style:this.style,cls:this.cls,options:this.options})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.store.length<1&&this.emptyText.length>0&&$(this.el).find(".inner").addBack().filter(".inner").append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>"),_.each(this.dataViewItems,function(t){this.stopListening(t),t.stopListening(t.model)},this),this.dataViewItems=[];var t=this;this.store.each(function(e){t.onAddItem(e,t.store)},this),this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.disabled&&this.setDisabled(this.disabled),this.attachKeyEvents(),this.lastSelectedRec=null,this._layoutParams=void 0},onChangeItem:function(t,e){this.isSuspendEvents||this.trigger("item:change",this,t,e)},onRemoveItem:function(t,e){var i=t.$el.data("bs.tooltip");if(i&&(void 0===i.dontShow&&(i.dontShow=!0),i.tip().remove()),this.stopListening(t),t.stopListening(),this.store.length<1&&this.emptyText.length>0){var n=$(this.el).find(".inner").addBack().filter(".inner");n.find(".empty-text").length<=0&&n.append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>")}for(var o=0;o<this.dataViewItems.length;o++)if(_.isEqual(t,this.dataViewItems[o])){this.dataViewItems.splice(o,1);break}this.isSuspendEvents||this.trigger("item:remove",this,t,e)},onClickItem:function(t,e,i){if(!this.disabled){window._event=i,this.showLast&&(this.delaySelect?(_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),e&&setTimeout(_.bind(function(){e.set({selected:!0}),this.trigger("item:click",this,t,e,i)},this),300)):this.selectRecord(e)),this.lastSelectedRec=null;var n=t.$el.data("bs.tooltip");n&&n.tip().remove(),this.isSuspendEvents||this.delaySelect||this.trigger("item:click",this,t,e,i)}},onDblClickItem:function(t,e,i){this.disabled||(window._event=i,this.showLast&&this.selectRecord(e),this.lastSelectedRec=null,this.isSuspendEvents||this.trigger("item:dblclick",this,t,e,i))},onSelectItem:function(t,e,i){
this.isSuspendEvents||this.trigger(i?"item:select":"item:deselect",this,t,e,this._fromKeyDown)},onContextMenuItem:function(t,e,i){this.isSuspendEvents||this.trigger("item:contextmenu",this,t,e,i)},scrollToRecord:function(t,e){if(t){var i=$(this.el).find(".inner"),n=i.offset().top,o=_.indexOf(this.store.models,t),s=o>=0&&this.dataViewItems.length>o?$(this.dataViewItems[o].el):i.find("#"+t.get("id"));if(!(s.length<=0)){var r=s.offset().top,a=$(this.dataViewItems[0].el),l=a.length>0?a[0].clientTop:0;(e||r<n+l||r+.9*s.outerHeight()>n+l+i.height())&&(this.scroller&&this.allowScrollbar?this.scroller.scrollTop(i.scrollTop()+r-n-l,0):i.scrollTop(i.scrollTop()+r-n-l))}}},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),this.multiSelect&&(e.keyCode==Common.UI.Keys.CTRL?this.pressedCtrl=!0:e.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!0)),_.indexOf(this.moveKeys,e.keyCode)>-1||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.multiSelect?this.extremeSeletedRec:this.getSelectedRec();if(null===this.lastSelectedRec&&(this.lastSelectedRec=i),e.keyCode==Common.UI.Keys.RETURN)this.lastSelectedRec=null,this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.trigger("item:click",this,this,i,t),this.trigger("item:select",this,this,i,t),this.trigger("entervalue",this,i,t),this.parentMenu&&this.parentMenu.hide();else{this.pressedCtrl=!1;var n=_.indexOf(this.store.models,i);if(n<0)if(e.keyCode==Common.UI.Keys.LEFT){var o=$(t.target).closest(".dropdown-submenu.over");o.length>0?(o.removeClass("over"),o.find("> a").focus()):n=0}else n=0;else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var s=this.dataViewItems[n].topIdx,r=this.dataViewItems[n].leftIdx;if(n=void 0,e.keyCode==Common.UI.Keys.LEFT)for(;void 0===n;){if(--r<0){var o=$(t.target).closest(".dropdown-submenu.over");if(o.length>0){o.removeClass("over"),o.find("> a").focus();break}r=this._layoutParams.columns-1}n=this._layoutParams.itemsIndexes[s][r]}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===n;)r++,r>this._layoutParams.columns-1&&(r=0),n=this._layoutParams.itemsIndexes[s][r];else if(e.keyCode==Common.UI.Keys.UP){if(0==s&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)s--,s<0&&(s=this._layoutParams.rows-1),n=this._layoutParams.itemsIndexes[s][r]}else{if(s==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)s++,s>this._layoutParams.rows-1&&(s=0),n=this._layoutParams.itemsIndexes[s][r]}}else n=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,n-1):Math.min(this.store.length-1,n+1);void 0!==n&&n>=0&&(i=this.store.at(n)),i&&(this._fromKeyDown=!0,this.selectRecord(i),this.scrollToRecord(i),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,i,t)},onKeyUp:function(t){t.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!1),t.keyCode==Common.UI.Keys.CTRL&&(this.pressedCtrl=!1)},attachKeyEvents:function(){if(this.enableKeyEvents&&this.handleSelect){var t=$(this.el).find(".inner").addBack().filter(".inner");t.addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this)),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keyup":"keyup",_.bind(this.onKeyUp,this))}},showLastSelected:function(){if(this.lastSelectedRec)this.selectRecord(this.lastSelectedRec,!0),this.scrollToRecord(this.lastSelectedRec),this.lastSelectedRec=null;else{var t=this.getSelectedRec();this.multiSelect?t&&t.length>0&&this.scrollToRecord(t[t.length-1]):this.scrollToRecord(t)}},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},setEmptyText:function(t){if(this.emptyText=t,this.store.length<1){var e=$(this.el).find(".inner").addBack().filter(".inner").find(".empty-text td");e.length>0&&e.text(this.emptyText)}},alignPosition:function(){var t="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),e=Common.Utils.innerHeight()-10,i=$(this.el).find(".inner").addBack().filter(".inner"),n=i.parent(),o=parseInt(n.css("margin-top"))+parseInt(n.css("margin-bottom"))+parseInt(t.css("margin-top")),s=parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom")),r=t.outerHeight(),a=parseInt(t.css("top")),l={minScrollbarLength:this.minScrollbarLength};this.scrollAlwaysVisible&&(l.alwaysVisibleY=this.scrollAlwaysVisible),a+r>e?(i.css("max-height",e-a-s-o+"px"),this.allowScrollbar&&this.scroller.update(l)):a+r<e&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(e-a-s-o,this.options.restoreHeight)+"px"),this.allowScrollbar&&this.scroller.update(l))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=$(this.dataViewItems[0].el),e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.$el.offset().left,n=t.offset().top,o=-1,s=0,r=0,a=0;a<this.dataViewItems.length;a++){var l=$(this.dataViewItems[a].el).offset().top-n;r=Math.floor(($(this.dataViewItems[a].el).offset().left-i)/e+.01),l>o&&(o=l,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][r]=a,this.dataViewItems[a].topIdx=s,this.dataViewItems[a].leftIdx=r,this._layoutParams.columns<r&&(this._layoutParams.columns=r)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},onResize:function(){this._layoutParams=void 0},focus:function(t){$(this.el).find(".inner").addBack().filter(".inner").focus();var e;"string"==typeof t?"first"==t?e=this.selectByIndex(0,!0):"last"==t&&(void 0===this._layoutParams&&this.fillIndexesArray(),e=this.selectByIndex(this._layoutParams.itemsIndexes[this._layoutParams.rows-1][0],!0)):void 0!==t&&(e=this.selectByIndex(t,!0)),this.scrollToRecord(e)},focusInner:function(t){this.focus(t.keyCode==Common.UI.Keys.DOWN?"first":"last")}}),Common.UI.DataViewSimple=Common.UI.BaseView.extend({options:{handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,scrollAlwaysVisible:!1,useBSKeydown:!1},template:_.template(['<div class="dataview inner" style="<%= style %>">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.store=e.options.store||new Common.UI.DataViewStore,e.itemTemplate=e.options.itemTemplate||null,e.handleSelect=e.options.handleSelect,e.parentMenu=e.options.parentMenu,e.enableKeyEvents=e.options.enableKeyEvents,e.useBSKeydown=e.options.useBSKeydown,e.style=e.options.style||"",e.scrollAlwaysVisible=e.options.scrollAlwaysVisible||!1,e.tabindex=e.options.tabindex||0,e.parentMenu&&(e.parentMenu.options.restoreHeight=e.options.restoreHeight>0),e.rendered=!1,"vertical"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],e.options.el&&e.render()},render:function(t){var e=this;this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style})),t.html(this.cmpEl)):(this.cmpEl=e.$el||$(this.el),this.cmpEl.html(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style,options:e.options})));var i=this.cmpEl.closest(".asc-window");return i.length<1&&(i=this.cmpEl.closest('[id^="menu-container-"]')),i.length>0&&(this.tipZIndex=parseInt(i.css("z-index"))+10),this.rendered||(this.parentMenu?(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this)),this.parentMenu.on("show:after",_.bind(this.onAfterShowMenu,this))):this.store.length>0&&this.onAfterShowMenu(),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(this.parentMenu.on("show:before",function(t){e.deselectAll()}),this.parentMenu.on("show:after",function(t){Common.NotificationCenter.trigger("dataview:focus"),_.delay(function(){t.cmpEl.find(".dataview").focus()},10)}).on("hide:after",function(){Common.NotificationCenter.trigger("dataview:blur")})),this.attachKeyEvents(),this.cmpEl.on("click","div.item",_.bind(e.onClickItem,e))),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,this.cmpEl.on("click",function(t){if(/dataview/.test(t.target.className))return!1}),this.trigger("render:after",this),this},selectRecord:function(t,e){if(this.handleSelect){if(e&&this.suspendEvents(),this.deselectAll(e),t){t.set({selected:!0});var i=_.indexOf(this.store.models,t);i>=0&&this.dataViewItems&&this.dataViewItems.length>i&&this.dataViewItems[i].el.addClass("selected")}return e&&this.resumeEvents(),t}},selectByIndex:function(t,e){if(this.store.length>0&&t>-1&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),function(t){t.set({selected:!1})}),this.cmpEl.find(".item.selected").removeClass("selected"),t&&this.resumeEvents()},getSelectedRec:function(){return this.store.findWhere({selected:!0})},onResetItems:function(){this.dataViewItems&&_.each(this.dataViewItems,function(t){var e=t.el.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.tip().remove())},this),this.dataViewItems=null;var t=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>"].join(""));this.cmpEl&&this.cmpEl.find(".inner").html(t({items:this.store.toJSON(),itemTemplate:this.itemTemplate,style:this.style})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible}),!this.parentMenu&&this.store.length>0&&this.onAfterShowMenu(),this._layoutParams=void 0},setStore:function(t){t&&(this.store=t,this.onResetItems())},onClickItem:function(t){if(!this.disabled){window._event=t;var e=$(t.currentTarget).closest("div.item").index(),i=e>=0?this.store.at(e):null,n=e>=0?this.dataViewItems[e]:null;if(i&&n){i.set({selected:!0});var o=n.el.data("bs.tooltip");o&&o.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,n.el,i,t)}}},onAfterShowMenu:function(t){if(!this.dataViewItems){var e=this;this.dataViewItems=[],_.each(this.cmpEl.find("div.item"),function(t,i){var n=$(t),o=e.store.at(i);e.dataViewItems.push({el:n}),o.get("tip")&&n.tooltip({title:o.get("tip"),placement:"cursor",zIndex:e.tipZIndex})})}},scrollToRecord:function(t){if(t){var e=$(this.el).find(".inner"),i=e.offset().top,n=_.indexOf(this.store.models,t),o=n>=0&&this.dataViewItems.length>n?this.dataViewItems[n].el:e.find("#"+t.get("id"));if(!(o.length<=0)){var s=o.offset().top,r=this.dataViewItems[0].el,a=r.length>0?r[0].offsetTop:0;(s<i+a||s+o.outerHeight()>i+e.height())&&(this.scroller?this.scroller.scrollTop(e.scrollTop()+s-i-a,0):e.scrollTop(e.scrollTop()+s-i-a))}}},onKeyDown:function(t,e){function i(){for(var t=0;!this.dataViewItems[t].el.is(":visible");)t++;return t}if(!this.disabled)if(void 0===e&&(e=t),_.indexOf(this.moveKeys,e.keyCode)>-1||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var n=this.getSelectedRec();if(e.keyCode==Common.UI.Keys.RETURN)this.selectedBeforeHideRec&&(n=this.selectedBeforeHideRec),this.canAddRecents&&this.addRecentItem(n),this.trigger("item:click",this,this,n,t),this.parentMenu&&this.parentMenu.hide();else{var o=_.indexOf(this.store.models,n);if(o<0)if(e.keyCode==Common.UI.Keys.LEFT){var s=$(t.target).closest(".dropdown-submenu.over");s.length>0?(s.removeClass("over"),s.find("> a").focus()):o=i.call(this)}else o=i.call(this);else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var r=this.dataViewItems[o].topIdx,a=this.dataViewItems[o].leftIdx;if(o=void 0,e.keyCode==Common.UI.Keys.LEFT)for(;void 0===o;){if(--a<0){var s=$(t.target).closest(".dropdown-submenu.over");if(s.length>0){s.removeClass("over"),s.find("> a").focus();break}a=this._layoutParams.columns-1}o=this._layoutParams.itemsIndexes[r][a]}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===o;)a++,a>this._layoutParams.columns-1&&(a=0),o=this._layoutParams.itemsIndexes[r][a];else if(e.keyCode==Common.UI.Keys.UP){if(0==r&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===o;)r--,r<0&&(r=this._layoutParams.rows-1),o=this._layoutParams.itemsIndexes[r][a]}else{if(r==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===o;)r++,r>this._layoutParams.rows-1&&(r=0),o=this._layoutParams.itemsIndexes[r][a]}}else o=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,o-1):Math.min(this.store.length-1,o+1);void 0!==o&&o>=0&&(n=this.store.at(o)),n&&(this._fromKeyDown=!0,this.selectRecord(n),this.scrollToRecord(n),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,n,t)},attachKeyEvents:function(){if(this.enableKeyEvents&&this.handleSelect){var t=$(this.el).find(".inner").addBack().filter(".inner");t.addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this))}},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},alignPosition:function(){var t="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),e=Common.Utils.innerHeight()-10,i=$(this.el).find(".inner").addBack().filter(".inner"),n=i.parent(),o=parseInt(n.css("margin-top"))+parseInt(n.css("margin-bottom"))+parseInt(t.css("margin-top")),s=parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom")),r=t.outerHeight(),a=parseInt(t.css("top")),l={minScrollbarLength:this.minScrollbarLength};this.scrollAlwaysVisible&&(l.alwaysVisibleY=this.scrollAlwaysVisible);var c=!1;if(this.parentMenu.menuAlign){var h=this.parentMenu.menuAlign.match(/^([a-z]+)-([a-z]+)/);c="bl"===h[1]||"br"===h[1]}if(c){var d=a+r;a<0?(i.css("max-height",d-s-o+"px"),t.css("top",0),this.scroller.update(l)):a>0&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(d-s-o,this.options.restoreHeight)+"px"),t.css("top",d-t.outerHeight()),this.scroller.update(l))}else a+r>e?(i.css("max-height",e-a-s-o+"px"),this.scroller.update(l)):a+r<e&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(e-a-s-o,this.options.restoreHeight)+"px"),this.scroller.update(l))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=this.$el.offset().left,n=t.offset().top,o=-1,s=0,r=0,a=0;a<this.dataViewItems.length;a++){var l=this.dataViewItems[a],c=l.el.offset().top-n;r=Math.floor((l.el.offset().left-i)/e),c>o&&(o=c,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][r]=a,l.topIdx=s,l.leftIdx=r,this._layoutParams.columns<r&&(this._layoutParams.columns=r)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},onResize:function(){this._layoutParams=void 0},focus:function(){this.cmpEl&&this.cmpEl.find(".dataview").focus()}}),$(document).on("keydown.dataview","[data-toggle=dropdown], [role=menu]",function(t){t.keyCode!==Common.UI.Keys.UP&&t.keyCode!==Common.UI.Keys.DOWN&&t.keyCode!==Common.UI.Keys.LEFT&&t.keyCode!==Common.UI.Keys.RIGHT&&t.keyCode!==Common.UI.Keys.RETURN||_.defer(function(){var e=$(t.target).closest(".dropdown-toggle");e.length?e.parent().find(".inner.canfocused").trigger("dataview:keydown",t):$(t.target).closest(".dropdown-submenu").find(".inner.canfocused").trigger("dataview:keydown",t)},100)}),Common.UI.DataViewShape=Common.UI.DataViewSimple.extend(_.extend({template:_.template(['<div class="dataview inner" style="<%= style %>">',"<% _.each(options.groupsWithRecent, function(group, index) { %>",'<div class="grouped-data <% if (index === 0) { %> recent-group <% } %> " id="<%= group.id %>" >',"<% if (!_.isEmpty(group.groupName)) { %>",'<div class="group-description">',"<span><%= group.groupName %></span>","</div>","<% } %>",'<div class="group-items-container <% if (index === 0) { %> recent-items <% } %>">',"<% _.each(group.groupStore.toJSON(), function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }); %>","</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){var e=this;this.canAddRecents=!0,this._state={hideTextRect:t.hideTextRect,hideLines:t.hideLines};var i=Common.localStorage.getKeysFilter();this.appPrefix=i&&i.length?i.split(",")[0]:"",e.groups=t.groups.toJSON();var n=new Common.UI.DataViewGroupStore,o=t.recentShapes||[],s=o.length>18?7:6,r=35*Math.ceil(o.length/s)+3,a=30*s;if(e.recentShapes=o,e.recentShapes.length>0){if(!_.findWhere(e.groups,{groupName:e.recentShapes[0].groupName})){for(var l=0;l<e.recentShapes.length;l++)for(var c,h=e.recentShapes[l].data.shapeType,d=0;d<e.groups.length;d++){for(var u=e.groups[d].groupStore,p=e.groups[d].groupName,m=0;m<u.length;m++)if(u.at(m).get("data").shapeType===h){c=u.at(m).toJSON(),e.recentShapes[l]={data:c.data,tip:c.tip,allowSelected:c.allowSelected,selected:!1,groupName:p};break}if(c){c=void 0;break}}Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(e.recentShapes))}}if(e.recentShapes.length<12){for(var f=12-e.recentShapes.length,g=[],v=function(t,e){var i=t.toJSON(),n={data:i.data,tip:i.tip,allowSelected:i.allowSelected,selected:!1,groupName:e};g.push(n)},m=0;m<e.groups.length&&f>0;m++){var b=e.groups[m].groupStore,p=e.groups[m].groupName;0===m?(v(b.at(1),p),--f>0&&(v(b.at(2),p),f--)):3!==m&&6!==m&&7!==m&&(v(b.at(0),p),--f>0&&(v(b.at(1),p),f--))}e.recentShapes=e.recentShapes.concat(g)}n.add(e.recentShapes),e.groups.unshift({groupName:t.textRecentlyUsed,groupStore:n,groupWidth:a,groupHeight:r}),e.options.groupsWithRecent=e.groups;var u=new Common.UI.DataViewStore;_.each(e.groups,function(t,e){var i=t.groupStore.models;if(e>0)for(var n=0;n<i.length;n++)i[n].set({groupName:t.groupName});u.add(i)}),t.store=u,Common.UI.DataViewSimple.prototype.initialize.call(this,t),e.parentMenu.on("show:before",function(){e.updateRecents()}),e._state.hideLines&&e.hideLinesGroup()},onAfterShowMenu:function(t){var e=this,i=!1;if(e.dataViewItems||(e.dataViewItems=[],_.each(e.cmpEl.find("div.grouped-data"),function(t,i){_.each($(t).find("div.item"),function(t,n){var o=$(t),s=e.groups[i].groupStore.at(n);e.dataViewItems.push({el:o,groupIndex:i,index:n});var r=s.get("tip");r&&o.one("mouseenter",function(){o.attr("data-toggle","tooltip"),o.tooltip({title:r,placement:"cursor",zIndex:e.tipZIndex}),o.mouseenter()})})}),i=!0),e.updateDataViewItems&&e.cmpEl.is(":visible")){for(var n=_.where(e.dataViewItems,{groupIndex:0}),o=n?n.length:0,s=0;s<o;s++){var r=e.dataViewItems[s].el.data("bs.tooltip");r&&(void 0===r.dontShow&&(r.dontShow=!0),r.tip().remove())}e.dataViewItems=e.dataViewItems.slice(o);var a=[];_.each(e.cmpEl.find(".recent-group div.item"),function(t,i){var n=$(t),o=e.recentShapes[i];a.push({el:n,groupIndex:0,index:i});var s=o.tip;s&&n.one("mouseenter",function(){n.attr("data-toggle","tooltip"),n.tooltip({title:s,placement:"cursor",zIndex:e.tipZIndex}),n.mouseenter()})}),e.dataViewItems=a.concat(e.dataViewItems),1===e.recentShapes.length&&$(".recent-group").show(),e.updateDataViewItems=!1,i=!0}this._state.hideLines&&e.hideLines(),i&&e.hideTextRect(e._state.hideTextRect),e.fillIndexesArray()},onClickItem:function(t){if(!this.disabled){window._event=t;var e=$(t.currentTarget).closest("div.grouped-data").index(),i=$(t.currentTarget).closest("div.item").data("index"),n=_.findIndex(this.dataViewItems,function(t){return t.groupIndex===e&&t.index===i}),o=n>=0?this.store.at(n):null,s=n>=0?this.dataViewItems[n]:null;if(o&&s){o.set({selected:!0});var r=s.el.data("bs.tooltip");r&&r.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,s.el,o,t),this.addRecentItem(o)}}},addRecentItem:function(t){for(var e=this,i=!1,n=t.get("data").shapeType,o=t.get("groupName"),s=0;s<e.recentShapes.length;s++)if(e.recentShapes[s].data.shapeType===n){i=!0;break}if(!i){var r=t.toJSON(),a={data:r.data,tip:r.tip,allowSelected:r.allowSelected,selected:!1,groupName:o},l=[a].concat(e.recentShapes.slice(0,11));Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(l)),e.recentShapes=void 0}},updateRecents:function(){var t=this,e=Common.localStorage.getItem(this.appPrefix+"recent-shapes");e=e?JSON.parse(e):[];var i=!1;if(t.recentShapes)for(var n=0;n<e.length;n++)(!t.recentShapes[n]||t.recentShapes[n]&&e[n].tip!==t.recentShapes[n].tip)&&(i=!0);else i=!0;if(e.length>0&&i){t.recentShapes=e;var o=new Common.UI.DataViewStore;_.each(t.recentShapes,function(t){var e={data:{shapeType:t.data.shapeType},tip:t.tip,allowSelected:t.allowSelected,selected:t.selected,groupName:t.groupName};o.push(e)}),t.groups[0].groupStore=o;var s=new Common.UI.DataViewStore;_.each(t.groups,function(t){s.add(t.groupStore.models)}),t.store=s;var r=_.template(["<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }) %>"].join(""));t.cmpEl&&t.cmpEl.find(".recent-items").html(r({items:t.recentShapes,itemTemplate:this.itemTemplate,style:this.style})),t.updateDataViewItems=!0}},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=0;!this.dataViewItems[e].el.is(":visible");)e++,t=this.dataViewItems[e].el;for(var i=t.outerWidth()+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right")),n=this.$el.offset().left,o=t.offset().top,s=-1,r=0,a=e,l=0;l<this.dataViewItems.length;l++){var c=this.dataViewItems[l];if(c.el.is(":visible")){var h=c.el.offset().top-o;a=Math.floor((c.el.offset().left-n)/i),h>s&&(s=h,this._layoutParams.itemsIndexes.push([]),r=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[r][a]=l,c.topIdx=r,c.leftIdx=a,this._layoutParams.columns<a&&(this._layoutParams.columns=a)}else c.topIdx=-1,c.leftIdx=-1}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},hideTextRect:function(t){var e=this;this.store.each(function(i,n){"textRect"===i.get("data").shapeType&&e.dataViewItems[n].el[t?"addClass":"removeClass"]("hidden")},this),this._state.hideTextRect=t},hideLinesGroup:function(){$(this.cmpEl.find("div.grouped-data")[9]).hide()},hideLines:function(){var t=this;this.store.each(function(e,i){if("Lines"===e.get("groupName")){var n=t.dataViewItems[i].el;n.is(":visible")&&n.addClass("hidden")}},this)}}))}),void 0===window.Common&&(window.Common={}),void 0===Common.Utils&&(Common.Utils={});var utils=new function(){var t=navigator.userAgent.toLowerCase(),e=function(e){return e.test(t)},i="CSS1Compat"==document.compatMode,n=function(e,i){var n;return e&&(n=i.exec(t))?parseFloat(n[1]):0},o=document.documentMode,s=(e(/edge/),e(/opera/)),r=s&&e(/version\/10\.5/),a=!s&&(e(/msie/)||e(/trident/)||e(/edge/)),l=a&&(e(/msie 7/)&&8!=o&&9!=o&&10!=o||7==o),c=a&&(e(/msie 8/)&&7!=o&&9!=o&&10!=o||8==o),h=a&&(e(/msie 9/)&&7!=o&&8!=o&&10!=o||9==o),d=a&&(e(/msie 10/)&&7!=o&&8!=o&&9!=o||10==o),u=a&&(e(/trident\/7\.0/)&&7!=o&&8!=o&&9!=o&&10!=o||11==o),p=a&&e(/msie 6/),m=!a&&e(/\bchrome\b/),f=!a&&e(/webkit/),g=!a&&!m&&e(/safari/),v=g&&e(/applewebkit\/4/),b=g&&e(/version\/3/),y=g&&e(/version\/4/),w=g&&e(/version\/5\.0/),C=g&&e(/version\/5/),x=!f&&!a&&e(/gecko/),_=x&&e(/rv:1\.9/),k=x&&e(/rv:2\.0/),S=x&&e(/rv:5\./),T=x&&e(/rv:10\./),I=_&&e(/rv:1\.9\.0/),E=_&&e(/rv:1\.9\.1/),D=_&&e(/rv:1\.9\.2/),A=e(/windows|win32/),U=e(/macintosh|mac os x/),M=e(/linux/),P=n(!0,/\bchrome\/(\d+\.\d+)/),O=n(!0,/\bfirefox\/(\d+\.\d+)/),L=n(a,/msie (\d+\.\d+)/),z=n(s,/version\/(\d+\.\d+)/),V=n(g,/version\/(\d+\.\d+)/),N=n(f,/webkit\/(\d+\.\d+)/),R=/^https/i.test(window.location.protocol),H=/^(mailto:)?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-яё0-9\._%+-=\? :&]*)/i,F=/^(((https?)|(ftps?)):\/\/)?([\-\wа-яё]*:?[\-\wа-яё]*@)?(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/+@&#;:`~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?/i,B=/^(((https?)|(ftps?)):\/\/)?([\-\wа-яё]*:?[\-\wа-яё]*@)?(([\-\wа-яё]+\.)+[\wа-яё\-]{2,}(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?)/i,j=/^(((https?)|(ftps?)):\/\/)([\-\wа-яё]*:?[\-\wа-яё]*@)?(([\-\wа-яё]+)(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?)/i,W=/(mailto:)?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-яё0-9\._%+-=\?:&]*)/gi,q=/(mailto:|\s[@]|\s[+])?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-яё0-9\._%\+-=\?:&]*)/gi,K=/(((https?)|(ftps?)):\/\/([\-\wа-яё]*:?[\-\wа-яё]*@)?)(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?/gi,Y=/((((https?)|(ftps?)):\/\/([\-\wа-яё]*:?[\-\wа-яё]*@)?)|(([\-\wа-яё]*:?[\-\wа-яё]*@)?www\.))((([\-\wа-яё]+\.)+[\wа-яё\-]{2,}|([\-\wа-яё]+))(:\d+)?(\/[%\-\wа-яё]*(\.[\wа-яё]{2,})?(([\wа-яё\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wа-яё]{2,})?)*)*\/?)/gi,G={Paragraph:0,Table:1,Header:2,TextArt:3,Shape:4,Image:5,Slide:6,Chart:7,MailMerge:8,Signature:9,Pivot:10,Cell:11,Slicer:12,Form:13},X={DRM:0,CSV:1,TXT:2,Paste:3,Columns:4,Data:5},J=(/android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent||navigator.vendor||window.opera),this),Q=function(){var t={};if(window.AscCommon&&window.AscCommon.checkDeviceScale)t=window.AscCommon.checkDeviceScale(),AscCommon.correctApplicationScale(t);else{window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.25) and (-webkit-max-device-pixel-ratio: 1.49), screen and (min-resolution: 1.25dppx) and (max-resolution: 1.49dppx)").matches?t.devicePixelRatio=1.5:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5) and (-webkit-max-device-pixel-ratio: 1.74), screen and (min-resolution: 1.5dppx) and (max-resolution: 1.74dppx)").matches?t.devicePixelRatio=1.5:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.75) and (-webkit-max-device-pixel-ratio: 1.99), screen and (min-resolution: 1.75dppx) and (max-resolution: 1.99dppx)").matches?t.devicePixelRatio=1.75:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2), screen and (min-resolution: 2dppx), screen and (min-resolution: 192dpi)").matches?t.devicePixelRatio=2:t.devicePixelRatio=1}var e=$(document.body),i=document.body.className,n=i.replace(/pixel-ratio__[\w-]+/gi,"").trim();t.devicePixelRatio<1.25?/pixel-ratio__/.test(i)&&(document.body.className=n):t.devicePixelRatio<1.5?/pixel-ratio__1_25/.test(i)||(document.body.className=n+" pixel-ratio__1_25"):t.devicePixelRatio<1.75?/pixel-ratio__1_5/.test(i)||(document.body.className=n+" pixel-ratio__1_5"):!(t.devicePixelRatio<1.75)&&t.devicePixelRatio<2?/pixel-ratio__1_75/.test(i)||(document.body.className=n+" pixel-ratio__1_75"):(e.addClass("pixel-ratio__2"),/pixel-ratio__2/.test(i)||(document.body.className=n+" pixel-ratio__2")),J.zoom=t.correct?t.zoom:1,J.innerWidth=window.innerWidth*J.zoom,J.innerHeight=window.innerHeight*J.zoom,J.applicationPixelRatio=t.applicationPixelRatio||t.devicePixelRatio};return checkSizeIE=function(){J.innerWidth=window.innerWidth,J.innerHeight=window.innerHeight},J.zoom=1,J.applicationPixelRatio=1,J.innerWidth=window.innerWidth,J.innerHeight=window.innerHeight,a?($(document.body).addClass("ie"),$(window).on("resize",checkSizeIE)):(Q(),$(window).on("resize",Q)),{checkSize:Q,userAgent:t,isStrict:i,isIEQuirks:a&&!i&&(p||l||c||h),isOpera:s,isOpera10_5:r,isWebKit:f,isChrome:m,isSafari:g,isSafari3:b,isSafari4:y,isSafari5:C,isSafari5_0:w,isSafari2:v,isIE:a,isIE6:p,isIE7:l,isIE7m:p||l,isIE7p:a&&!p,isIE8:c,isIE8m:p||l||c,isIE8p:a&&!(p||l),isIE9:h,isIE9m:p||l||c||h,isIE9p:a&&!(p||l||c),isIE10:d,isIE10m:p||l||c||h||d,isIE10p:a&&!(p||l||c||h),isIE11:u,isIE11m:p||l||c||h||d||u,isIE11p:a&&!(p||l||c||h||d),isGecko:x,isGecko3:_,isGecko4:k,isGecko5:S,isGecko10:T,isFF3_0:I,isFF3_5:E,isFF3_6:D,isFF4:4<=O&&O<5,isFF5:5<=O&&O<6,isFF10:10<=O&&O<11,isLinux:M,isWindows:A,isMac:U,chromeVersion:P,firefoxVersion:O,ieVersion:L,operaVersion:z,safariVersion:V,webKitVersion:N,isSecure:R,emailRe:H,ipRe:F,hostnameRe:B,localRe:j,emailStrongRe:W,emailAddStrongRe:q,ipStrongRe:K,hostnameStrongRe:Y,documentSettingsType:G,importTextType:X,zoom:function(){return J.zoom},applicationPixelRatio:function(){return J.applicationPixelRatio},topOffset:0,innerWidth:function(){return J.innerWidth},innerHeight:function(){return J.innerHeight},croppedGeometry:function(){return{left:0,top:Common.Utils.InternalSettings.get("window-inactive-area-top"),width:J.innerWidth,height:J.innerHeight-Common.Utils.InternalSettings.get("window-inactive-area-top")}}}};Common.Utils=_extend_object(Common.Utils,utils),Common.Utils.ThemeColor=new function(){return{ThemeValues:[6,15,7,16,0,1,2,3,4,5],setColors:function(t,e){var i,n,o;if(e&&e.length>0){var s=[];for(i=0;i<e.length;i++)o=this.getHexColor(e[i].get_r(),e[i].get_g(),e[i].get_b()),s.push(o);this.standartcolors=s}var r=[];for(i=0;i<6;i++)for(n=0;n<10;n++){var a=i+6*n;o={color:this.getHexColor(t[a].get_r(),t[a].get_g(),t[a].get_b()),effectId:a,effectValue:this.ThemeValues[n]},r.push(o)}this.effectcolors=r},getEffectColors:function(){return this.effectcolors},getStandartColors:function(){return this.standartcolors},getHexColor:function(t,e,i){return t=t.toString(16),e=e.toString(16),i=i.toString(16),1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),t+e+i},
getRgbColor:function(t){var e="object"==typeof t?t.color:t;e=e.replace(/#/,""),3==e.length&&(e=e.replace(/(.)/g,"$1$1")),e=parseInt(e,16);var i=new Asc.asc_CColor;return i.put_type("object"==typeof t&&void 0!==t.effectId?Asc.c_oAscColor.COLOR_TYPE_SCHEME:Asc.c_oAscColor.COLOR_TYPE_SRGB),i.put_r(e>>16),i.put_g((65280&e)>>8),i.put_b(255&e),i.put_a(255),void 0!==t.effectId&&i.put_value(t.effectId),i},colorValue2EffectId:function(t){if("object"==typeof t&&t&&void 0!==t.effectValue&&this.effectcolors)for(var e=0;e<this.effectcolors.length;e++)if(this.effectcolors[e].effectValue===t.effectValue&&t.color.toUpperCase()===this.effectcolors[e].color.toUpperCase()){t.effectId=this.effectcolors[e].effectId;break}return t}}};var metrics=new function(){var t=this;return t.c_MetricUnits={cm:0,pt:1,inch:2},t.currentMetric=t.c_MetricUnits.pt,t.metricName=["Cm","Pt","Inch"],t.defaultMetric=t.c_MetricUnits.cm,{c_MetricUnits:t.c_MetricUnits,txtCm:"cm",txtPt:"pt",txtInch:'"',setCurrentMetric:function(e){t.currentMetric=e},getCurrentMetric:function(){return t.currentMetric},getCurrentMetricName:function(){return this["txt"+t.metricName[t.currentMetric]]},getMetricName:function(e){return this["txt"+t.metricName[void 0!==e?e:0]]},setDefaultMetric:function(e){t.defaultMetric=e},getDefaultMetric:function(){return t.defaultMetric},fnRecalcToMM:function(e){if(null!==e&&void 0!==e)switch(t.currentMetric){case t.c_MetricUnits.cm:return 10*e;case t.c_MetricUnits.pt:return 25.4*e/72;case t.c_MetricUnits.inch:return 25.4*e}return e},fnRecalcFromMM:function(e){switch(t.currentMetric){case t.c_MetricUnits.cm:return parseFloat((e/10).toFixed(4));case t.c_MetricUnits.pt:return parseFloat((72*e/25.4).toFixed(3));case t.c_MetricUnits.inch:return parseFloat((e/25.4).toFixed(3))}return e}}};Common.Utils.Metric=_extend_object(metrics,Common.Utils.Metric),Common.Utils.RGBColor=function(t){var e,i,n;"#"==t.charAt(0)&&(t=t.substr(1,6)),t=t.replace(/ /g,""),t=t.toLowerCase();for(var o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^hsb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){var e={},i=Math.round(t[1]),n=Math.round(255*t[2]/100),o=Math.round(255*t[3]/100);if(0==n)e.r=e.g=e.b=o;else{var s=o,r=(255-n)*o/255,a=i%60*(s-r)/60;360==i&&(i=0),i<60?(e.r=s,e.b=r,e.g=r+a):i<120?(e.g=s,e.b=r,e.r=s-a):i<180?(e.g=s,e.r=r,e.b=r+a):i<240?(e.b=s,e.r=r,e.g=s-a):i<300?(e.b=s,e.g=r,e.r=r+a):i<360?(e.r=s,e.g=r,e.b=s-a):(e.r=0,e.g=0,e.b=0)}return[Math.round(e.r),Math.round(e.g),Math.round(e.b)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],s=0;s<o.length;s++){var r=o[s].re,a=o[s].process,l=r.exec(t);if(l){var c=a(l);e=c[0],i=c[1],n=c[2]}}return e=e<0||isNaN(e)?0:e>255?255:e,i=i<0||isNaN(i)?0:i>255?255:i,n=n<0||isNaN(n)?0:n>255?255:n,{r:e,g:i,b:n,isEqual:function(t){return e==t.r&&i==t.g&&n==t.b},toRGB:function(){return"rgb("+e+", "+i+", "+n+")"},toRGBA:function(t){return void 0===t&&(t=1),"rgba("+e+", "+i+", "+n+", "+t+")"},toHex:function(){var t=e.toString(16),o=i.toString(16),s=n.toString(16);return 1==t.length&&(t="0"+t),1==o.length&&(o="0"+o),1==s.length&&(s="0"+s),"#"+t+o+s},toHSB:function(){var t={h:0,s:0,b:0},o=Math.min(e,i,n),s=Math.max(e,i,n),r=s-o;return t.b=s,t.s=0!=s?255*r/s:0,0!=t.s?t.h=e==s?0+(i-n)/r:i==s?2+(n-e)/r:4+(e-i)/r:t.h=0,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t.h=parseInt(t.h),t.s=parseInt(t.s),t.b=parseInt(t.b),t}}};var utilsString=new function(){return{textCtrl:"Ctrl",textShift:"Shift",textAlt:"Alt",format:function(t){var e=_.toArray(arguments).slice(1);return e.length&&"object"==typeof e[0]&&(e=e[0]),t.replace(/\{(\d+)\}/g,function(t,i){return e[i]})},htmlEncode:function(t){return"undefined"!=typeof _?_.escape(t):t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},htmlDecode:function(t){return _.unescape(t)},ellipsis:function(t,e,i){if(t&&t.length>e){if(i){var n=t.substr(0,e-2),o=Math.max(n.lastIndexOf(" "),n.lastIndexOf("."),n.lastIndexOf("!"),n.lastIndexOf("?"));if(-1!==o&&o>=e-15)return n.substr(0,o)+"..."}return t.substr(0,e-3)+"..."}return t},platformKey:function(t,e,i){return _.isEmpty(e)&&(e=" ({0})"),Common.Utils.isMac?(_.isFunction(i)&&(t=i.call(this,t)),Common.Utils.String.format(e,t.replace(/\+(?=\S)/g,"").replace(/Ctrl|ctrl/g,"⌘").replace(/Alt|alt/g,"⌥").replace(/Shift|shift/g,"⇧"))):Common.Utils.String.format(e,t.replace(/Ctrl|ctrl/g,this.textCtrl).replace(/Alt|alt/g,this.textAlt).replace(/Shift|shift/g,this.textShift))},parseFloat:function(t){return"string"==typeof t&&(t=t.replace(",",".")),parseFloat(t)},encodeSurrogateChar:function(t){if(t<65536)return String.fromCharCode(t);t-=65536;var e=55296|t>>10,i=56320|1023&t;return String.fromCharCode(e)+String.fromCharCode(i)},fixedDigits:function(t,e,i){void 0===i&&(i="0");for(var n="",o=t.toString(),s=o.length;s<e;s++)n+=i;return n+o}}};if(Common.Utils.String=_extend_object(utilsString,Common.Utils.String),Common.Utils.isBrowserSupported=function(){return!(0!=Common.Utils.ieVersion&&Common.Utils.ieVersion<10||0!=Common.Utils.safariVersion&&Common.Utils.safariVersion<5||0!=Common.Utils.firefoxVersion&&Common.Utils.firefoxVersion<4||0!=Common.Utils.chromeVersion&&Common.Utils.chromeVersion<7||0!=Common.Utils.operaVersion&&Common.Utils.operaVersion<10.5)},Common.Utils.showBrowserRestriction=function(){if(!(document.getElementsByClassName&&document.getElementsByClassName("app-error-panel").length>0)){var t=window.DE?"Document":window.SSE?"Spreadsheet":window.PE?"Presentation":"that",e=document.createElement("div");e.innerHTML='<div class="app-error-panel"><div class="message-block"><div class="message-inner"><div class="title">Your browser is not supported.</div><div class="text">Sorry, '+t+' Editor is currently only supported in the latest versions of the Chrome, Firefox, Safari or Internet Explorer web browsers.</div></div></div><div class="message-auxiliary"></div></div>',document.body.appendChild(e),$("#loading-mask").hide().remove(),$("#viewport").hide().remove()}},Common.Utils.applyCustomization=function(t,e){for(var i in t){var n;if(e[i]&&(n=$(e[i]),n.length)){var o=t[i];!1===o||!1===o.visible?n.hide():(o.text&&n.text(o.text),!1===o.visible&&n.hide())}}},Common.Utils.applyCustomizationPlugins=function(plugins){if(plugins&&!(plugins.length<1)){var _createXMLHTTPObject=function(){var t;if("undefined"!=typeof XMLHttpRequest)t=new XMLHttpRequest;else try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}}return t},_getPluginCode=function(url){if(!url)return"";try{var xhrObj=_createXMLHTTPObject();xhrObj&&url&&(xhrObj.open("GET",url,!1),xhrObj.send(""),200==xhrObj.status&&eval(xhrObj.responseText))}catch(t){}return null};plugins.forEach(function(t){t&&_getPluginCode(t)})}},Common.Utils.fillUserInfo=function(t,e,i,n){var o=t||{};return o.anonymous=!o.id,!o.id&&(o.id=n),o.fullname=o.name?o.name:i,o.group&&(o.fullname=o.group.toString()+AscCommon.UserInfoParser.getSeparator()+o.fullname),o.guest=!o.name,o},Common.Utils.createXhr=function(){var t;if("undefined"!=typeof XMLHttpRequest)t=new XMLHttpRequest;else try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}}return t},Common.Utils.getConfigJson=function(t){if(t)try{var e=Common.Utils.createXhr();if(e)return e.open("GET",t,!1),e.send(""),JSON.parse(e.responseText)}catch(t){}return null},Common.Utils.loadConfig=function(t,e){fetch(t,{method:"get",headers:{Accept:"application/json"}}).then(function(t){return t.ok?t.json():"error"}).then(function(t){e(t)}).catch(function(t){e("error")})},Common.Utils.asyncCall=function(t,e,i){new Promise(function(t,e){t()}).then(function(){t.call(e,i)})},String.prototype.strongMatch=function(t){if(t&&t instanceof RegExp){var e=this.toString().match(t);return!!(e&&e.length>0&&e[0].length==this.length)}return!1},Common.Utils.InternalSettings=new function(){var t={};return{get:function(e){return t[e]},set:function(e,i){t[e]=i}}},Common.Utils.lockControls=function(t,e,i,n){function o(t,i){if(t&&t.options&&_.contains(t.options.lock,i)){var n=t.keepState.indexOf(i);e?n<0&&t.keepState.push(i):n<0||t.keepState.splice(n,1)}}!i&&(i={});var s=i.array||n;i.merge&&(s=_.union(n,s)),_.each(s,function(e){e&&_.isFunction(e.setDisabled)&&(!e.keepState&&(e.keepState=[]),i.clear&&i.clear.length>0&&e.keepState.length>0&&(e.keepState=_.difference(e.keepState,i.clear)),_.isArray(t)?_.each(t,function(t){o(e,t)}):o(e,t),e.keepState.length>0?!e.isDisabled()&&e.setDisabled(!0):e.isDisabled()&&e.setDisabled(!1))})},Common.Utils.injectButtons=function(t,e,i,n,o,s,r,a,l,c,h,d){var u=createButtonSet();return u.setDisabled(!0),e=e||"id-toolbar-"+i,t.each(function(p,m){var f="btn-toolbar";/x-huge/.test(m.className)&&(f+=" x-huge icon-top");var g=new Common.UI.Button({parentEl:t.eq(p),id:e+p,cls:f,iconCls:i,caption:n,split:s||!1,menu:r||!1,enableToggle:a||!1,lock:o,disabled:!0,dataHint:l,dataHintDirection:c,dataHintOffset:h,dataHintTitle:d});u.add(g)}),u},Common.Utils.injectComponent=function(t,e){e&&t.length&&(e.rendered?t.append(e.$el):e.render(t))},Common.Utils.warningDocumentIsLocked=function(t){t.disablefunc&&t.disablefunc(!0);var e=window.DE||window.PE||window.SSE;Common.UI.warning({msg:Common.Locale.get("warnFileLocked",{name:"Common.Translation",default:"You can't edit this file. Document is in use by another application."}),buttons:[{value:"view",caption:Common.Locale.get("warnFileLockedBtnView",{name:"Common.Translation",default:"Open for viewing"})},{value:"edit",caption:Common.Locale.get("warnFileLockedBtnEdit",{name:"Common.Translation",default:"Create a copy"})}],primary:"view",callback:function(i){"edit"==i&&(t.disablefunc&&t.disablefunc(!1),e.getController("Main").api.asc_setLocalRestrictions(Asc.c_oAscLocalRestrictionType.None))}})},jQuery.fn.extend({elementById:function(t,e){var i=document.getElementById(t.substring(1));if(!i)if((e=e||this)&&e.length>0)e.each(function(e,n){if(n.querySelectorAll)if(i=n.querySelectorAll(t),0==i.length){if("#"+n.id==t)return i=n,!1}else if(i.length)return i=i[0],!1});else if(e&&e.querySelectorAll&&(i=e.querySelectorAll(t))&&i.length)return i[0];return i},findById:function(t,e){var i=$.fn.elementById.apply(this,arguments);return i?$(i):$()}}),Common.Utils.InternalSettings.set("toolbar-height-tabs",32),Common.Utils.InternalSettings.set("toolbar-height-tabs-top-title",28),Common.Utils.InternalSettings.set("toolbar-height-controls",67),Common.Utils.InternalSettings.set("document-title-height",28),Common.Utils.InternalSettings.set("window-inactive-area-top",0),Common.Utils.InternalSettings.set("toolbar-height-compact",Common.Utils.InternalSettings.get("toolbar-height-tabs")),Common.Utils.InternalSettings.set("toolbar-height-normal",Common.Utils.InternalSettings.get("toolbar-height-tabs")+Common.Utils.InternalSettings.get("toolbar-height-controls")),Common.Utils.ModalWindow=new function(){var t=0;return{show:function(){t++},close:function(){t--},isVisible:function(){return t>0}}},Common.Utils.UserInfoParser=new function(){var t=!1,e=String.fromCharCode(160);return{setParser:function(e){t=!!e},getSeparator:function(){return e},getParsedName:function(i){return t&&i?i.substring(i.indexOf(e)+1):i},getParsedGroups:function(i){if(t&&i){for(var n=i.indexOf(e),o=n>-1?i.substring(0,n).split(","):[],s=0;s<o.length;s++)o[s]=o[s].trim();return o}}}},Common.Utils.getKeyByValue=function(t,e){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e)return i},define("common/main/lib/util/utils",function(){}),void 0===Common)var Common={};if(define("common/main/lib/component/Calendar",["common/main/lib/component/BaseView","common/main/lib/util/utils"],function(){"use strict";Common.UI.Calendar=Common.UI.BaseView.extend(_.extend({template:_.template(['<div id="calendar" class="calendar-box">','<div class="calendar-header">','<div class="top-row">','<div id="prev-arrow"><button type="button"><i class="arrow-prev img-commonctrl"></i></button></div>','<div class="title"></div>','<div id="next-arrow"><button type="button"><i class="arrow-next img-commonctrl" /></button></div>',"</div>",'<div class="bottom-row"></div>',"</div>",'<div class="calendar-content"></div>',"</div>"].join("")),options:{date:void 0,firstday:0},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.monthNames=[this.textJanuary,this.textFebruary,this.textMarch,this.textApril,this.textMay,this.textJune,this.textJuly,this.textAugust,this.textSeptember,this.textOctober,this.textNovember,this.textDecember],this.dayNamesShort=[this.textShortSunday,this.textShortMonday,this.textShortTuesday,this.textShortWednesday,this.textShortThursday,this.textShortFriday,this.textShortSaturday],this.monthShortNames=[this.textShortJanuary,this.textShortFebruary,this.textShortMarch,this.textShortApril,this.textShortMay,this.textShortJune,this.textShortJuly,this.textShortAugust,this.textShortSeptember,this.textShortOctober,this.textShortNovember,this.textShortDecember],e.options.date=t.date,_.isUndefined(t.firstday)||0!==t.firstday&&1!==t.firstday||(e.options.firstday=t.firstday),e.enableKeyEvents=e.options.enableKeyEvents,e._state=void 0,e.render()},render:function(){var t=this;return t.cmpEl=t.$el||$(this.el),t.cmpEl.html(this.template()),t.currentDate=t.options.date||new Date,t.btnPrev=new Common.UI.Button({parentEl:t.cmpEl.find("#prev-arrow"),cls:"",iconCls:"arrow-prev img-commonctrl"}),t.btnPrev.on("click",_.bind(t.onClickPrev,t)),t.btnNext=new Common.UI.Button({parentEl:t.cmpEl.find("#next-arrow"),cls:"",iconCls:"arrow-next img-commonctrl"}),t.btnNext.on("click",_.bind(t.onClickNext,t)),t.cmpEl.on("keydown",function(e){t.trigger("calendar:keydown",t,e)}),t.renderMonth(t.currentDate),this.trigger("render:after",this),this},onClickPrev:function(){var t=this;if(0===t._state){var e=new Date(t.currentDate);e.setMonth(e.getMonth()-1),e.getFullYear()>0&&t.renderMonth(e)}else if(1===t._state){var e=new Date(t.currentDate);e.setFullYear(e.getFullYear()-1),e.getFullYear()>0&&t.renderMonths(e)}else if(2===t._state){var i,n=t.currentDate.getFullYear();n%10!=0?(i=String(n),i=Number(i.slice(0,-1)+"0")-1):i=n-1,i>0&&(t.currentDate.setFullYear(i),t.renderYears(i))}},onClickNext:function(){var t=this;if(0===t._state){var e=new Date(t.currentDate);e.setMonth(e.getMonth()+1),e.getFullYear()>0&&t.renderMonth(e)}else if(1===t._state){var e=new Date(t.currentDate);e.setFullYear(e.getFullYear()+1),e.getFullYear()>0&&t.renderMonths(e)}else if(2===t._state){var i,n=t.currentDate.getFullYear();n%10!=9?(i=String(n),i=Number(i.slice(0,-1)+"9")+1):i=n+1,i>0&&(t.currentDate.setFullYear(i),t.renderYears(i))}},renderYears:function(t){var e=this,t=_.isNumber(t)?t:e.currentDate?e.currentDate.getFullYear():(new Date).getFullYear();e._state=2,e.$el.removeClass("view-days view-months").addClass("view-years");var i=t,n=t;if(i%10!=0){var o=String(t);i=Number(o.slice(0,-1)+"0")}if(n%10!=9){var o=String(t);n=Number(o.slice(0,-1)+"9")}e.topTitle=_.template(["<label>"+i+"-"+n+"</label>"].join("")),e.cmpEl.find(".calendar-header .title").html(e.topTitle),e.bottomTitle=_.template(["<label>"+e.textYears+"</label>"].join("")),e.cmpEl.find(".calendar-header .bottom-row").html(e.bottomTitle);for(var s=[],r=i-3,a=0;a<16;a++)s.push({year:r>0?r:"",isCurrentDecade:r>=i&&r<=n,disabled:!(r>0),selected:_.isDate(e.selectedDate)?r===e.selectedDate.getFullYear():r===(new Date).getFullYear()}),r++;e.yearPicker?e.yearPicker.store.reset(s):(e.yearPicker=new Common.UI.DataView({el:e.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(s),itemTemplate:_.template('<div class="name-year <% if (!isCurrentDecade) { %> no-current-decade <% } %>" data-year="<%= year %>"><%= year %></div>')}),e.yearPicker.on("item:click",function(t,i,n,o){var s=n.get("year"),r=new Date;r.setFullYear(s),e.renderMonths(r)}),e.enableKeyEvents&&this.yearPicker.on("item:keydown",function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")})),e.enableKeyEvents&&_.delay(function(){e.monthPicker.focus()},10)},renderMonths:function(t){var e=this,i=_.isDate(t)?t:e.currentDate?e.currentDate:new Date,n=i.getFullYear();e._state=1,e.currentDate=i,e.$el.removeClass("view-years view-days").addClass("view-months"),e.topTitle=_.template(['<div class="button"><label>'+n+"</label></div>"].join("")),e.cmpEl.find(".calendar-header .title").html(e.topTitle),e.cmpEl.find(".calendar-header .title").off(),e.cmpEl.find(".calendar-header .title").on("click",_.bind(e.renderYears,e)),e.bottomTitle=_.template(["<label>"+e.textMonths+"</label>"].join("")),e.cmpEl.find(".calendar-header .bottom-row").html(e.bottomTitle);for(var o=[],s=new Date,r=0;r<12;r++)o.push({indexMonth:r,nameMonth:e.monthShortNames[r],year:n,curYear:!0,isCurrentMonth:r===i.getMonth(),selected:_.isDate(e.selectedDate)?r===e.selectedDate.getMonth()&&n===e.selectedDate.getFullYear():r===s.getMonth()&&n===s.getFullYear()});n+=1;for(var r=0;r<4;r++)o.push({indexMonth:r,nameMonth:e.monthShortNames[r],year:n,curYear:!1,selected:_.isDate(e.selectedDate)?r===e.selectedDate.getMonth()&&n===e.selectedDate.getFullYear():r===s.getMonth()&&n===s.getFullYear()});e.monthsPicker?e.monthsPicker.store.reset(o):(e.monthsPicker=new Common.UI.DataView({el:e.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(o),itemTemplate:_.template('<div class="name-month <% if (!curYear) { %> no-cur-year <% } %>" data-month="<%= indexMonth %>" data-year="<%= year %>"><%= nameMonth %></div>')}),e.monthsPicker.on("item:click",function(t,i,n,o){var s=n.get("indexMonth"),r=n.get("year"),a=new Date;a.setFullYear(r,s),e.renderMonth(a)}),e.enableKeyEvents&&this.monthsPicker.on("item:keydown",function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")})),e.enableKeyEvents&&_.delay(function(){e.monthPicker.focus()},10)},renderMonth:function(t){var e=this;e._state=0;var i=e.options.firstday,n=t||new Date,o=n.getMonth(),s=(n.getDay(),n.getDate(),n.getFullYear());e.currentDate=n,e.$el.removeClass("view-years view-months").addClass("view-days"),e.topTitle=_.template(['<div class="button">',"<label>"+e.monthNames[o]+" "+s+"</label>","</div>"].join("")),e.cmpEl.find(".calendar-header .title").html(e.topTitle),e.cmpEl.find(".calendar-header .title").off(),e.cmpEl.find(".calendar-header .title").on("click",_.bind(e.renderMonths,e));for(var r="",a=i;a<7;a++)r+="<label>"+e.dayNamesShort[a]+"</label>";i>0&&(r+="<label>"+e.dayNamesShort[0]+"</label>"),e.cmpEl.find(".calendar-header .bottom-row").html(_.template(r));var l=[],c=new Date(n);c.setDate(1);var h,d,u,p=c.getDay(),m=e.daysInMonth(c.getTime()-864e6);h=0===i?p>0?m-(p-1):1:0===p?m-5:m-(p-2),p>0&&0===i||1===i?o-1>=0?(d=o-1,u=s):(d=11,u=s-1):(d=o,u=s);var f=new Date;f.setFullYear(u,d,h);for(var g=new Date,v=0;v<6;v++)for(var b=0;b<7;b++){var y=f.getDay(),w=f.getDate(),C=f.getMonth(),x=f.getFullYear();l.push({indexInWeek:y,dayNumber:w,month:C,year:x,isCurrentMonth:C===o,selected:_.isDate(e.selectedDate)?w===e.selectedDate.getDate()&&C===e.selectedDate.getMonth()&&x===e.selectedDate.getFullYear():w===g.getDate()&&C===g.getMonth()&&x===g.getFullYear()}),f.setDate(w+1)}e.monthPicker?e.monthPicker.store.reset(l):(e.monthPicker=new Common.UI.DataView({el:e.cmpEl.find(".calendar-content"),store:new Common.UI.DataViewStore(l),itemTemplate:_.template('<div class="number-day<% if (indexInWeek === 6 || indexInWeek === 0) { %> weekend<% } %><% if (!isCurrentMonth) { %> no-current-month<% } %>" data-number="<%= dayNumber %>" data-month="<%= month %>" data-year="<%= year %>"><%= dayNumber %></div>')}),e.monthPicker.on("item:click",function(t,i,n,o){var s=n.get("dayNumber"),r=n.get("month"),a=n.get("year");_.isUndefined(e.selectedDate)&&(e.selectedDate=new Date),e.selectedDate.setFullYear(a,r,s),e.trigger("date:click",e,e.selectedDate)}),e.enableKeyEvents&&this.monthPicker.on("item:keydown",function(t,e,i){i.keyCode==Common.UI.Keys.ESC&&Common.NotificationCenter.trigger("dataview:blur")})),e.enableKeyEvents&&_.delay(function(){e.monthPicker.focus()},10)},daysInMonth:function(t){var e;e=t?new Date(t):new Date;var i=new Date;return i.setFullYear(e.getFullYear(),e.getMonth()+1,0),i.getDate()},setDate:function(t){_.isDate(t)&&(this.selectedDate=new Date(t),this.renderMonth(this.selectedDate))},focus:function(){var t=this;t.enableKeyEvents&&t.monthPicker&&_.delay(function(){t.monthPicker.focus()},10)},textJanuary:"January",textFebruary:"February",textMarch:"March",textApril:"April",textMay:"May",textJune:"June",textJuly:"July",textAugust:"August",textSeptember:"September",textOctober:"October",textNovember:"November",textDecember:"December",textShortJanuary:"Jan",textShortFebruary:"Feb",textShortMarch:"Mar",textShortApril:"Apr",textShortMay:"May",textShortJune:"Jun",textShortJuly:"Jul",textShortAugust:"Aug",textShortSeptember:"Sep",textShortOctober:"Oct",textShortNovember:"Nov",textShortDecember:"Dec",textShortSunday:"Su",textShortMonday:"Mo",textShortTuesday:"Tu",textShortWednesday:"We",textShortThursday:"Th",textShortFriday:"Fr",textShortSaturday:"Sa",textMonths:"Months",textYears:"Years"},Common.UI.Calendar||{}))}),define("common/main/lib/util/LocalStorage",["gateway"],function(){Common.localStorage=new function(){var t,e,i={},n=function(t){"localstorage"==t.type&&(i=t.keys)};Common.Gateway.on("internalcommand",n);var o=function(){},s=function(){},r=function(t,e,n){if(u)try{localStorage.setItem(t,e)}catch(t){}else i[t]=e},a=function(t,e,i){r(t,e?1:0)},l=function(t){return u?localStorage.getItem(t):void 0===i[t]?null:i[t]},c=function(t,e){var i=l(t);return e=e||!1,null!==i?0!=parseInt(i):e},h=function(t){return null!==l(t)},d=function(t){u?localStorage.removeItem(t):delete i[t]};try{var u=!!window.localStorage}catch(t){u=!1}return{getId:function(){return t},setId:function(e){t=e},getItem:l,getBool:c,setBool:a,setItem:r,removeItem:d,setKeysFilter:function(t){e=t},getKeysFilter:function(){return e},itemExists:h,sync:o,save:s}}}),function(t){function e(t,e){for(var i=t.length;i--;)if(t[i]===e)return i;return-1}function i(t,e){if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function n(t){for(x in T)T[x]=t[M[x]]}function o(t){var i,o,s,r,l,c;if(i=t.keyCode,Common.UI.HintManager&&Common.UI.HintManager.isHintVisible())if(112===i)Common.UI.HintManager.clearHints();else if(27!==i)return;if(-1==e(U,i)&&U.push(i),93!=i&&224!=i||(i=91),i in T){T[i]=!0;for(s in E)E[s]==i&&(a[s]=!0)}else if(n(t),a.filter.call(this,t)&&i in S)for(c=p(),r=0;r<S[i].length;r++)if(o=S[i][r],o.scope==c||"all"==o.scope){l=o.mods.length>0;for(s in T)(!T[s]&&e(o.mods,+s)>-1||T[s]&&-1==e(o.mods,+s))&&(l=!1);if((0==o.mods.length&&!T[16]&&!T[18]&&!T[17]&&!T[91]||l)&&(!0===_||o.locked||!1===o.method(t,o))){if(!0===_&&k||o.locked&&o.propagate)continue;t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)}}}function s(t){var i,n=t.keyCode,o=e(U,n);if(o>=0&&U.splice(o,1),93!=n&&224!=n||(n=91),n in T){T[n]=!1;for(i in E)E[i]==n&&(a[i]=!1)}}function r(){for(x in T)T[x]=!1;for(x in E)a[x]=!1}function a(t,e,i){var n,o;n=f(t),void 0===i&&(i=e,e="all");for(var s=0;s<n.length;s++)o=[],t=n[s].split("+"),t.length>1&&(o=g(t),t=[t[t.length-1]]),t=t[0],t=A(t),t in S||(S[t]=[]),S[t].push({shortcut:n[s],scope:e,method:i,key:n[s],mods:o})}function l(t,e){var n,o,s,r,a,l=[];for(n=f(t),r=0;r<n.length;r++){if(o=n[r].split("+"),o.length>1&&(l=g(o)),o.length>0&&(t=o[o.length-1]),t=A(t),void 0===e&&(e=p()),!S[t])return;for(s in S[t])a=S[t][s],a.scope===e&&i(a.mods,l)&&(S[t][s]={})}}function c(t){return"string"==typeof t&&(t=A(t)),-1!=e(U,t)}function h(){return U.slice(0)}function d(t){var e=(t.target||t.srcElement).tagName;return!("INPUT"==e||"SELECT"==e||"TEXTAREA"==e)}function u(t){I=t||"all"}function p(){return I||"all"}function m(t){var e,i,n;for(e in S)for(i=S[e],n=0;n<i.length;)i[n].scope===t?i.splice(n,1):n++}function f(t){var e;return t=t.replace(/\s/g,""),e=t.split(","),""==e[e.length-1]&&(e[e.length-2]+=","),e}function g(t){for(var e=t.slice(0,t.length-1),i=0;i<e.length;i++)e[i]=E[e[i]];return e}function v(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,function(){i(window.event)})}function b(){var e=t.key;return t.key=$,e}function y(t,e,n,o){for(var s,r,a,l=[],c=f(t),h=c.length;h--;)if(s=c[h].split("+"),s.length>1&&(l=g(s)),s.length>0&&(t=s[s.length-1]),t=A(t),void 0===e&&(e=p()),S[t])for(r in S[t])a=S[t][r],a.scope===e&&i(a.mods,l)&&(S[t][r][n]=o)}function w(t,e,i){t?(y(t,e,"locked",!0),i&&y(t,e,"propagate",!0)):(_=!0,i&&(k=!0))}function C(t,e){t?(y(t,e,"locked",!1),y(t,e,"propagate",!1)):_=k=!1}var x,_,k,S={},T={16:!1,18:!1,17:!1,91:!1},I="all",E={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},D={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,"ff-":173,"ff=":61,numplus:107,numminus:109},A=function(t){return D[t]||t.toUpperCase().charCodeAt(0)},U=[];for(x=1;x<20;x++)D["f"+x]=111+x;var M={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(x in E)a[x]=!1;v(document,"keydown",function(t){o(t)}),v(document,"keyup",s),v(window,"focus",r);var $=t.key;t.key=a,t.key.setScope=u,t.key.getScope=p,t.key.deleteScope=m,t.key.filter=d,t.key.isPressed=c,t.key.getPressedKeyCodes=h,t.key.noConflict=b,t.key.unbind=l,t.key.suspend=w,t.key.resume=C,"undefined"!=typeof module&&(module.exports=key)}(this),define("keymaster",function(){}),void 0===Common)var Common={};if(Common.util=Common.util||{},define("common/main/lib/util/Shortcuts",["backbone","keymaster"],function(t){"use strict";var e=function(t){return this.cid=_.uniqueId("shortcuts"),this.initialize.apply(this,arguments),this};_.extend(e.prototype,t.Events,{initialize:function(){window.key.filter=function(t){return!0},Common.NotificationCenter.on({"modal:show":function(t){window.key.suspend()},"modal:close":function(t,e){e&&window.key.resume()},"modal:hide":function(t,e){e&&window.key.resume()}})},delegateShortcuts:function(t){if(t&&t.shortcuts){this.removeShortcuts(t);var e,i,n,o,s,r,a=[];for(s in t.shortcuts){if(e=t.shortcuts[s],_.isFunction(e))n=e;else if(!(n=t[e]))throw new Error("Method "+e+" does not exist");i=s.match(/^(\S+)\s*(.*)$/),r=i[1],o=i[2].length?i[2]:"all",n=_.bind(n,this),a.push(window.key(r,o,n))}}},removeShortcuts:function(t){if(t&&t.shortcuts){var e,i,n,o;for(n in t.shortcuts)e=n.match(/^(\S+)\s*(.*)$/),o=e[1],i=e[2].length?e[2]:"all",window.key.unbind(o,i)}},suspendEvents:function(t,e,i){window.key.suspend(t,e,i)},resumeEvents:function(t,e){window.key.resume(t,e)}}),e.extend=t.View.extend,Common.util.Shortcuts=new e}),void 0===Common)var Common={};if(define("common/main/lib/view/CopyWarningDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,height:325,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{}),this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+C","{0}")+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+X","{0}")+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+V","{0}")+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" style="margin-top: 20px; text-align: left;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.autoSize()},autoSize:function(){var t=this.getChild(".box"),e=this.getChild(".footer"),i=this.getChild(".header"),n=this.getChild(".body");n.height(parseInt(t.height())+parseInt(e.css("height"))),this.setHeight(parseInt(n.css("height"))+parseInt(i.css("height")))},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()},textTitle:"Copy, Cut and Paste Actions",textMsg:"Copy, cut and paste actions using the editor toolbar buttons and context menu actions will be performed within this editor tab only.<br><br>To copy or paste to or from applications outside the editor tab use the following keyboard combinations:",textToCopy:"for Copy",textToPaste:"for Paste",textToCut:"for Cut",textDontShow:"Don't show this message again"},Common.Views.CopyWarningDialog||{}))}),define("common/main/lib/view/ImageFromUrlDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.ImageFromUrlDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+(this.options.title||this.textUrl)+"</label>","</div>",'<div id="id-dlg-url" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputUrl=new Common.UI.InputField({el:$("#id-dlg-url"),allowBlank:!1,blankError:t.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validation:function(e){return!!/((^https?)|(^ftp)):\/\/.+/i.test(e)||t.txtNotUrl}}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay(function(){t.getChild("input").focus()},100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputUrl.checkValidate())return void this.inputUrl.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputUrl.getValue())}this.close()},textUrl:"Paste an image URL:",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"'},Common.Views.ImageFromUrlDialog||{}))}),define("common/main/lib/view/SelectFileDlg",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],function(){"use strict";Common.Views.SelectFileDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:1024,height:621,header:!0},t),this.template=['<div id="id-select-file-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.fileChoiceUrl=t.fileChoiceUrl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=585,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),
$("#id-select-file-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-select-file-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.fileChoiceUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",function(t){e._unbindWindowEvents()})},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){if(t&&"onlyoffice"==t.Referer&&void 0!==t.file){Common.NotificationCenter.trigger("window:close",this);var e=this;setTimeout(function(){_.isEmpty(t.file)||e.trigger("selectfile",e,t.file)},50)}},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Select Data Source",textLoading:"Loading"},Common.Views.SelectFileDlg||{}))}),define("common/main/lib/view/SaveAsDlg",["common/main/lib/component/Window","common/main/lib/component/LoadMask"],function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:420,height:681,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",function(t){e._unbindWindowEvents()})},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Folder for save",textLoading:"Loading"},Common.Views.SaveAsDlg||{}))}),define("common/main/lib/view/OpenDialog",["common/main/lib/component/Window"],function(){"use strict";Common.Views.OpenDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e,i,n=this,o={};if(t.preview)e=414,i=t.type==Common.Utils.importTextType.Data?385:277;else switch(e=t.type!==Common.Utils.importTextType.DRM?340:t.warning?420:280,t.type){case Common.Utils.importTextType.CSV:case Common.Utils.importTextType.Paste:case Common.Utils.importTextType.Columns:i=190;break;case Common.Utils.importTextType.Data:i=245;break;default:i=t.warning?187:147}_.extend(o,{closable:!1,preview:t.preview,warning:t.warning,codepages:t.codepages,warningMsg:t.warningMsg,width:e,height:i,header:!0,cls:"open-dlg",contentTemplate:"",toolcallback:_.bind(n.onToolClose,n),closeFile:!1},t),this.txtOpenFile=t.txtOpenFile||this.txtOpenFile,this.template=t.template||['<div class="box" style="height:'+(o.height-85)+'px;">','<div class="content-panel" >',"<% if (type == Common.Utils.importTextType.DRM) { %>","<% if (warning) { %>","<div>",'<div class="icon warn"></div>','<div style="padding-left: 50px;"><div style="font-size: 12px;">'+("string"==typeof o.warningMsg?o.warningMsg:n.txtProtected)+"</div>",'<label class="header" style="margin-top: 15px;">'+n.txtPassword+"</label>",'<div id="id-password-txt" style="width: 290px;"></div></div>',"</div>","<% } else { %>","<div>",'<label class="">'+n.txtOpenFile+"</label>",'<div id="id-password-txt"></div>',"</div>","<% } %>","<% } else { %>","<% if (codepages && codepages.length>0) { %>",'<div style="<% if (!!preview && (type == Common.Utils.importTextType.CSV || type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns)) { %>width: 230px;margin-right: 10px;display: inline-block;<% } else { %>width: 100%;<% } %>margin-bottom:15px;">','<label class="header">'+n.txtEncoding+"</label>","<div>",'<div id="id-codepages-combo" class="input-group-nr" style="width: 100%; display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.CSV) { %>",'<div style="display: inline-block; margin-bottom:15px;">','<label class="header">'+n.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row" style="display: inline-block; vertical-align: middle;margin-left: 10px;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns || type == Common.Utils.importTextType.Data) { %>",'<div style="display: inline-block; margin-bottom:15px;width: 100%;">','<label class="header">'+n.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row" style="display: inline-block; vertical-align: middle;margin-left: 10px;"></div>','<button type="button" class="btn auto btn-text-default" id="id-delimiters-advanced" style="min-width:100px; display: inline-block;float:right;">'+n.txtAdvanced+"</button>","</div>","</div>","<% } %>","<% if (!!preview) { %>",'<div style="">','<label class="header">'+n.txtPreview+"</label>",'<div style="position: relative;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data"></div></div>',"</div>","</div>","</div>","</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Data) { %>",'<label class="header" style="margin-top:15px;">'+n.txtDestData+"</label>",'<div id="id-open-data-range" class="input-row" style="width: 100%;"></div>',"<% } %>","<% } %>","</div>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok">'+n.okButtonText+"</button>","<% if (closeFile) { %>",'<button class="btn normal dlg-btn custom" result="cancel" style="margin-left:10px;">'+n.closeButtonText+"</button>","<% } %>","<% if (closable) { %>",'<button class="btn normal dlg-btn custom" result="cancel" style="margin-left:10px;">'+n.cancelButtonText+"</button>","<% } %>","</div>"].join(""),this.handler=o.handler,this.type=o.type,this.preview=o.preview,this.previewData=o.previewData,this.warning=o.warning||!1,this.closable=o.closable,this.codepages=o.codepages,this.settings=o.settings,this.api=o.api,this.validatePwd=o.validatePwd||!1,o.tpl=_.template(this.template)(o),this._previewTdWidth=[],this._previewTdMaxLength=0,Common.UI.Window.prototype.initialize.call(this,o)},render:function(){if(Common.UI.Window.prototype.render.call(this),this.$window){var t=this;this.closable||this.$window.find(".tool").hide(),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.previewPanel=this.$window.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=this.$window.find("#id-preview"),this.previewInner=this.previewScrolled.find("div:first-child"),this.type==Common.Utils.importTextType.DRM?this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",showCls:("svg"===this.options.iconType?"svg-icon":"toolbar__icon")+" btn-sheet-view",hideCls:("svg"===this.options.iconType?"svg-icon":"toolbar__icon")+" hide-password",maxLength:this.options.maxPasswordLength,validateOnBlur:!1,showPwdOnClick:!0,validation:function(e){return t.txtIncorrectPwd}}):(this.initCodePages(),this.preview&&(this.previewData?this.previewCallback(this.previewData):this.updatePreview())),this.type==Common.Utils.importTextType.Data&&(this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#id-open-data-range"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this)),this.dataDestValid=this.api.asc_getActiveRangeStr(Asc.referenceType.A,!0),this.txtDestRange.setValue(this.dataDestValid)),this.onPrimary=function(){return t._handleInput("ok"),!1}}},getFocusedComponents:function(){var t=[];return this.inputPwd&&t.push(this.inputPwd),this.cmbEncoding&&t.push(this.cmbEncoding),this.cmbDelimiter&&t.push(this.cmbDelimiter),this.inputDelimiter&&t.push(this.inputDelimiter),this.btnAdvanced&&t.push(this.btnAdvanced),this.txtDestRange&&t.push(this.txtDestRange),t},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;if(this.type==Common.Utils.importTextType.DRM)setTimeout(function(){t.inputPwd.focus(),t.validatePwd&&t.inputPwd.checkValidate()},500);else{var e=t.txtDestRange?t.txtDestRange:t.cmbEncoding?t.cmbEncoding:t.cmbDelimiter;e&&setTimeout(function(){e.focus()},500)}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onToolClose:function(){this._handleInput("cancel")},_handleInput:function(t){if(this.handler)if(this.type==Common.Utils.importTextType.DRM)this.handler.call(this,t,{drmOptions:new Asc.asc_CDRMAdvancedOptions(this.inputPwd.getValue())});else{if(this.type==Common.Utils.importTextType.Data&&"ok"==t&&!this.isRangeValid())return;var e=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0,i=this.cmbDelimiter?this.cmbDelimiter.getValue():null,n=-1==i?this.inputDelimiter.getValue():null;-1==i&&(i=null),this.closable||this.type!=Common.Utils.importTextType.TXT||Common.localStorage.setItem("de-settings-open-encoding",e);var o=this.separatorOptions?this.separatorOptions.decimal:void 0,s=this.separatorOptions?this.separatorOptions.thousands:void 0,r=this.separatorOptions?this.separatorOptions.qualifier:'"',a=new Asc.asc_CTextOptions(e,i,n);o&&a.asc_setNumberDecimalSeparator(o),s&&a.asc_setNumberGroupSeparator(s),r&&a.asc_setTextQualifier(r),this.handler.call(this,t,{textOptions:a,range:this.txtDestRange?this.txtDestRange.getValue():"",data:this.data})}this.close()},initCodePages:function(){var t,e,i,n=[],o=[],s=0,r=0;if(this.codepages){for(n=[],t=0;t<this.codepages.length;++t)i=this.codepages[t],e=[],e[0]=i.asc_getCodePage(),e[1]=i.asc_getCodePageName(),e[2]=i.asc_getLcid(),n.push(e);r=50}if(s=n.length){for(t=0;t<s;++t)o.push({value:n[t][0],displayValue:Common.Utils.String.htmlEncode(n[t][1]),lcid:n[t][2]||""});var a=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<div style="display: inline-block;"><%= item.displayValue %></div>','<label style="text-align: right;width:'+r+'px;"><%= item.lcid %></label>',"</a></li>","<% }); %>"].join(""));this.cmbEncoding=new Common.UI.ComboBox({el:$("#id-codepages-combo",this.$window),style:"width: 100%;",menuStyle:"min-width: 100%; max-height: 200px;",cls:"input-group-nr",menuCls:"scrollable-menu",data:o,editable:!1,disabled:!0,search:!0,itemsTemplate:a,takeFocusOnClose:!0}),this.cmbEncoding.setDisabled(!1);var l=this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():n[0][0];if(!this.closable&&this.type==Common.Utils.importTextType.TXT){var c=Common.localStorage.getItem("de-settings-open-encoding");c&&(l=parseInt(c))}this.cmbEncoding.setValue(l),this.preview&&this.cmbEncoding.on("selected",_.bind(this.onCmbEncodingSelect,this));var h=this.cmbEncoding.cmpEl.find("ul"),d=h.find("li:nth(0) a"),u=h.width()-parseInt(d.css("padding-left"))-parseInt(d.css("padding-right"))-50;h.find("li div").width(u)}this.type!=Common.Utils.importTextType.CSV&&this.type!=Common.Utils.importTextType.Paste&&this.type!=Common.Utils.importTextType.Columns&&this.type!=Common.Utils.importTextType.Data||(this.cmbDelimiter=new Common.UI.ComboBox({el:$("#id-delimiters-combo",this.$window),style:"width: 100px;",menuStyle:"min-width: 100px;",cls:"input-group-nr",data:[{value:4,displayValue:this.txtComma},{value:2,displayValue:this.txtSemicolon},{value:3,displayValue:this.txtColon},{value:1,displayValue:this.txtTab},{value:5,displayValue:this.txtSpace},{value:-1,displayValue:this.txtOther}],editable:!1,takeFocusOnClose:!0}),this.cmbDelimiter.setValue(this.settings&&this.settings.asc_getDelimiter()?this.settings.asc_getDelimiter():4),this.cmbDelimiter.on("selected",_.bind(this.onCmbDelimiterSelect,this)),this.inputDelimiter=new Common.UI.InputField({el:$("#id-delimiter-other"),style:"width: 30px;",maxLength:1,validateOnChange:!0,validateOnBlur:!1,value:this.settings&&this.settings.asc_getDelimiterChar()?this.settings.asc_getDelimiterChar():""}),this.inputDelimiter.setVisible(!1),this.preview&&this.inputDelimiter.on("changing",_.bind(this.updatePreview,this)),this.type!=Common.Utils.importTextType.Paste&&this.type!=Common.Utils.importTextType.Columns&&this.type!=Common.Utils.importTextType.Data||(this.btnAdvanced=new Common.UI.Button({el:$("#id-delimiters-advanced")}),this.btnAdvanced.on("click",_.bind(this.onAdvancedClick,this))))},updatePreview:function(){this._previewTdWidth=[],this._previewTdMaxLength=0;var t=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0,e=this.cmbDelimiter?this.cmbDelimiter.getValue():null,i=-1==e?this.inputDelimiter.getValue():null;-1==e&&(e=null);var n=new Asc.asc_CTextOptions(t,e,i);switch(this.separatorOptions&&(n.asc_setNumberDecimalSeparator(this.separatorOptions.decimal),n.asc_setNumberGroupSeparator(this.separatorOptions.thousands),n.asc_setTextQualifier(this.separatorOptions.qualifier)),this.type){case Common.Utils.importTextType.CSV:case Common.Utils.importTextType.TXT:case Common.Utils.importTextType.Data:this.api.asc_decodeBuffer(this.preview,n,_.bind(this.previewCallback,this));break;case Common.Utils.importTextType.Paste:case Common.Utils.importTextType.Columns:this.api.asc_TextImport(n,_.bind(this.previewCallback,this),this.type==Common.Utils.importTextType.Paste)}},previewCallback:function(t){t&&t.length&&(this.data=t,this.previewInner.height(17*t.length),this.scrollerY||(this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:20,alwaysVisibleY:!0,alwaysVisibleX:!0,onChange:_.bind(function(){if(this.scrollerY){var t=this.scrollerY.getScrollTop(),e=Math.floor(t/17+.5),i=e+Math.min(6,this.data.length);i>this.data.length&&(i=this.data.length,e=this.data.length-6,t=17*e),this.previewParent.height(108),this.previewParent.css({top:t}),this.previewDataBlock(this.data.slice(e,i))}},this)})),this.scrollerY.update(),this.scrollerY.scrollTop(0))},previewDataBlock:function(t){if(_.isUndefined(this.scrollerX)||(this.scrollerX.destroy(),delete this.scrollerX),this.type==Common.Utils.importTextType.CSV||this.type==Common.Utils.importTextType.Paste||this.type==Common.Utils.importTextType.Columns||this.type==Common.Utils.importTextType.Data){for(var e=0,i=0;i<t.length;i++){var n=t[i]||"";n.length>e&&(e=n.length)}this._previewTdMaxLength=Math.max(this._previewTdMaxLength,e);for(var o="<table>",i=0;i<t.length;i++){var n=t[i]||"";o+='<tr style="vertical-align: top;">';for(var s=0;s<n.length;s++){var r="";0==i&&this._previewTdWidth[s]&&(r='style="min-width:'+this._previewTdWidth[s]+'px;"'),o+="<td "+r+">"+Common.Utils.String.htmlEncode(n[s])+"</td>"}for(s=n.length;s<this._previewTdMaxLength;s++){var r="";0==i&&this._previewTdWidth[s]&&(r='style="min-width:'+this._previewTdWidth[s]+'px;"'),o+="<td "+r+"></td>"}o+="</tr>"}o+="</table>"}else{for(var o="<table>",i=0;i<t.length;i++){var n=t[i]||"";o+='<tr style="vertical-align: top;"><td>'+Common.Utils.String.htmlEncode(n)+"</td></tr>"}o+="</table>"}if(this.previewPanel.html(o),t.length>0){var a=this;0===this._previewTdWidth.length&&this.previewScrolled.scrollLeft(0),this.previewPanel.find("tr:first td").each(function(t,e){a._previewTdWidth[t]=Math.max(Math.max(Math.ceil($(e).outerWidth()),30),a._previewTdWidth[t]||0)})}this.scrollerX=new Common.UI.Scroller({el:this.previewPanel,suppressScrollY:!0,alwaysVisibleX:!0,minScrollbarLength:20})},onCmbDelimiterSelect:function(t,e){this.inputDelimiter.setVisible(-1==e.value);var i=this;-1==e.value&&setTimeout(function(){i.inputDelimiter.focus()},10),this.preview&&this.updatePreview()},onCmbEncodingSelect:function(t,e){this.updatePreview()},onAdvancedClick:function(){if(SSE){var t=this,e=this.separatorOptions?this.separatorOptions.decimal:this.api.asc_getDecimalSeparator(),i=this.separatorOptions?this.separatorOptions.thousands:this.api.asc_getGroupSeparator(),n=this.separatorOptions?this.separatorOptions.qualifier:(this.settings||new Asc.asc_CTextOptions).asc_getTextQualifier();new SSE.Views.AdvancedSeparatorDialog({props:{decimal:e,thousands:i,qualifier:n},handler:function(n,o){"ok"==n&&(t.separatorOptions={decimal:o.decimal.length>0?o.decimal:e,thousands:o.thousands.length>0?o.thousands:i,qualifier:o.qualifier},t.preview&&t.updatePreview())}}).show()}},onSelectData:function(t){var e=this,i=e.txtDestRange;if(e.api){var n=function(t,n){if("ok"==n){var o=t.getSettings();e.dataDestValid=o,i.setValue(o),i.checkValidate()}},o=new SSE.Views.CellRangeDialog({handler:n}).on("close",function(){e.show(),_.delay(function(){i.focus()},1)}),s=e.$window.offset();e.hide(),o.show(s.left+160,s.top+125),o.setSettings({api:e.api,range:_.isEmpty(i.getValue())||1!=i.checkValidate()?e.dataDestValid:i.getValue(),type:Asc.c_oAscSelectionDialogType.Chart})}},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,this.txtDestRange.getValue()),!(t=t==Asc.c_oAscError.ID.No)&&(e=this.textInvalidRange)),t||(this.txtDestRange.showError([e]),this.txtDestRange.focus(),t)},txtDelimiter:"Delimiter",txtEncoding:"Encoding ",txtSpace:"Space",txtTab:"Tab",txtTitle:"Choose %1 options",txtPassword:"Password",txtTitleProtected:"Protected File",txtOther:"Other",txtIncorrectPwd:"Password is incorrect.",closeButtonText:"Close File",txtPreview:"Preview",txtComma:"Comma",txtColon:"Colon",txtSemicolon:"Semicolon",txtProtected:"Once you enter the password and open the file, the current password to the file will be reset.",txtAdvanced:"Advanced",txtOpenFile:"Enter a password to open the file",textSelectData:"Select data",txtDestData:"Choose where to put the data",txtEmpty:"This field is required",textInvalidRange:"Invalid cells range"},Common.Views.OpenDialog||{}))}),void 0===Common)var Common={};if(define("common/main/lib/component/MetricSpinner",["common/main/lib/component/BaseView"],function(){"use strict";Common.UI.MetricSpinner=Common.UI.BaseView.extend({options:{minValue:0,maxValue:100,step:1,defaultUnit:"px",allowAuto:!1,autoText:"Auto",hold:!0,speed:"medium",width:90,allowDecimal:!0,dataHint:"",dataHintDirection:"",dataHintOffset:""},disabled:!1,value:"0 px",rendered:!1,template:'<input type="text" class="form-control" spellcheck="false" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>"><div class="spinner-buttons"><button type="button" class="spinner-up"><i class="arrow"></i></button><button type="button" class="spinner-down"><i class="arrow"></i></button></div>',initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this,i=e.$el||$(this.el);i.addClass("spinner"),i.on("mousedown",".spinner-up",_.bind(this.onMouseDown,this,!0)),i.on("mousedown",".spinner-down",_.bind(this.onMouseDown,this,!1)),i.on("mouseup",".spinner-up",_.bind(this.onMouseUp,this,!0)),i.on("mouseup",".spinner-down",_.bind(this.onMouseUp,this,!1)),i.on("mouseover",".spinner-up, .spinner-down",_.bind(this.onMouseOver,this)),i.on("mouseout",".spinner-up, .spinner-down",_.bind(this.onMouseOut,this)),i.on("keydown",".form-control",_.bind(this.onKeyDown,this)),i.on("keyup",".form-control",_.bind(this.onKeyUp,this)),i.on("blur",".form-control",_.bind(this.onBlur,this)),i.on("input",".form-control",_.bind(this.onInput,this)),this.options.allowDecimal||i.on("keypress",".form-control",_.bind(this.onKeyPress,this)),i.on("focus","input.form-control",function(t){setTimeout(function(){e.$input&&(e.$input[0].selectionStart=0,e.$input[0].selectionEnd=e.$input.val().length)},1)}),Common.Utils.isGecko&&i.on("blur","input.form-control",function(){setTimeout(function(){e.$input&&(e.$input[0].selectionStart=e.$input[0].selectionEnd=0)},1)}),this.switches={count:1,enabled:!0,fromKeyDown:!1},"medium"===this.options.speed?this.switches.speed=300:"fast"===this.options.speed?this.switches.speed=100:this.switches.speed=500,this.render(),this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.value&&(this.value=this.options.value),this.setRawValue(this.value),this.options.width&&i.width(this.options.width),void 0===this.options.defaultValue&&(this.options.defaultValue=this.options.minValue),this.oldValue=this.options.minValue,this.lastValue=null},render:function(){var t=this.$el||$(this.el),e=_.template(this.template);return t.html($(e({dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset}))),this.$input=t.find(".form-control"),this.rendered=!0,void 0!=this.options.tabindex&&this.$input.attr("tabindex",this.options.tabindex),this},setDisabled:function(t){t=!!t;var e=this.$el||$(this.el);t!==this.disabled&&(e.find("button").toggleClass("disabled",t),e.toggleClass("disabled",t),t?this.$input.attr({disabled:t}):this.$input.removeAttr("disabled")),this.disabled=t},isDisabled:function(){return this.disabled},setDefaultUnit:function(t){if(this.options.defaultUnit!=t){var e=this.options.defaultUnit;this.options.defaultUnit=t,this.setMinValue(this._recalcUnits(this.options.minValue,e)),this.setMaxValue(this._recalcUnits(this.options.maxValue,e)),this.setValue(this._recalcUnits(this.getNumberValue(),e),!0)}},setMinValue:function(t){this.options.minValue=t},setMaxValue:function(t){this.options.maxValue=t},setStep:function(t){this.options.step=t},getMinValue:function(){return this.options.minValue},getMaxValue:function(){return this.options.maxValue},getNumberValue:function(){return this.checkAutoText(this.value)?-1:parseFloat(this.value)},getUnitValue:function(){return this.options.defaultUnit},getValue:function(){return this.value},setRawValue:function(t){this.$input&&this.$input.val(t)},getRawValue:function(){return this.$input.val()},setValue:function(t,e){var i=!1;if(this._fromKeyDown=!1,this.lastValue=this.value,void 0===t||""===t)this.value="";else if(this.options.allowAuto&&(Math.abs(Common.Utils.String.parseFloat(t)+1)<1e-4||this.checkAutoText(t)))this.value=this.options.autoText;else{var n=this._add(Common.Utils.String.parseFloat(t),0,this.options.allowDecimal?3:0);(void 0===t||isNaN(n))&&(n=this.oldValue,i=!0);var o=this.options.defaultUnit;if(void 0!==t.match){var s=t.match(/(px|em|%|en|ex|pt|"|cm|mm|pc|s|ms|см|мм|пт|сек|мс)$/i);null!==s&&"undefined"!==s[0]&&(o=s[0].toLowerCase())}this.options.defaultUnit===o||i||(n=this._recalcUnits(n,o)),n>this.options.maxValue&&(n=this.options.maxValue,i=!0),n<this.options.minValue&&(n=this.options.minValue,i=!0),this.value=(n+" "+this.options.defaultUnit).trim(),this.oldValue=n}!0!==e&&this.lastValue!==this.value&&this.trigger("change",this,this.value,this.lastValue),!0!==e&&i&&this.trigger("inputerror",this,this.value),this.rendered?this.setRawValue(this.value):this.options.value=this.value},setMask:function(t){this.options.maskExp=t},onMouseDown:function(t,e){this.disabled||(e&&$(e.currentTarget).addClass("active"),this.options.hold&&(this.switches.fromKeyDown=!1,this._startSpin(t,e)))},onMouseUp:function(t,e){this.disabled||($(e.currentTarget).removeClass("active"),this.options.hold?this._stopSpin():this._step(t))},onMouseOver:function(t){this.disabled||$(t.currentTarget).addClass("over")},onMouseOut:function(t){this.disabled||($(t.currentTarget).removeClass("active over"),this.options.hold&&this._stopSpin())},onKeyDown:function(t){if(!this.disabled){if(!this.options.hold||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN)if(t.keyCode==Common.UI.Keys.RETURN)if(this.options.defaultUnit&&this.options.defaultUnit.length){var e=this.getRawValue();if(this.value!=e)return this.onEnterValue(),this.trigger("inputleave",this),this.value==e}else this.onEnterValue();else this._fromKeyDown=!0;else t.preventDefault(),t.stopPropagation(),void 0===this.switches.timeout&&(this.switches.fromKeyDown=!0,this._startSpin(t.keyCode==Common.UI.Keys.UP,t));t.keyCode==Common.UI.Keys.ESC&&this.setRawValue(this.value),t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.ESC||this.trigger("inputleave",this)}},onKeyUp:function(t){this.disabled||t.keyCode!=Common.UI.Keys.UP&&t.keyCode!=Common.UI.Keys.DOWN||(t.stopPropagation(),t.preventDefault(),this.options.hold?this._stopSpin():this._step(t.keyCode==Common.UI.Keys.UP))},onKeyPress:function(t){if(!this.disabled){var e=String.fromCharCode(t.charCode);"."==e||","==e?(t.preventDefault(),t.stopPropagation()):!this.options.maskExp||this.options.maskExp.test(e)||t.ctrlKey||t.keyCode===Common.UI.Keys.RETURN||(t.preventDefault(),t.stopPropagation())}},onInput:function(t,e){this.disabled||t.isDefaultPrevented()||this.trigger("changing",this,$(t.target).val(),t)},onEnterValue:function(){if(this.$input){var t=this.getRawValue();this.setValue(""===t?this.value:t),this.trigger("entervalue",this)}},onBlur:function(t){if(this.$input){var e=this.getRawValue();this.setValue(""===e?this.value:e),this.options.hold&&this.switches.fromKeyDown&&this._stopSpin()}},_startSpin:function(t,e){if(!this.disabled){var i=this.switches.count;1===i?(this._step(t,!0),i=1):i=i<3?1.5:i<8?2.5:6,this.switches.timeout=setTimeout($.proxy(function(){this._step(t,!0),this._startSpin(t)},this),this.switches.speed/i),this.switches.count++}},_stopSpin:function(t){void 0!==this.switches.timeout&&(clearTimeout(this.switches.timeout),this.switches.timeout=void 0,this.switches.count=1,this.trigger("change",this,this.value,this.lastValue))},_increase:function(t){var e=this;if(!e.readOnly){var i=e.options.step;e._fromKeyDown?(i=this.getRawValue(),i=_.isEmpty(i)?e.oldValue:Common.Utils.String.parseFloat(i)):""!==e.getValue()?(i=e.checkAutoText(e.getValue())?e.options.defaultValue-e.options.step:Common.Utils.String.parseFloat(e.getValue()),isNaN(i)&&(i=this.oldValue)):i=e.options.defaultValue-e.options.step,e.setValue((this._add(i,e.options.step,e.options.allowDecimal?3:0)+" "+this.options.defaultUnit).trim(),t)}},_decrease:function(t){var e=this;if(!e.readOnly){var i=e.options.step;if(e._fromKeyDown)i=this.getRawValue(),i=_.isEmpty(i)?e.oldValue:Common.Utils.String.parseFloat(i);else if(""!==e.getValue()){if(i=e.checkAutoText(e.getValue())?e.options.minValue:Common.Utils.String.parseFloat(e.getValue()),isNaN(i)&&(i=this.oldValue),e.options.allowAuto&&this._add(i,-e.options.step,e.options.allowDecimal?3:0)<e.options.minValue)return void e.setValue(e.options.autoText,!0)}else i=e.options.defaultValue;e.setValue((this._add(i,-e.options.step,e.options.allowDecimal?3:0)+" "+this.options.defaultUnit).trim(),t)}},_step:function(t,e){t?this._increase(e):this._decrease(e),this.options.hold&&this.switches.fromKeyDown&&this.$input&&this.$input.select()},_add:function(t,e,i){var n=Math.pow(10,i||this.options.allowDecimal?2:0);return(Math.round(t*n)+Math.round(e*n))/n},_recalcUnits:function(t,e){if(e.match(/(s|ms|сек|мс)$/i)&&this.options.defaultUnit.match(/(s|ms|сек|мс)$/i)){var i=t;return"ms"!=e&&"мс"!=e||(i=parseFloat((i/1e3).toFixed(6))),"ms"!=this.options.defaultUnit&&"мс"!=this.options.defaultUnit||(i=parseFloat((1e3*i).toFixed(6))),i}if(null===e.match(/(pt|"|cm|mm|pc|см|мм|пт)$/i)||null===this.options.defaultUnit.match(/(pt|"|cm|mm|pc|см|мм|пт)$/i))return t;var i=t;return"cm"==e||"см"==e?i*=10:"pt"==e||"пт"==e?i=25.4*i/72:'"'==e?i*=25.4:"pc"==e&&(i=25.4*i/6),"cm"==this.options.defaultUnit||"см"==this.options.defaultUnit?i=parseFloat((i/10).toFixed(6)):"pt"==this.options.defaultUnit||"пт"==this.options.defaultUnit?i=parseFloat((72*i/25.4).toFixed(3)):'"'==this.options.defaultUnit?i=parseFloat((i/25.4).toFixed(3)):"pc"==this.options.defaultUnit&&(i=parseFloat((6*i/25.4).toFixed(6))),i},focus:function(){this.$input&&this.$input.focus()},setDefaultValue:function(t){this.options.defaultValue=t},checkAutoText:function(t){if(this.options.allowAuto&&"string"==typeof t){var e=t.toLowerCase();return e==this.options.autoText.toLowerCase()||"auto"==e}return!1}}),Common.UI.CustomSpinner=Common.UI.MetricSpinner.extend(_.extend({initialize:function(t){this.options.toCustomFormat=t.toCustomFormat?t.toCustomFormat:function(t){return t},this.options.fromCustomFormat=t.fromCustomFormat?t.fromCustomFormat:function(t){return t},Common.UI.MetricSpinner.prototype.initialize.call(this,t)},setRawValue:function(t){this.$input&&this.$input.val(this.options.toCustomFormat(t))},getRawValue:function(){return this.options.fromCustomFormat(this.$input.val())}},Common.UI.CustomSpinner||{}))}),void 0===Common)var Common={};if(define("common/main/lib/component/TextareaField",["common/main/lib/component/BaseView","common/main/lib/component/Tooltip"],function(){"use strict";Common.UI.TextareaField=Common.UI.BaseView.extend(function(){return{options:{id:null,cls:"",style:"",value:"",maxlength:void 0,placeHolder:"",spellcheck:!1,disabled:!1,resize:!1},template:_.template(['<div class="textarea-field" style="<%= style %>">',"<textarea ",'spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ',"<% if (dataHint) {%>",'data-hint="<%= dataHint %>" ',"<% } %>","<% if (dataHintDirection) {%>",'data-hint-direction="<%= dataHintDirection %>" ',"<% } %>","<% if (dataHintOffset) {%>",'data-hint-offset="<%= dataHintOffset %>" ',"<% } %>","></textarea>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.value=e.options.value,this.placeHolder=e.options.placeHolder,this.template=e.options.template||e.template,this.disabled=e.options.disabled,this.spellcheck=e.options.spellcheck,this.maxLength=e.options.maxLength,e.rendered=e.options.rendered||!1,e.options.el&&e.render()},render:function(t){var e=this;if(e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,
scope:e})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){this.cmpEl;this._input=this.cmpEl.find("textarea").addBack().filter("textarea"),this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength),this.resize||this._input.css("resize","none"),this.disabled&&this.setDisabled(this.disabled)}return e.rendered=!0,e.value&&e.setValue(e.value),this},_doChange:function(t,e){if(!e||!e.synthetic){var i=$(t.target).val(),n=this.value;this.trigger("changed:before",this,i,n,t),t.isDefaultPrevented()||(this.value=i,this.trigger("changed:after",this,i,n,t))}},onInputChanged:function(t,e){this._doChange(t,e)},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&t.stopPropagation(),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode==Common.UI.Keys.ESC&&this.trigger("inputleave",this))},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled")},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input.focus()}}}())}),!window.Common&&(window.Common={}),!Common.Views&&(Common.Views={}),define("common/forms/lib/view/modals",["common/main/lib/component/Window","common/main/lib/component/MetricSpinner","common/main/lib/component/TextareaField"],function(){"use strict";Common.Views.EmbedDialog=Common.UI.Window.extend(_.extend({options:{width:300,header:!0,style:"min-width: 300px;",cls:"modal-dlg",buttons:null},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 110px;">','<table cols="2" style="width: 100%;">',"<tr>",'<td style="padding-right: 10px;">','<label class="input-label">'+this.textWidth+":</label>",'<div id="embed-size-spin-width" style="display: inline-block;margin-left: 5px;"></div>',"</td>",'<td style="float:right;">','<label class="input-label">'+this.textHeight+":</label>",'<div id="embed-size-spin-height" style="display: inline-block;margin-left: 5px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<div id="embed-textarea" style="margin-top: 15px;"></div>',"</td>","</tr>","</table>","</div>",'<div class="separator horizontal"></div>','<div class="footer center">','<button class="btn normal primary dlg-btn" style="min-width: 86px;width: auto;">'+this.txtCopy+"</button>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.embedConfig=this.options.embedConfig,this.embedCode='<iframe allowtransparency="true" frameborder="0" scrolling="no" src="{0}" width="{1}" height="{2}"></iframe>',Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.spnWidth=new Common.UI.MetricSpinner({el:$("#embed-size-spin-width"),step:1,width:70,defaultUnit:"px",value:"400 px",minValue:400,maxValue:1e4}),this.spnWidth.on("change",_.bind(function(t,e,i,n){this.updateEmbedCode()},this)),this.spnHeight=new Common.UI.MetricSpinner({el:$("#embed-size-spin-height"),step:1,width:70,defaultUnit:"px",value:"600 px",minValue:600,maxValue:1e4}),this.spnHeight.on("change",_.bind(function(t,e,i,n){this.updateEmbedCode()},this)),this.textareaInput=new Common.UI.TextareaField({el:$("#embed-textarea"),style:"width: 100%; height: 65px;",value:""}),this.textareaInput._input.attr("readonly",!0),this.updateEmbedCode(),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.spnWidth,this.spnHeight,this.textareaInput]},getDefaultFocusableComponent:function(){return this.textareaInput},onBtnClick:function(t){this.textareaInput._input.select(),document.execCommand("copy")||Common.UI.warning({msg:this.warnCopy,buttons:["ok"]})},updateEmbedCode:function(){this.textareaInput.setValue(Common.Utils.String.format(this.embedCode,this.embedConfig.embedUrl,this.spnWidth.getNumberValue(),this.spnHeight.getNumberValue()))},textTitle:"Embed",textWidth:"Width",textHeight:"Height",txtCopy:"Copy to clipboard",warnCopy:"Browser's error! Use keyboard shortcut [Ctrl] + [C]"},Common.Views.EmbedDialog||{})),Common.Views.ShareDialog=Common.UI.Window.extend(_.extend({options:{width:300,header:!0,style:"min-width: 300px;",cls:"modal-dlg",buttons:null},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 100px;">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<div id="share-link-txt"></div>',"</td>","</tr>","<tr>","<td>",'<div class="share-buttons" style="margin-top: 15px;">','<span class="svg big-facebook" data-name="facebook"></span>','<span class="svg big-twitter" data-name="twitter"></span>','<span class="svg big-email" data-name="email"></span>','<div class="autotest" id="email" style="display: none"></div>',"</div>","</td>","</tr>","</table>","</div>",'<div class="separator horizontal"></div>','<div class="footer center">','<button class="btn normal primary dlg-btn" style="min-width: 86px;width: auto;">'+this.txtCopy+"</button>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.embedConfig=this.options.embedConfig,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.textUrl=new Common.UI.InputField({el:$("#share-link-txt"),editable:!1,value:this.embedConfig.shareUrl||""}),this.updateShareCode(),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},onBtnClick:function(t){this.textUrl._input.select(),document.execCommand("copy")||Common.UI.warning({msg:this.warnCopy,buttons:["ok"]})},updateShareCode:function(){var t=this,e=encodeURIComponent(this.embedConfig.shareUrl),i=this.embedConfig.docTitle||"",n="mailto:?subject=I have shared a document with you: "+i+"&body=I have shared a document with you: "+e;this.getChild().find(".share-buttons > span").on("click",function(o){var s;switch($(o.target).attr("data-name")){case"facebook":s="https://www.facebook.com/sharer/sharer.php?u="+t.embedConfig.shareUrl+"&t="+encodeURI(i),window.open(s,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600");break;case"twitter":s="https://twitter.com/share?url="+e,!!i&&(s+=encodeURIComponent("&text="+i)),window.open(s,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600");break;case"email":window.open(n,"_self")}})},textTitle:"Share Link",txtCopy:"Copy to clipboard",warnCopy:"Browser's error! Use keyboard shortcut [Ctrl] + [C]"},Common.Views.ShareDialog||{}))}),void 0===Common)var Common={};if(define("common/main/lib/component/ToggleManager",["common/main/lib/component/BaseView"],function(){"use strict";function t(t,i){var n,o,s;if(i)for(n=e[t.toggleGroup],o=0,s=n.length;o<s;o++)n[o]!==t&&(n[o].isActive?n[o].isActive()&&n[o].toggle(!1):n[o].toggle(!1))}var e={};Common.UI.ToggleManager={register:function(i){if(i.toggleGroup){var n=e[i.toggleGroup];n||(n=e[i.toggleGroup]=[]),n.push(i),i.on("toggle",t)}},unregister:function(i){if(i.toggleGroup){var n=e[i.toggleGroup];n&&(_.without(n,i),i.off("toggle",t))}},getToggled:function(t){var i,n=e[t],o=0;if(n)for(i=n.length;o<i;o++)if(!0===n[o].pressed||!0===n[o].checked)return n[o];return null}}}),void 0===Common)var Common={};if(define("common/main/lib/component/Button",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],function(){"use strict";window.createButtonSet=function(){function t(t){}t.prototype=new Array,t.prototype.constructor=t;var e=!1;t.prototype.add=function(t){t.setDisabled(e),this.push(t)},t.prototype.setDisabled=function(t){e=t,this.forEach(function(e){e.setDisabled(t)})},t.prototype.toggle=function(t,e){this.forEach(function(i){i.toggle(t,e)})},t.prototype.pressed=function(){return this.some(function(t){return t.pressed})},t.prototype.contains=function(t){return this.some(function(e){return e.id==t})},t.prototype.concat=function(){var t=Array.prototype.slice.call(arguments),e=Array.prototype.slice.call(this);return t.forEach(function(t){t instanceof Array?Array.prototype.push.apply(e,t):t&&e.push(t)}),e};var i=Object.create(t.prototype);for(var n in arguments)i.add(arguments[n]);return i};var t=function(t){var e=document.createElement("span");e.style.fontSize="11px",e.style.fontFamily='Arial, Helvetica, "Helvetica Neue", sans-serif',e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.innerHTML=t,document.body.appendChild(e);var i=e.offsetWidth;return document.body.removeChild(e),i},e=function(e,i){for(var n=e.length-1,o=e;t(o)>i;)o=e.slice(0,n).trim()+"...",n--;return o};Common.UI.Button=Common.UI.BaseView.extend({options:{id:null,hint:!1,enableToggle:!1,allowDepress:!0,toggleGroup:null,cls:"",iconCls:"",caption:"",menu:null,disabled:!1,pressed:!1,split:!1,visible:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"0, 0"},template:_.template(["<% var applyicon = function() { %>","<% if (iconImg) { print('<img src=\"' + iconImg + '\">'); } else { %>",'<% if (iconCls != "") {  if (/svgicon/.test(iconCls)) {print(\'<svg class="icon"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use><use class="zoom-grit" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'-150"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); }} %>',"<% } %>","<% if ( !menu ) { %>",'<button type="button" class="btn <%= cls %>" id="<%= id %>" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>","<% } else if (split == false) {%>",'<div class="btn-group" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>','<span class="inner-box-caret"><i class="caret"></i></span>',"</button>","</div>","<% } else { %>",'<div class="btn-group split" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn <%= cls %>">',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>",'<button type="button" class="btn <%= cls %> dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>','<i class="caret"></i>','<span class="sr-only"></span>',"</button>","</div>","<% } %>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.id=e.options.id||Common.UI.getId(),e.hint=e.options.hint,e.enableToggle=e.options.enableToggle,e.allowDepress=e.options.allowDepress,e.cls=e.options.cls,e.iconCls=e.options.iconCls,e.menu=e.options.menu,e.split=e.options.split,e.toggleGroup=e.options.toggleGroup,e.disabled=e.options.disabled,e.visible=e.options.visible,e.pressed=e.options.pressed,e.caption=e.options.caption,e.template=e.options.template||e.template,e.style=e.options.style,e.rendered=!1,e.options.el?e.render():e.options.parentEl&&e.render(e.options.parentEl)},getCaptionWithBreaks:function(i){var n=i.split(" "),o=null,s=156,r=n.indexOf("&");if(r>-1&&(n[r-1]+=" &",n.splice(r,1)),n.length>1)if(s=this.menu||!0===this.split?s-10:s,n.length<3)n[0]=e(n[0],this.menu?s+10:s),n[1]=e(n[1],s),o=n[0]+"<br>"+n[1];else{var a="";if(t(n[0]+" "+n[1])<s){for(var l=2;l<n.length;l++)a+=n[l]+" ";2*t(a+(this.menu?10:0))<t(n[0]+" "+n[1])?(a=e((n[1]+" "+a).trim(),s),o=n[0]+"<br>"+a):(a=e(a.trim(),s),o=n[0]+" "+n[1]+"<br>"+a)}else{for(var c=1;c<n.length;c++)a+=n[c]+" ";a=e(a.trim(),s),o=n[0]+"<br>"+a}}else{o=t(i)<s?i:e(i,s),(this.menu||!0===this.split)&&(o+="<br>")}return o},render:function(t){var e=this;if(e.trigger("render:before",e),e.cmpEl=e.$el||$(e.el),t&&(e.setElement(t,!1),!e.rendered)){if(/icon-top/.test(e.cls)&&e.caption&&/huge/.test(e.cls)){!0===e.split?(!!e.cls&&(e.cls=e.cls.replace(/\s?(?:x-huge|icon-top)/g,"")),this.template=_.template('<div class="btn-group x-huge split icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn <%= cls %> inner-box-icon"><span class="btn-fixflex-hcenter"><% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use><use class="zoom-grit" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'-150"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %></span></button><button type="button" class="btn <%= cls %> inner-box-caption dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><span class="btn-fixflex-vcenter"><span class="caption"><%= caption %><i class="caret"></i></span><i class="caret compact-caret"></i></span></button></div>')):e.menu?this.template=_.template('<div class="btn-group icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><div class="inner-box-icon"><% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use><use class="zoom-grit" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'-150"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %></div><div class="inner-box-caption"><span class="caption"><%= caption %><i class="caret"></i></span><i class="caret compact-caret"></i></div></button></div>'):this.template=_.template('<button type="button" class="btn <%= cls %>" id="<%= id %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>> <div class="inner-box-icon"><% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use><use class="zoom-grit" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'-150"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %></div><div class="inner-box-caption"><span class="caption"><%= caption %></span></div></button>');var i=this.getCaptionWithBreaks(this.caption);i&&(e.caption=i)}e.cmpEl=$(this.template({id:e.id,cls:e.cls,iconCls:e.iconCls,iconImg:e.options.iconImg,menu:e.menu,split:e.split,disabled:e.disabled,pressed:e.pressed,caption:e.caption,style:e.style,dataHint:e.options.dataHint,dataHintDirection:e.options.dataHintDirection,dataHintOffset:e.options.dataHintOffset,dataHintTitle:e.options.dataHintTitle})),e.menu&&_.isObject(e.menu)&&_.isFunction(e.menu.render)&&e.menu.render(e.cmpEl),t.html(e.cmpEl),e.$icon=e.$el.find(".icon")}if(!e.rendered){var n=e.cmpEl,o=n.hasClass("btn-group"),s=n.hasClass("split");if(e.options.hint){var r=e.cmpEl.closest(".asc-window");if("object"==typeof e.options.hint&&e.options.hint.length>1&&$("button",n).length>0){var a=$("button",n);e.btnEl=$(a[0]),e.btnMenuEl=$(a[1])}else e.btnEl=e.cmpEl,e.btnEl.attr("data-toggle","tooltip");if(e.btnEl.tooltip({title:"string"==typeof e.options.hint?e.options.hint:e.options.hint[0],placement:e.options.hintAnchor||"cursor"}),e.btnMenuEl&&e.btnMenuEl.tooltip({title:e.options.hint[1],placement:e.options.hintAnchor||"cursor"}),r.length>0){e.btnEl.data("bs.tooltip").tip().css("z-index",parseInt(r.css("z-index"))+10),e.btnMenuEl&&e.btnMenuEl.data("bs.tooltip").tip().css("z-index",parseInt(r.css("z-index"))+10);var l=function(t){if(r[0]===t.$window[0]){var i=e.btnEl.data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),i.hide()),Common.NotificationCenter.off({"modal:close":l})}};Common.NotificationCenter.on({"modal:close":l})}}_.isString(e.toggleGroup)&&(e.enableToggle=!0);var c,h=function(t){if(!e.disabled&&1==t.which){if(e.doToggle(),e.options.hint){var i=e.btnEl.data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),i.hide())}e.trigger("click",e,t)}},d=function(t,i,o){if(!t){var r=!1;$("button",n).each(function(t,e){if($(e).is(":hover"))return r=!0,!1}),r||(n.removeClass("over"),$("button",n).removeClass("over"))}if("button"==i){if(!t&&e.enableToggle&&e.allowDepress&&e.pressed)return;if(t&&!s&&e.enableToggle&&e.allowDepress&&!e.pressed)return void o.preventDefault();$("button:first",n).toggleClass("active",t)}else $("[data-toggle^=dropdown]",n).toggleClass("active",t);n.toggleClass("active",t)},u=function(t){if(!e.disabled&&1==t.which&&s){if(e.options.hint){var i=(e.btnMenuEl?e.btnMenuEl:e.btnEl).data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),i.hide())}var o=n.hasClass("open");d(!o,"arrow",t)}},p=function(t,e){s?d(e,"button",t):(n.toggleClass("active",e),$("button",n).toggleClass("active",e))},m=function(t){c=t.currentTarget.className.match(/dropdown/)?"arrow":"button",d(!0,c,t),$(document).on("mouseup",f)},f=function(t){d(!1,c,t),$(document).off("mouseup",f)},g=function(t,i){e.cmpEl.find(".dropdown-toggle").blur(),e.cmpEl.hasClass("active")!==e.pressed&&e.cmpEl.trigger("button.internal.active",[e.pressed])};o?(s&&($("[data-toggle^=dropdown]",n).on("mousedown",_.bind(u,this)),$("button",n).on("mousedown",_.bind(m,this)),e.options.width>0&&$("button:first",n).css("width",e.options.width-$("[data-toggle^=dropdown]",n).outerWidth())),n.on("hide.bs.dropdown",_.bind(d,e,!1,"arrow")),n.on("show.bs.dropdown",_.bind(d,e,!0,"arrow")),n.on("hidden.bs.dropdown",_.bind(g,e)),$("button:first",n).on("click",h)):n.on("click",h),n.on("button.internal.active",_.bind(p,e)),n.on("mouseover",function(t){e.disabled||(e.cmpEl.addClass("over"),e.trigger("mouseover",e,t))}),n.on("mouseout",function(t){e.cmpEl.removeClass("over"),e.disabled||e.trigger("mouseout",e,t)}),Common.UI.ToggleManager.register(e)}return e.rendered=!0,e.pressed&&e.toggle(e.pressed,!0),e.disabled&&e.setDisabled(!(e.disabled=!1)),e.visible||e.setVisible(e.visible),e.trigger("render:after",e),this},doToggle:function(){var t=this;!t.enableToggle||!1===t.allowDepress&&t.pressed||t.toggle()},toggle:function(t,e){var i=void 0===t?!this.pressed:!!t;this.pressed=i,this.cmpEl&&this.cmpEl.trigger("button.internal.active",[i]),e||this.trigger("toggle",this,i)},click:function(t){this.disabled||(this.doToggle(),this.trigger("click",this,t))},isActive:function(){return this.enableToggle?this.pressed:this.cmpEl.hasClass("active")},setDisabled:function(t){if(this.rendered&&this.disabled!=t){var e=this.cmpEl,i=e.hasClass("btn-group"),n=this;if((t=!0===t)!==e.hasClass("disabled")){var o=function(e){e.toggleClass("disabled",t),n.options.allowMouseEventsOnDisabled||(t?e.attr({disabled:t}):e.removeAttr("disabled"))};o(e),i&&o(e.children("button"))}if((t||!Common.Utils.isGecko)&&this.options.hint){var s=this.btnEl.data("bs.tooltip");s&&(t&&s.hide(),!Common.Utils.isGecko&&(s.enabled=!t)),this.btnMenuEl&&(s=this.btnMenuEl.data("bs.tooltip"))&&(t&&s.hide(),!Common.Utils.isGecko&&(s.enabled=!t))}if(t&&this.menu&&_.isObject(this.menu)&&this.menu.rendered&&this.menu.isVisible()&&setTimeout(function(){n.menu.hide()},1),n.options.signals){n.options.signals.indexOf("disabled")<0||n.trigger("disabled",n,t)}}this.disabled=t},isDisabled:function(){return this.disabled},setIconCls:function(t){var e=$(this.el).find(".icon"),i=this.iconCls;if(this.iconCls=t,/svgicon/.test(this.iconCls)){var n=/svgicon\s(\S+)/.exec(this.iconCls);e.find("use.zoom-int").attr("xlink:href",n&&n.length>1?"#"+n[1]:""),e.find("use.zoom-grit").attr("xlink:href",n&&n.length>1?"#"+n[1]+"-150":"")}else e.removeClass(i),e.addClass(t||"")},changeIcon:function(t){var e=this;t&&(t.curr||t.next)&&e.$icon&&(!!t.curr&&e.$icon.removeClass(t.curr),!!t.next&&!e.$icon.hasClass(t.next)&&e.$icon.addClass(t.next),e.options.signals&&(e.options.signals.indexOf("icon:changed")<0||e.trigger("icon:changed",e,t)))},hasIcon:function(t){return this.$icon.hasClass(t)},setVisible:function(t){this.cmpEl&&this.cmpEl.toggleClass("hidden",!t),this.visible=t},isVisible:function(){return this.cmpEl?this.cmpEl.is(":visible"):$(this.el).is(":visible")},updateHint:function(t,e){if(this.options.hint=t,this.rendered){var i=this.cmpEl,n=i.closest(".asc-window");if(!this.btnEl)if("object"==typeof this.options.hint&&this.options.hint.length>1&&$("button",i).length>0){var o=$("button",i);this.btnEl=$(o[0]),this.btnMenuEl=$(o[1])}else this.btnEl=i,this.btnEl.attr("data-toggle","tooltip");if(this.btnEl.data("bs.tooltip")&&this.btnEl.removeData("bs.tooltip"),this.btnMenuEl&&this.btnMenuEl.data("bs.tooltip")&&this.btnMenuEl.removeData("bs.tooltip"),this.btnEl.tooltip({html:!!e,title:"string"==typeof t?t:t[0],placement:this.options.hintAnchor||"cursor"}),this.btnMenuEl&&this.btnMenuEl.tooltip({html:!!e,title:t[1],placement:this.options.hintAnchor||"cursor"}),n.length>0&&(this.btnEl.data("bs.tooltip").tip().css("z-index",parseInt(n.css("z-index"))+10),this.btnMenuEl&&this.btnMenuEl.data("bs.tooltip").tip().css("z-index",parseInt(n.css("z-index"))+10)),this.disabled||!Common.Utils.isGecko){var s=this.btnEl.data("bs.tooltip");s&&(this.disabled&&s.hide(),!Common.Utils.isGecko&&(s.enabled=!this.disabled)),this.btnMenuEl&&(s=this.btnMenuEl.data("bs.tooltip"))&&(this.disabled&&s.hide(),!Common.Utils.isGecko&&(s.enabled=!this.disabled))}}},setCaption:function(t){if(this.caption!=t){if(/icon-top/.test(this.cls)&&this.caption&&/huge/.test(this.cls)){var e=this.getCaptionWithBreaks(t);this.caption=e||t}else this.caption=t;if(this.rendered){var i=this.cmpEl.find(".caption");i.length>0?i.html(this.caption):this.cmpEl.find("button:first").addBack().filter("button").html(this.caption)}}},setMenu:function(t){t&&_.isObject(t)&&_.isFunction(t.render)&&(this.menu=t,this.rendered&&this.menu.render(this.cmpEl))}})}),void 0===Common)var Common={};if(define("common/main/lib/component/InputField",["common/main/lib/component/BaseView","common/main/lib/component/Tooltip","common/main/lib/component/Button"],function(){"use strict";Common.UI.InputField=Common.UI.BaseView.extend(function(){return{options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0},template:_.template(['<div class="input-field" style="<%= style %>">',"<input ",'type="<%= type %>" ','name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','data-hint="<%= dataHint %>"','data-hint-direction="<%= dataHintDirection %>"','data-hint-offset="<%= dataHintOffset %>"',">",'<span class="input-error"></span>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.value=e.options.value,this.type=e.options.type,this.name=e.options.name,this.validation=e.options.validation,this.allowBlank=e.options.allowBlank,this.placeHolder=e.options.placeHolder,this.template=e.options.template||e.template,this.editable=e.options.editable,this.disabled=e.options.disabled,this.spellcheck=e.options.spellcheck,this.blankError=e.options.blankError||"This field is required",this.validateOnChange=e.options.validateOnChange,this.validateOnBlur=e.options.validateOnBlur,this.maxLength=e.options.maxLength,e.rendered=e.options.rendered||!1,e.options.el&&e.render()},render:function(t){var e=this;if(e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:e})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;if(this._input=this.cmpEl.find("input").addBack().filter("input"),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),this._input.closest(".asc-window").length>0)var n=function(){var t=i.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":n})};Common.NotificationCenter.on({"modal:close":n})}return e.rendered=!0,e.value&&e.setValue(e.value),this},_doChange:function(t,e){if(!e||!e.synthetic){var i=$(t.target).val(),n=this.value;this.trigger("changed:before",this,i,n,t),t.isDefaultPrevented()||(this.value=i,this.validateOnBlur&&this.checkValidate(),this.trigger("changed:after",this,i,n,t))}},onInputChanged:function(t,e){this._doChange(t,e)},onInputChanging:function(t,e){var i=$(t.target).val(),n=this.value;t.isDefaultPrevented()||(this.value=i,this.validateOnBlur&&this.checkValidate(),this.trigger("changing",this,i,n,t))},onKeyPress:function(t){if(this.trigger("keypress:before",this,t),!t.isDefaultPrevented()){if(this.options.maskExp&&!_.isEmpty(this.options.maskExp.source)){var e=String.fromCharCode(t.which);this.options.maskExp.test(e)||t.ctrlKey||t.keyCode===Common.UI.Keys.RETURN||(t.preventDefault(),t.stopPropagation())}this.trigger("keypress:after",this,t)}},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&this._doChange(t),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.ESC||this.trigger("inputleave",this))},onKeyUp:function(t){this.trigger("keyup:before",this,t),t.isDefaultPrevented()||this.trigger("keyup:after",this,t)},setEditable:function(t){var e=this._input;this.editable=t,t&&e?(e.removeAttr("readonly"),e.removeAttr("data-can-copy")):(e.attr("readonly","readonly"),e.attr("data-can-copy",!1))},isEditable:function(){return this.editable},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled")},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input&&this._input.focus()},checkValidate:function(){var t=this,e=[];if(!t.allowBlank&&_.isEmpty(t.value)&&e.push(t.blankError),_.isFunction(t.validation)){var i=t.validation.call(t,t.value);!0!==i&&(e=_.flatten(e.concat(i)))}if(!_.isEmpty(e)){if(t.cmpEl.hasClass("error")){var n=t.cmpEl.find(".input-error").data("bs.tooltip");return n&&(n.options.title=e.join("\n"),n.setContent()),e}t.cmpEl.addClass("error");var o=t.cmpEl.find(".input-error"),s=o.closest(".asc-window"),n=o.data("bs.tooltip");return n&&n.tip().remove(),o.attr("data-toggle","tooltip"),o.removeData("bs.tooltip"),o.tooltip({title:e.join("\n"),placement:"cursor"}),s.length>0&&o.data("bs.tooltip").tip().css("z-index",parseInt(s.css("z-index"))+10),e}return t.cmpEl.removeClass("error"),!0},showError:function(t,e){var i=this;if(_.isEmpty(t))i.cmpEl.removeClass("error"),i.cmpEl.removeClass("warning");else{i.cmpEl.addClass(e?"warning":"error");var n=i.cmpEl.find(".input-error"),o=n.closest(".asc-window"),s=n.data("bs.tooltip");s&&s.tip().remove(),n.attr("data-toggle","tooltip"),n.removeData("bs.tooltip"),n.tooltip({title:t.join("\n"),placement:"cursor"}),o.length>0&&n.data("bs.tooltip").tip().css("z-index",parseInt(o.css("z-index"))+10)}},showWarning:function(t){this.showError(t,!0)}}}()),Common.UI.InputFieldBtn=Common.UI.InputField.extend(function(){return{options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-select-range",btnHint:""},template:_.template(['<div class="input-field input-field-btn" style="<%= style %>">',"<input ","type=<%= type %> ",'name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','value="<%= value %>"','data-hint="<%= dataHint %>"','data-hint-offset="<%= dataHintOffset %>"','data-hint-direction="<%= dataHintDirection %>"',">",'<span class="input-error"></span>','<div class="select-button"></div>',"</div>"].join("")),render:function(t){var e=this;if(e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,scope:e,dataHint:this.options.dataHint,dataHintOffset:this.options.dataHintOffset,dataHintDirection:this.options.dataHintDirection})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;if(this._button=new Common.UI.Button({cls:"btn-toolbar",iconCls:this.options.iconCls,hint:this.options.btnHint||"",menu:this.options.menu}),this._button.render(this.cmpEl.find(".select-button")),this._button.on("click",_.bind(this.onButtonClick,this)),this._input=this.cmpEl.find("input").addBack().filter("input"),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),this._input.closest(".asc-window").length>0)var n=function(){var t=i.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":n})};Common.NotificationCenter.on({"modal:close":n})}return e.rendered=!0,e.value&&e.setValue(e.value),this},onButtonClick:function(t,e){this.trigger("button:click",this,e)},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"),this._button.setDisabled(t)},setBtnDisabled:function(t){this._button.setDisabled(t)},updateBtnHint:function(t){this.options.hint=t,this.rendered&&this._button.updateHint(this.options.hint)}}}()),Common.UI.InputFieldBtnPassword=Common.UI.InputFieldBtn.extend(_.extend(function(){return{options:{id:null,cls:"",style:"",value:"",name:"",type:"password",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,showCls:"toolbar__icon btn-sheet-view",hideCls:"toolbar__icon hide-password",btnHint:"",repeatInput:null,
showPwdOnClick:!0},initialize:function(t){t=t||{},t.btnHint=t.btnHint||this.textHintShowPwd,t.iconCls=t.showCls||this.options.showCls,Common.UI.InputFieldBtn.prototype.initialize.call(this,t),this.hidePwd=!0,this.repeatInput=this.options.repeatInput},render:function(t){return Common.UI.InputFieldBtn.prototype.render.call(this,t),this._btnElm=this._button.$el,this.options.showPwdOnClick?this._button.on("click",_.bind(this.passwordClick,this)):this._btnElm.on("mousedown",_.bind(this.passwordShow,this)),this},passwordClick:function(t){this.hidePwd?(this.passwordShow(t),this.hidePwd=!1):(this.passwordHide(t),this.hidePwd=!0);var e=this,i=e._input[0].selectionStart,n=e._input[0].selectionEnd;setTimeout(function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=n},1)},passwordShow:function(t){this.disabled||(this._button.setIconCls(this.options.hideCls),this.type="text",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick?this._button.updateHint(this.textHintHidePwd):(this._btnElm.on("mouseup",_.bind(this.passwordHide,this)),this._btnElm.on("mouseout",_.bind(this.passwordHide,this))))},passwordHide:function(t){if(this._button.setIconCls(this.options.showCls),this.type="password",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick)this._button.updateHint(this.textHintShowPwd);else{this._btnElm.off("mouseup",this.passwordHide),this._btnElm.off("mouseout",this.passwordHide);var e=this,i=e._input[0].selectionStart,n=e._input[0].selectionEnd;setTimeout(function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=n},1)}},textHintShowPwd:"Show password",textHintHidePwd:"Hide password"}}(),Common.UI.InputFieldBtnPassword||{})),Common.UI.InputFieldBtnCalendar=Common.UI.InputFieldBtn.extend(function(){return{options:{id:null,cls:"",style:"",value:"",type:"date",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-datetime",btnHint:"",menu:!0},render:function(t){var e=this;Common.UI.InputFieldBtn.prototype.render.call(this,t);var i="id-"+Common.UI.getId()+"input-field-datetime",n=new Common.UI.Menu({menuAlign:"tr-br",style:"border: none; padding: 0;",items:[{template:_.template('<div id="'+i+'" style=""></div>'),stopPropagation:!0}]});$("button",this._button.cmpEl).addClass("no-caret"),this._button.setMenu(n),this._button.menu.on("show:after",function(t){e.cmpCalendar||(e.cmpCalendar=new Common.UI.Calendar({el:e.cmpEl.find("#"+i),enableKeyEvents:!0,firstday:1}),e.cmpCalendar.on("date:click",function(i,n){e.trigger("date:click",e,n),t.hide()}),t.alignPosition()),e.cmpCalendar.focus()})},setDate:function(t){this.cmpCalendar&&t&&t instanceof Date&&!isNaN(t)&&this.cmpCalendar&&this.cmpCalendar.setDate(t)}}}())}),$(document).off("keydown.bs.dropdown.data-api").on("keydown.bs.dropdown.data-api","[data-toggle=dropdown], [role=menu]",onDropDownKeyDown),"ontouchstart"in document.documentElement&&$(document).on("click.bs.dropdown.data-api","[data-toggle=dropdown]",toggle),function(){function t(t){1!=t.which&&void 0!=t.which||clearMenus(/form-control/.test(t.target.className))}var e,i=$._data($(document).get(0),"events");i&&i.click&&i.click.every(function(t,i,n){return/click/.test(t.type)&&!t.selector&&/bs\..+\.dropdown/.test(t.namespace)&&(e=t.handler),!e}),e&&$(document).off("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",t)}(),define("common/main/lib/extend/Bootstrap",function(){}),void 0===Common)var Common={};if(define("common/main/lib/component/MenuItem",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],function(){"use strict";Common.UI.MenuItem=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,checkable:!1,checked:!1,allowDepress:!1,disabled:!1,visible:!0,value:null,toggleGroup:null,iconCls:"",menu:null,canFocused:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"",dataHintTitle:""},tagName:"li",template:_.template(['<a id="<%= id %>" style="<%= style %>" <% if(options.canFocused) { %> tabindex="-1" type="menuitem" <% }; if(!_.isUndefined(options.stopPropagation)) { %> data-stopPropagation="true" <% }; if(!_.isUndefined(options.dataHint)) { %> data-hint="<%= options.dataHint %>" <% }; if(!_.isUndefined(options.dataHintDirection)) { %> data-hint-direction="<%= options.dataHintDirection %>" <% }; if(!_.isUndefined(options.dataHintOffset)) { %> data-hint-offset="<%= options.dataHintOffset %>" <% }; if(options.dataHintTitle) { %> data-hint-title="<%= options.dataHintTitle %>" <% }; %> >',"<% if (!_.isEmpty(iconCls)) { %>",'<span class="menu-item-icon <%= iconCls %>"></span>',"<% } %>","<%= caption %>","</a>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.caption=e.options.caption,this.menu=e.options.menu||null,this.checkable=e.options.checkable,this.checked=e.options.checked,e.allowDepress=e.options.allowDepress,this.disabled=e.options.disabled,this.visible=e.options.visible,this.value=e.options.value,this.toggleGroup=e.options.toggleGroup,this.template=e.options.template||this.template,this.iconCls=e.options.iconCls,this.hint=e.options.hint,this.rendered=!1,null===this.menu||this.menu instanceof Common.UI.Menu||this.menu instanceof Common.UI.MenuSimple||(this.menu=new Common.UI.Menu(_.extend({},e.options.menu))),e.options.el&&this.render()},render:function(){var t=this,e=t.$el||$(this.el);if(t.trigger("render:before",t),"--"===t.caption)e.addClass("divider");else if(!this.rendered){e.off("click"),Common.UI.ToggleManager.unregister(t),e.html(this.template({id:t.id,caption:t.caption,iconCls:t.iconCls,style:t.style,options:t.options})),t.menu&&(e.addClass("dropdown-submenu"),t.menu.render(e),e.mouseenter(_.bind(t.menu.alignPosition,t.menu)),e.focusout(_.bind(t.onBlurItem,t)),e.hover(_.bind(t.onHoverItem,t),_.bind(t.onUnHoverItem,t)));var i=e.children(":first");this.checkable&&i&&(i.toggleClass("checkable",this.checkable),i.toggleClass("no-checkmark",!1===this.options.checkmark),i.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||i.css("background-image","none")),t.options.hint&&(e.attr("data-toggle","tooltip"),e.tooltip({title:t.options.hint,placement:t.options.hintAnchor||function(t,e){var i=this.getPosition(),n=t.offsetWidth,o=t.offsetHeight,s=Common.Utils.innerWidth(),r=Common.Utils.innerHeight(),a=i.top,l=i.left+i.width+2;a+o>r&&(a=r-o-2),l+n>s&&(l=i.left-n-2),$(t).offset({top:a,left:l}).addClass("in")}})),this.cls&&e.addClass(this.cls),this.disabled&&e.toggleClass("disabled",this.disabled),e.on("click",_.bind(this.onItemClick,this)),e.on("mousedown",_.bind(this.onItemMouseDown,this)),Common.UI.ToggleManager.register(t)}return this.visible||this.setVisible(this.visible),t.cmpEl=e,t.rendered=!0,t.trigger("render:after",t),this},setCaption:function(t,e){this.caption=t,this.rendered&&(this.cmpEl.find("a").contents().last()[0].textContent=e?t:Common.Utils.String.htmlEncode(t))},setIconCls:function(t){if(this.rendered&&!_.isEmpty(this.iconCls)){var e=this.cmpEl.children(":first");e&&e.find(".menu-item-icon").removeClass(this.iconCls).addClass(t)}this.iconCls=t},setChecked:function(t,e){this.toggle(t,e)},isChecked:function(){return this.checked},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},toggle:function(t,e){var i=void 0===t?!this.checked:!!t;if(this.checkable){if(this.checked=i,this.rendered){var n=this.cmpEl.children(":first");n&&(n.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||n.css("background-image","none"))}e||this.trigger("toggle",this,i)}},onItemMouseDown:function(t){if(Common.UI.HintManager&&Common.UI.HintManager.clearHints(),1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},onItemClick:function(t){return(1==t.which||void 0===t.which&&!this.menu)&&(this.disabled||!this.allowDepress&&this.checked&&this.toggleGroup||this.menu||this.setChecked(!this.checked),this.menu?t.target.id!=this.id&&void(this.menu.isOver||this.cmpEl.removeClass("over")):!this.disabled&&void this.trigger("click",this,t))},onHoverItem:function(t){this._doHover(t)},onUnHoverItem:function(t){this._doUnHover(t)},onBlurItem:function(t){this._doUnHover(t)},_doHover:function(t){var e=this;e.menu&&!e.disabled&&(clearTimeout(e.hideMenuTimer),e.cmpEl.trigger("show.bs.dropdown"),e.expandMenuTimer=_.delay(function(){e.cmpEl.addClass("over"),e.cmpEl.trigger("shown.bs.dropdown")},200))},_doUnHover:function(t){var e=this;if(e.cmpEl.hasClass("dropdown-submenu")&&e.cmpEl.hasClass("over")&&(t&&t.relatedTarget&&e.cmpEl.find(t.relatedTarget).length>0||e.cmpEl.hasClass("focused-submenu")))return void e.cmpEl.removeClass("focused-submenu");if(e.menu&&!e.disabled&&(clearTimeout(e.expandMenuTimer),e.hideMenuTimer=_.delay(function(){e.menu.isOver||e.cmpEl.removeClass("over")},200),t&&"focusout"!==t.type)){var i=e.cmpEl.children(":focus");i.length>0&&(i.blur(),e.cmpEl.closest("ul").focus())}}}),Common.UI.MenuItemSeparator=function(t){return t=t||{},t.caption="--",new Common.UI.MenuItem(t)}}),void 0===Common)var Common={};if(define("common/main/lib/component/Menu",["common/main/lib/extend/Bootstrap","common/main/lib/component/BaseView","common/main/lib/component/MenuItem","common/main/lib/component/Scroller"],function(){"use strict";Common.UI.Menu=function(){var t=function(){var t=[],e={};return{register:function(i){e[i.id]=i,i.on("show:after",function(e){t.push(e)}).on("hide:after",function(e){var i=t.indexOf(e);i>-1&&t.splice(i,1)})},unregister:function(i){var n=t.indexOf(i);delete e[i.id],n>-1&&t.splice(n,1),i.off("show:after").off("hide:after")},hideAll:function(){return Common.NotificationCenter.trigger("menumanager:hideall"),!!(t&&t.length>0)&&(_.each(t,function(t){t&&t.hide()}),!0)}}}();return _.extend(Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,scrollAlwaysVisible:!0},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu"></ul>'].join("")),initialize:function(e){Common.UI.BaseView.prototype.initialize.call(this,e);var i=this;this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||Common.UI.MenuItem.prototype.template,this.rendered=!1,this.items=[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,this.outerMenu=this.options.outerMenu,this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight?this.options.maxHeight:1e5,!this.options.maxHeight&&(this.options.maxHeight=this.options.restoreHeight)),this.options.cyclic||(this.options.cls+=" no-cyclic"),_.each(this.options.items,function(t){t instanceof Common.UI.MenuItem?i.items.push(t):i.items.push(new Common.UI.MenuItem(_.extend({tagName:"li",template:i.itemTemplate},t)))}),this.options.el&&this.render(),t.register(this)},remove:function(){t.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this;this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t?(this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({options:e.options})),t.append(this.cmpEl))):e.rendered||(this.cmpEl=this.template({options:e.options}),this.$el.append(this.cmpEl));var i=this.cmpEl.parent(),n="menu"===i.attr("role")?i:i.find("[role=menu]");return this.menuRoot=n,n&&(e.rendered||_.each(e.items||[],function(t){n.append(t.render().el),t.on("click",_.bind(e.onItemClick,e)),t.on("toggle",_.bind(e.onItemToggle,e))}),this.options.maxHeight&&(n.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),n.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=n.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),this.parentEl.on("keydown.before.bs.dropdown",_.bind(e.onBeforeKeydownMenu,e)),this.options.innerMenus&&this.on("keydown:before",_.bind(e.onBeforeKeyDown,e)),n.hover(function(t){e.isOver=!0},function(t){e.isOver=!1})),this.rendered=!0,this.trigger("render:after",this),this},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},insertItem:function(t,e){var i=this;this.cmpEl;if(e instanceof Common.UI.MenuItem||(e=new Common.UI.MenuItem(_.extend({tagName:"li",template:i.itemTemplate},e))),t<0||t>=i.items.length?i.items.push(e):i.items.splice(t,0,e),this.rendered){var n=this.menuRoot;n&&(t<0?n.append(e.render().el):0===t?n.prepend(e.render().el):n.children("li:nth-child("+(t+1)+")").before(e.render().el),e.on("click",_.bind(i.onItemClick,i)),e.on("toggle",_.bind(i.onItemToggle,i)))}},addItem:function(t){this.insertItem(-1,t)},removeItem:function(t){var e=this,i=e.items.indexOf(t);i>-1&&(e.items.splice(i,1),t.off("click").off("toggle"),t.remove())},removeItems:function(t,e){if(!(t>this.items.length-1)){t+e>this.items.length&&(e=this.items.length-t);for(var i=t;i<t+e;i++)this.items[i].off("click").off("toggle"),this.items[i].remove();this.items.splice(t,e)}},removeAll:function(){var t=this;_.each(t.items,function(t){t.off("click").off("toggle"),t.remove()}),t.items=[]},onBeforeShowMenu:function(t){Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){if(this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget){var e=this.menuRoot;if(void 0===this.wheelSpeed){var i=e.find("> li:first"),n=i.length?i.outerHeight():1;this.wheelSpeed=Math.min(Math.floor(e.height()/n)*n/10,20)}this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed});var o=e.find("> li .checked");if(o.length){var s=o.position().top,n=o.outerHeight(),r=e.outerHeight();if(s<0||s+n>r){var a=e.scrollTop()+s+(n-r)/2;a=Math.floor(a/n)*n,e.scrollTop(a)}setTimeout(function(){o.focus()},1)}}this._search={}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(this.trigger("keydown:before",this,t),!t.isDefaultPrevented())if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(e.length<=0&&(e=$(t.target).parent().find("li .dataview")),e.length>0&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else if(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN)this.fromKeyDown=!0;else if(t.keyCode==Common.UI.Keys.ESC);else if(this.search&&t.keyCode>64&&t.keyCode<91&&t.key){var i=this;if(clearTimeout(this._search.timer),this._search.timer=setTimeout(function(){i._search={}},1e3),!this._search.text&&(this._search.text=""),!this._search.char&&(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index){var n=this.menuRoot.find("> li").find("> a");this._search.index=n.index(n.filter(":focus"))}this.selectCandidate()}},onBeforeKeydownMenu:function(t){if(!t.isDefaultPrevented()&&this.outerMenu&&this.outerMenu.menu&&(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN)){var e=this.menuRoot.find("> li").find("> a"),i=e.index(e.filter(":focus"));(t.keyCode==Common.UI.Keys.UP&&0==i||t.keyCode==Common.UI.Keys.DOWN&&i==e.length-1)&&(this.outerMenu.menu.focusOuter(t,this.outerMenu.index),t.preventDefault(),t.stopPropagation())}},selectCandidate:function(){for(var t,e,i=this._search.index&&-1!=this._search.index?this._search.index:0,n=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),o=n.test(this.items[i].caption),s=0;s<this.items.length;s++){var r=this.items[s];if(n.test(r.caption)){if(!t&&(t=r,e=s,!o))break;if(this._search.full&&s==i||s>i){t=r,e=s;break}}}if(t){this._search.index=e;var r=t.cmpEl.find("a");if(this.scroller){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed});var a=r.position().top,l=r.outerHeight(),c=this.menuRoot.outerHeight();if(a<0||a+l>c){var h=this.menuRoot.scrollTop()+a;h=Math.floor(h/l)*l,this.menuRoot.scrollTop(h)}}r.focus()}},onBeforeKeyDown:function(t,e){if(e.keyCode==Common.UI.Keys.RETURN){var i=$(e.target).closest("li");i.length>0&&(e.preventDefault(),e.stopPropagation(),i.click()),Common.UI.Menu.Manager.hideAll()}else if("after.bs.dropdown"!==e.namespace&&(e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.UP)){if(this.menuRoot.length<1||$(e.target).closest("ul[role=menu]").get(0)!==this.menuRoot.get(0))return;var n=this.findInnerMenu(e.keyCode);n&&n.focusInner&&(e.preventDefault(),e.stopPropagation(),_.delay(function(){n.focusInner(e)},10))}},setInnerMenu:function(t){!this.options.innerMenus&&t&&(this.options.innerMenus=t,this.rendered&&this.on("keydown:before",_.bind(this.onBeforeKeyDown,this)))},findInnerMenu:function(t,e,i){if(this.options.innerMenus){var n=$("> li",this.menuRoot),o=$("> li:not(.divider):not(.disabled):visible",this.menuRoot),s=o.length;if(s)for(var r=0;r<s;){var a=void 0!==e?o.index(n.eq(e)):o.index(o.find("> a").filter(":focus").parent()),l=t==Common.UI.Keys.DOWN?a<s-1?a+1:0:a>0?a-1:s-1,c=o.eq(l);e=n.index(c);for(var h=0;h<this.options.innerMenus.length;h++){var d=this.options.innerMenus[h];if(d&&d.menu&&d.index==e)return d.menu}if(c.find("> a").length>0)return i?c:void 0;r++}}},focusInner:function(t){t.keyCode==Common.UI.Keys.UP?this.items[this.items.length-1].cmpEl.find("> a").focus():this.items[0].cmpEl.find("> a").focus()},focusOuter:function(t,e){var i=this.findInnerMenu(t.keyCode,e,!0);if(i&&i.focusInner)_.delay(function(){i.focusInner(t)},10);else if(i)i.find("> a").focus();else{var n=$("> li:not(.divider):not(.disabled):visible",this.menuRoot).find("> a"),o=n.length;o&&n.eq(t.keyCode==Common.UI.Keys.UP?e<0?o-1:e:e>=o-1?0:e+1).focus()}},onItemClick:function(t,e){if(t.menu||(this.isOver=!1),t.options.stopPropagation){e.stopPropagation();var i=this;return void _.delay(function(){i.$el.parent().parent().find("[data-toggle=dropdown]").focus()},10)}this.trigger("item:click",this,t,e)},onItemToggle:function(t,e,i){this.trigger("item:toggle",this,t,e,i)},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i=this.menuRoot,n=this.menuAlignEl||i.parent(),o=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),s=n.offset(),r=Common.Utils.innerWidth()-10,a=Common.Utils.innerHeight()-10,l=i.outerWidth(),c=i.outerHeight(),h=n.outerWidth(),d=n.outerHeight(),u={tl:[0,0],bl:[0,c],tr:[l,0],br:[l,c]},p={tl:[0,0],tr:[h,0],bl:[0,d],br:[h,d]},m=s.left-u[o[1]][0]+p[o[2]][0]+this.offset[0],f=s.top-u[o[1]][1]+p[o[2]][1]+this.offset[1];if(m+l>r&&(m=n.is("li.dropdown-submenu")?s.left-l+2:r-l),m<0&&(m=0),this.options.restoreHeightAndTop){var g=Common.Utils.croppedGeometry();a=g.height-10,i.css("max-height","none"),c=i.outerHeight(),f+c>a+g.top&&(f=a-c),f<g.top&&(f=g.top),f+c>a+g.top&&(i.css("max-height",a-f+"px"),!this.scroller&&(this.scroller=new Common.UI.Scroller({el:this.$el.find("> .dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0),this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible})}else if(this.options.restoreHeight)"number"==typeof this.options.restoreHeight&&(f+c>a?(i.css("max-height",a-f+"px"),!this.scroller&&(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0):f+c<a&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(a-f,this.options.restoreHeight)+"px"),this.wheelSpeed=void 0));else{var g=Common.Utils.croppedGeometry();a=g.height-10,f+c>a+g.top&&(t&&"string"==typeof t?(o=t.match(/^([a-z]+)-([a-z]+)/),f=s.top-u[o[1]][1]+p[o[2]][1]+this.offset[1]+(e||0)):f=a-c),f<g.top&&(f=g.top)}if(this.options.additionalAlign)this.options.additionalAlign.call(this,i,m,f);else{var v={left:m,top:f};c<a||(v["margin-top"]=0),i.css(v)}},getChecked:function(){for(var t=0;t<this.items.length;t++){var e=this.items[t];if(e.isChecked&&e.isChecked())return e}},clearAll:function(){_.each(this.items,function(t){t.setChecked&&t.setChecked(!1,!0)})}}),{Manager:function(){return t}()})}(),Common.UI.MenuSimple=Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,scrollAlwaysVisible:!0},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>","</ul>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||_.template(['<a id="<%= id %>" <% if(typeof style !== "undefined") { %> style="<%= style %>" <% } %>','<% if(typeof canFocused !== "undefined") { %> tabindex="-1" type="menuitem" <% } %>','<% if(typeof stopPropagation !== "undefined") { %> data-stopPropagation="true" <% } %>','class="<% if (checked) { %> checked <% } %>" >','<% if (typeof iconCls !== "undefined") { %>','<span class="menu-item-icon <%= iconCls %>"></span>',"<% } %>","<%= caption %>","</a>"].join("")),this.rendered=!1,this.items=this.options.items||[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight?this.options.maxHeight:1e5,!this.options.maxHeight&&(this.options.maxHeight=this.options.restoreHeight)),this.options.cyclic||(this.options.cls+=" no-cyclic"),this.options.el&&this.render(),Common.UI.Menu.Manager.register(this)},remove:function(){Common.UI.Menu.Manager.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this;this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t&&this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({items:e.items,itemTemplate:e.itemTemplate,options:e.options})),t?t.append(this.cmpEl):this.$el.append(this.cmpEl));var i=this.cmpEl.parent(),n="menu"===i.attr("role")?i:i.find("[role=menu]");return this.menuRoot=n,n&&(e.rendered||(n.on("click","li",_.bind(e.onItemClick,e)),n.on("mousedown","li",_.bind(e.onItemMouseDown,e))),this.options.maxHeight&&(n.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),n.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=n.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),n.hover(function(t){e.isOver=!0},function(t){e.isOver=!1})),this.rendered=!0,this.trigger("render:after",this),this},resetItems:function(t){this.items=t||[],this.$items=null;var e=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>"].join(""));this.cmpEl&&this.cmpEl.html(e({items:this.items,itemTemplate:this.itemTemplate,options:this.options}))},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},onItemClick:function(t){if(1!=t.which&&void 0!==t.which)return!1;var e=$(t.currentTarget).closest("li").index(),i=e>=0?this.items[e]:null;if(i){if(i.disabled)return!1;if(i.checkable&&!i.checked&&this.setChecked(e,!i.checked),this.isOver=!1,i.stopPropagation){t.stopPropagation();var n=this;return void _.delay(function(){n.$el.parent().parent().find("[data-toggle=dropdown]").focus()},10)}this.trigger("item:click",this,i,t)}},onItemMouseDown:function(t){if(1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},setChecked:function(t,e,i){this.toggle(t,e,i)},toggle:function(t,e,i){var n=!!e,o=this.items[t];if(this.clearAll(),o&&o.checkable){if(o.checked=n,this.rendered){var s=o.el||this.cmpEl.find("#"+o.id);s&&(s.toggleClass("checked",o.checked),_.isEmpty(o.iconCls)||s.css("background-image","none"))}i||this.trigger("item:toggle",this,o,n)}},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},onBeforeShowMenu:function(t){Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){if(this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});var e=this.menuRoot,i=e.find("> li .checked");if(i.length){var n=i.position().top,o=i.outerHeight(),s=e.outerHeight();if(n<0||n+o>s){var r=e.scrollTop()+n+(o-s)/2;r=Math.floor(r/o)*o,e.scrollTop(r)}setTimeout(function(){i.focus()},1)}}if(this._search={},this.search&&!this.$items){var a=this;this.$items=this.menuRoot.find("> li").find("> a"),_.each(this.$items,function(t,e){a.items[e].el=$(t)})}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(e.length<=0&&(e=$(t.target).parent().find("li .dataview")),e.length>0&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else if(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN)this.fromKeyDown=!0;else if(t.keyCode==Common.UI.Keys.ESC);else if(this.search&&t.keyCode>64&&t.keyCode<91&&t.key){var i=this;clearTimeout(this._search.timer),this._search.timer=setTimeout(function(){i._search={}},1e3),!this._search.text&&(this._search.text=""),!this._search.char&&(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(this._search.index=this.$items.index(this.$items.filter(":focus"))),this.selectCandidate()}},selectCandidate:function(){for(var t,e,i=this._search.index&&-1!=this._search.index?this._search.index:0,n=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),o=n.test(this.items[i].caption),s=0;s<this.items.length;s++){var r=this.items[s];if(n.test(r.caption)){if(!t&&(t=r,e=s,!o))break;if(this._search.full&&s==i||s>i){t=r,e=s;break}}}if(t){this._search.index=e;var r=t.el;if(this.scroller){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});var a=r.position().top,l=r.outerHeight(),c=this.menuRoot.outerHeight();if(a<0||a+l>c){var h=this.menuRoot.scrollTop()+a;h=Math.floor(h/l)*l,this.menuRoot.scrollTop(h)}}r.focus()}},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i=this.menuRoot,n=this.menuAlignEl||i.parent(),o=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),s=n.offset(),r=Common.Utils.innerWidth(),a=Common.Utils.innerHeight()-10,l=i.outerWidth(),c=i.outerHeight(),h=n.outerWidth(),d=n.outerHeight(),u={tl:[0,0],bl:[0,c],tr:[l,0],br:[l,c]},p={tl:[0,0],tr:[h,0],bl:[0,d],br:[h,d]},m=s.left-u[o[1]][0]+p[o[2]][0]+this.offset[0],f=s.top-u[o[1]][1]+p[o[2]][1]+this.offset[1];m+l>r&&(m=n.is("li.dropdown-submenu")?s.left-l+2:r-l),this.options.restoreHeight?"number"==typeof this.options.restoreHeight&&(f+c>a?(i.css("max-height",a-f+"px"),!this.scroller&&(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible}))):f+c<a&&i.height()<this.options.restoreHeight&&i.css("max-height",Math.min(a-f,this.options.restoreHeight)+"px")):(f+c>a&&(t&&"string"==typeof t?(o=t.match(/^([a-z]+)-([a-z]+)/),f=s.top-u[o[1]][1]+p[o[2]][1]+this.offset[1]+(e||0)):f=a-c),f<0&&(f=0)),this.options.additionalAlign?this.options.additionalAlign.call(this,i,m,f):i.css({left:Math.ceil(m),top:Math.ceil(f)})},clearAll:function(){this.cmpEl&&this.cmpEl.find("li > a.checked").removeClass("checked"),_.each(this.items,function(t){t.checked=!1})}})}),define("documenteditor/forms/app/view/ApplicationView",["jquery","underscore","backbone","common/main/lib/util/utils","common/main/lib/component/InputField","common/main/lib/component/Button","common/main/lib/component/Menu"],function(t,e,i){"use strict";DE.Views.ApplicationView=i.View.extend(e.extend({render:function(){return this.btnOptions=new Common.UI.Button({cls:"btn-toolbar no-caret",iconCls:"svg-icon more-vertical",menu:new Common.UI.Menu({cls:"shifted-right",items:[{caption:this.txtDownload,value:"download",iconCls:"mi-icon svg-icon download"},{caption:this.txtDownloadDocx,value:"download-docx",iconCls:"mi-icon svg-icon download"},{caption:this.txtDownloadPdf,value:"download-pdf",iconCls:"mi-icon"},{caption:this.txtPrint,value:"print",iconCls:"mi-icon svg-icon print"},{caption:"--"},{caption:this.txtSearch,value:"search",iconCls:"mi-icon svg-icon search"},{caption:"--"},{caption:this.txtTheme,value:"theme",iconCls:"mi-icon",menu:this.mnuThemes=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[]})},{caption:this.textZoom,value:"zoomn",conCls:"mi-icon",menu:this.mnuZoom=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:this.textFitToPage,value:"zoom:page",toggleGroup:"view-zoom",checkable:!0},{caption:this.textFitToWidth,value:"zoom:width",toggleGroup:"view-zoom",checkable:!0
},new Common.UI.MenuItem({template:e.template(['<div id="id-menu-zoom" class="menu-zoom" style="height: 26px;" ',"<% if(!_.isUndefined(options.stopPropagation)) { %>",'data-stopPropagation="true"',"<% } %>",">",'<label class="title">'+this.textZoom+"</label>",'<button id="id-menu-zoom-in" type="button" style="float:right; margin: 2px 5px 0 0;" class="btn btn-toolbar"><i class="mi-icon svg-icon zoom-in">&nbsp;</i></button>','<label class="zoom"><%= options.value %>%</label>','<button id="id-menu-zoom-out" type="button" style="float:right; margin-top: 2px;" class="btn btn-toolbar"><i class="mi-icon svg-icon zoom-out">&nbsp;</i></button>',"</div>"].join("")),stopPropagation:!0,value:30})]})},{caption:"--"},{caption:this.txtShare,value:"share",iconCls:"mi-icon svg-icon share"},{caption:this.txtFileLocation,value:"close",iconCls:"mi-icon svg-icon go-to-location"},{caption:"--"},{caption:this.txtEmbed,value:"embed",iconCls:"mi-icon svg-icon embed"},{caption:this.txtFullScreen,value:"fullscr",iconCls:"mi-icon svg-icon fullscr"}]})}),this.btnOptions.render(t("#box-tools")),this.btnClear=new Common.UI.Button({cls:"btn-toolbar",iconCls:"svg-icon clear-style",caption:this.textClear}),this.btnClear.render(t("#id-btn-clear-fields")),this.btnNext=new Common.UI.Button({cls:"btn-toolbar",iconCls:"svg-icon arrow-down",caption:this.textNext}),this.btnNext.render(t("#id-btn-next-field")),this.btnPrev=new Common.UI.Button({cls:"btn-toolbar",iconCls:"svg-icon arrow-up"}),this.btnPrev.render(t("#id-btn-prev-field")),this.btnUndo=new Common.UI.Button({cls:"btn-toolbar",iconCls:"svg-icon undo",hint:this.tipUndo+Common.Utils.String.platformKey("Ctrl+Z")}),this.btnUndo.render(t("#id-btn-undo")),this.btnRedo=new Common.UI.Button({cls:"btn-toolbar",iconCls:"svg-icon redo",hint:this.tipRedo+Common.Utils.String.platformKey("Ctrl+Y")}),this.btnRedo.render(t("#id-btn-redo")),this.btnSubmit=new Common.UI.Button({cls:"btn-text-default colored margin-left-small margin-right-small",caption:this.textSubmit}),this.btnSubmit.render(t("#id-submit-group")),this.btnDownload=new Common.UI.Button({cls:"btn-text-default colored margin-left-small margin-right-small",caption:this.txtDownload,hint:this.txtDownloadPdf}),this.btnDownload.render(t("#id-download-group")),this.txtGoToPage=new Common.UI.InputField({el:t("#page-number"),cls:"masked",allowBlank:!0,style:"width: 35px;",value:"1",maskExp:/[0-9]/}),this},getContextMenu:function(){return new Common.UI.Menu({cls:"shifted-right",items:[{caption:this.textUndo,value:"undo",iconCls:"mi-icon svg-icon undo"},{caption:this.textRedo,value:"redo",iconCls:"mi-icon svg-icon redo"},{caption:"--"},{caption:this.textClearField,value:"clear",iconCls:"mi-icon svg-icon clear-style"},{caption:"--"},{caption:this.textCut,value:"cut",iconCls:"mi-icon svg-icon cut"},{caption:this.textCopy,value:"copy",iconCls:"mi-icon svg-icon copy"},{caption:this.textPaste,value:"paste",iconCls:"mi-icon svg-icon paste"}]})},txtDownload:"Download",txtPrint:"Print",txtShare:"Share",txtEmbed:"Embed",txtFullScreen:"Full Screen",txtFileLocation:"Open file location",txtDownloadDocx:"Download as docx",txtDownloadPdf:"Download as pdf",textNext:"Next Field",textClear:"Clear All Fields",textSubmit:"Submit",txtTheme:"Interface theme",textCut:"Cut",textCopy:"Copy",textPaste:"Paste",textPrintSel:"Print Selection",txtDarkMode:"Dark mode",textUndo:"Undo",textRedo:"Redo",textZoom:"Zoom",textFitToPage:"Fit to Page",textFitToWidth:"Fit to Width",txtSearch:"Search",tipUndo:"Undo",tipRedo:"Redo",textClearField:"Clear field"},DE.Views.ApplicationView||{}))}),define("documenteditor/forms/app/controller/ApplicationController",["core","irregularstack","gateway","common/main/lib/component/Window","common/main/lib/component/LoadMask","common/main/lib/component/Tooltip","common/main/lib/component/SynchronizeTip","common/main/lib/component/DataView","common/main/lib/component/Calendar","common/main/lib/util/LocalStorage","common/main/lib/util/Shortcuts","common/main/lib/view/CopyWarningDialog","common/main/lib/view/ImageFromUrlDialog","common/main/lib/view/SelectFileDlg","common/main/lib/view/SaveAsDlg","common/main/lib/view/OpenDialog","common/forms/lib/view/modals","documenteditor/forms/app/view/ApplicationView"],function(t){"use strict";var e,i,n,o=0,s=null,r=!1,a=0,l=[0,-10];DE.Controllers.ApplicationController=Backbone.Controller.extend(_.assign({views:["ApplicationView"],initialize:function(){},onLaunch:function(){var t=this;if(!Common.Utils.isBrowserSupported())return Common.Utils.showBrowserRestriction(),$("#editor_sdk").hide().remove(),$("#toolbar").hide().remove(),void Common.Gateway.reportError(void 0,this.unsupportedBrowserErrorText);this.stackLongActions=new Common.IrregularStack({strongCompare:function(t,e){return t.id===e.id&&t.type===e.type},weakCompare:function(t,e){return t.type===e.type}}),this._state={isDisconnected:!1,licenseType:!1,isDocModified:!1},this.view=this.createView("ApplicationView").render(),window.flat_desine=!0;var e={"Your text here":this.txtArt,"Choose an item":this.txtChoose,"Enter a date":this.txtEnterDate,"Click to load image":this.txtClickToLoad};this.api=new Asc.asc_docs_api({"id-view":"editor_sdk",embedded:!0,translate:e}),Common.UI.Themes.init(this.api),$(window).on("resize",this.onDocumentResize.bind(this)),this.boxSdk=$("#editor_sdk"),this.boxSdk.on("click",function(e){"canvas"==e.target.localName&&(t._preventClick?t._preventClick=!1:t.boxSdk.focus())}),this.boxSdk.on("mousedown",function(t){"canvas"==t.target.localName&&Common.UI.Menu.Manager.hideAll()}),this.editorConfig={},this.embedConfig={},this.appOptions={},this.internalFormObj=null,this.api&&(this.api.asc_registerCallback("asc_onError",this.onError.bind(this)),this.api.asc_registerCallback("asc_onDocumentContentReady",this.onDocumentContentReady.bind(this)),this.api.asc_registerCallback("asc_onOpenDocumentProgress",this.onOpenDocument.bind(this)),this.api.asc_registerCallback("asc_onDocumentUpdateVersion",this.onUpdateVersion.bind(this)),this.api.asc_registerCallback("asc_onServerVersion",this.onServerVersion.bind(this)),this.api.asc_registerCallback("asc_onAdvancedOptions",this.onAdvancedOptions.bind(this)),this.api.asc_registerCallback("asc_onCountPages",this.onCountPages.bind(this)),this.api.asc_registerCallback("asc_onCurrentPage",this.onCurrentPage.bind(this)),this.api.asc_registerCallback("asc_onDocumentModifiedChanged",_.bind(this.onDocumentModifiedChanged,this)),this.api.asc_registerCallback("asc_onZoomChange",this.onApiZoomChange.bind(this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiServerDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiServerDisconnect,this)),Common.Gateway.on("init",this.loadConfig.bind(this)),Common.Gateway.on("opendocument",this.loadDocument.bind(this)),Common.Gateway.on("showmessage",this.onExternalMessage.bind(this)),Common.NotificationCenter.on("showmessage",this.onExternalMessage.bind(this)),Common.Gateway.appReady()),Common.NotificationCenter.on({"modal:show":function(){n&&(n.toolTip.hide(),n.isVisible=!1),Common.Utils.ModalWindow.show(),t.api.asc_enableKeyEvents(!1)},"modal:close":function(e){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||t.api.asc_enableKeyEvents(!0)},"modal:hide":function(e){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||t.api.asc_enableKeyEvents(!0)},"dataview:blur":function(e){Common.Utils.ModalWindow.isVisible()||t.api.asc_enableKeyEvents(!0)},"menu:hide":function(e,i){Common.Utils.ModalWindow.isVisible()||i||t.api.asc_enableKeyEvents(!0)}}),$(document.body).on("blur","input, textarea",function(e){Common.Utils.ModalWindow.isVisible()||/area_id/.test(e.target.id)||t.api.asc_enableKeyEvents(!0)}),window.onbeforeunload=_.bind(this.onBeforeUnload,this),this.warnNoLicense=this.warnNoLicense.replace(/%1/g,"ONLYOFFICE"),this.warnNoLicenseUsers=this.warnNoLicenseUsers.replace(/%1/g,"ONLYOFFICE"),this.textNoLicenseTitle=this.textNoLicenseTitle.replace(/%1/g,"ONLYOFFICE"),this.warnLicenseExceeded=this.warnLicenseExceeded.replace(/%1/g,"ONLYOFFICE"),this.warnLicenseUsersExceeded=this.warnLicenseUsersExceeded.replace(/%1/g,"ONLYOFFICE")},onDocumentResize:function(){this.api&&this.api.Resize(),a=$("body").width()},onBeforeUnload:function(){Common.localStorage.save()},onError:function(t,e,n){if(t==Asc.c_oAscError.ID.LoadingScriptError)return this.showTips([this.scriptLoadError]),void(this.tooltip&&this.tooltip.getBSTip().$tip.css("z-index",1e4));this.hidePreloader(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-256);var o={closable:!0};switch(t){case Asc.c_oAscError.ID.Unknown:o.msg=this.unknownErrorText;break;case Asc.c_oAscError.ID.ConvertationTimeout:o.msg=this.convertationTimeoutText;break;case Asc.c_oAscError.ID.ConvertationError:o.msg=this.convertationErrorText;break;case Asc.c_oAscError.ID.ConvertationOpenError:o.msg=this.openErrorText;break;case Asc.c_oAscError.ID.DownloadError:o.msg=this.downloadErrorText;break;case Asc.c_oAscError.ID.UplImageSize:o.msg=this.uploadImageSizeMessage;break;case Asc.c_oAscError.ID.UplImageExt:o.msg=this.uploadImageExtMessage;break;case Asc.c_oAscError.ID.ConvertationPassword:o.msg=this.errorFilePassProtect;break;case Asc.c_oAscError.ID.UserDrop:o.msg=this.errorUserDrop;break;case Asc.c_oAscError.ID.ConvertationOpenLimitError:o.msg=this.errorFileSizeExceed;break;case Asc.c_oAscError.ID.UpdateVersion:o.msg=this.errorUpdateVersionOnDisconnect,o.maxwidth=600;break;case Asc.c_oAscError.ID.AccessDeny:o.msg=this.errorAccessDeny;break;case Asc.c_oAscError.ID.Submit:o.msg=this.errorSubmit,i=!0,this.submitedTooltip&&this.submitedTooltip.hide();break;case Asc.c_oAscError.ID.EditingError:o.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.errorEditingSaveas:this.errorEditingDownloadas;break;case Asc.c_oAscError.ID.ForceSaveButton:case Asc.c_oAscError.ID.ForceSaveTimeout:o.msg=this.errorForceSave,o.maxwidth=600;break;case Asc.c_oAscError.ID.LoadingFontError:o.msg=this.errorLoadingFont;break;case Asc.c_oAscError.ID.Warning:o.msg=this.errorConnectToServer,o.closable=!1;break;case Asc.c_oAscError.ID.VKeyEncrypt:o.msg=this.errorToken;break;case Asc.c_oAscError.ID.KeyExpire:o.msg=this.errorTokenExpire;break;case Asc.c_oAscError.ID.CoAuthoringDisconnect:o.msg=this.errorViewerDisconnect;break;case Asc.c_oAscError.ID.SessionAbsolute:o.msg=this.errorSessionAbsolute;break;case Asc.c_oAscError.ID.SessionIdle:o.msg=this.errorSessionIdle;break;case Asc.c_oAscError.ID.SessionToken:o.msg=this.errorSessionToken;break;case Asc.c_oAscError.ID.UplImageUrl:o.msg=this.errorBadImageUrl;break;case Asc.c_oAscError.ID.DataEncrypted:o.msg=this.errorDataEncrypted;break;case Asc.c_oAscError.ID.ConvertationSaveError:o.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.saveErrorTextDesktop:this.saveErrorText;break;case Asc.c_oAscError.ID.TextFormWrongFormat:o.msg=this.errorTextFormWrongFormat;break;case Asc.c_oAscError.ID.ConvertationOpenFormat:o.maxwidth=600,o.msg="pdf"===n?this.errorInconsistentExtPdf.replace("%1",this.document.fileType||""):"docx"===n?this.errorInconsistentExtDocx.replace("%1",this.document.fileType||""):"xlsx"===n?this.errorInconsistentExtXlsx.replace("%1",this.document.fileType||""):"pptx"===n?this.errorInconsistentExtPptx.replace("%1",this.document.fileType||""):this.errorInconsistentExt;break;default:o.msg="string"==typeof t?t:this.errorDefaultMessage.replace("%1",t)}e==Asc.c_oAscError.Level.Critical?(Common.Gateway.reportError(t,o.msg),o.title=this.criticalErrorTitle,o.iconCls="error",o.closable=!1,o.callback=_.bind(function(t){window.location.reload()},this),t==Asc.c_oAscError.ID.DataEncrypted&&(this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("api:disconnect"))):(Common.Gateway.reportWarning(t,o.msg),o.title=this.notcriticalErrorTitle,o.iconCls="warn",o.buttons=["ok"],o.callback=_.bind(function(e){if(t==Asc.c_oAscError.ID.Warning&&"ok"==e&&this.appOptions.canDownload)if(Common.UI.Menu.Manager.hideAll(),this.appOptions.isDesktopApp&&this.appOptions.isOffline)this.api.asc_DownloadAs();else{var i=this;setTimeout(function(){$("button",i.view.btnOptions.cmpEl).click()},10)}else t==Asc.c_oAscError.ID.EditingError&&Common.NotificationCenter.trigger("api:disconnect",!0)},this)),(!Common.Utils.ModalWindow.isVisible()||$(".asc-window.modal.alert[data-value="+t+"]").length<1)&&Common.UI.alert(o).$window.attr("data-value",t),void 0!==t&&Common.component.Analytics.trackEvent("Internal Error",t.toString())},hidePreloader:function(){$("#loading-mask").fadeOut("slow")},onOpenDocument:function(t){var e=document.getElementById("loadmask-text"),i=(t.asc_getCurrentFont()+t.asc_getCurrentImage())/(t.asc_getFontsCount()+t.asc_getImagesCount());i=this.textLoadingDocument+": "+Common.Utils.String.fixedDigits(Math.min(Math.round(100*i),100),3,"  ")+"%",e?e.innerHTML=i:this.loadMask&&this.loadMask.setTitle(i)},onCountPages:function(t){o!==t&&(o=t,$("#pages").text(this.textOf+" "+t))},onCurrentPage:function(t){this.view.txtGoToPage.setValue(t+1)},updateWindowTitle:function(t){var e=this.api.isDocumentModified();(this._state.isDocModified!==e||t)&&(this._isDocReady&&this._state.isDocModified!==e&&Common.Gateway.setDocumentModified(e),this._state.isDocModified=e)},onDocumentModifiedChanged:function(){var t=this.api.asc_isDocumentCanSave();this._state.isDocModified!==t&&this._isDocReady&&Common.Gateway.setDocumentModified(this.api.isDocumentModified()),this.updateWindowTitle()},loadConfig:function(t){this.editorConfig=$.extend(this.editorConfig,t.config),this.embedConfig=$.extend(this.embedConfig,t.config.embedded),$("#toolbar").addClass("top"),this.boxSdk.addClass("top"),l[1]=40,this.appOptions.customization=this.editorConfig.customization,this.appOptions.canRenameAnonymous=!("object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&!1===this.appOptions.customization.anonymous.request),this.appOptions.guestName="object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&"string"==typeof this.appOptions.customization.anonymous.label&&""!==this.appOptions.customization.anonymous.label.trim()?Common.Utils.String.htmlEncode(this.appOptions.customization.anonymous.label):this.textGuest;var e;this.appOptions.canRenameAnonymous&&(e=Common.localStorage.getItem("guest-username"),Common.Utils.InternalSettings.set("guest-username",e),Common.Utils.InternalSettings.set("save-guest-username",!!e)),this.editorConfig.user=this.appOptions.user=Common.Utils.fillUserInfo(this.editorConfig.user,this.editorConfig.lang,e?e+" ("+this.appOptions.guestName+")":this.textAnonymous,Common.localStorage.getItem("guest-id")||"uid-"+Date.now()),this.appOptions.user.anonymous&&Common.localStorage.setItem("guest-id",this.appOptions.user.id),this.appOptions.canRequestClose=this.editorConfig.canRequestClose,this.appOptions.canBackToFolder=!1!==this.editorConfig.canBackToFolder&&"object"==typeof this.editorConfig.customization&&"object"==typeof this.editorConfig.customization.goback&&(!_.isEmpty(this.editorConfig.customization.goback.url)||this.editorConfig.customization.goback.requestClose&&this.appOptions.canRequestClose),this.appOptions.canRequestInsertImage=this.editorConfig.canRequestInsertImage,this.appOptions.fileChoiceUrl=this.editorConfig.fileChoiceUrl,this.appOptions.saveAsUrl=this.editorConfig.saveAsUrl,this.appOptions.canRequestSaveAs=this.editorConfig.canRequestSaveAs,this.appOptions.isDesktopApp="desktop"==this.editorConfig.targetApp,this.appOptions.lang=this.editorConfig.lang,this.appOptions.canPlugins=!1},onExternalMessage:function(t){t&&t.msg&&(t.msg=t.msg.toString(),this.showTips([t.msg.charAt(0).toUpperCase()+t.msg.substring(1)]),Common.component.Analytics.trackEvent("External Error"))},showTips:function(t){function e(){var e=t.shift();e&&(e+="\n"+i.textCloseTip,n.setTitle(e),n.show())}var i=this;if(t.length){"object"!=typeof t&&(t=[t]),this.tooltip||(this.tooltip=new Common.UI.Tooltip({owner:$("#toolbar"),hideonclick:!0,placement:"bottom",cls:"main-info",offset:30}));var n=this.tooltip;n.on("tooltip:hide",function(){setTimeout(e,300)}),e()}},loadDocument:function(t){this.permissions={},this.document=t.doc;var i={};if(t.doc){this.permissions=$.extend(this.permissions,t.doc.permissions);var n=$.extend({},t.doc.options,this.editorConfig.actionLink||{}),o=new Asc.asc_CUserInfo;o.put_Id(this.appOptions.user.id),o.put_FullName(this.appOptions.user.fullname),o.put_IsAnonymousUser(!!this.appOptions.user.anonymous),i=new Asc.asc_CDocInfo,i.put_Id(t.doc.key),i.put_Url(t.doc.url),i.put_DirectUrl(t.doc.directUrl),i.put_Title(t.doc.title),i.put_Format(t.doc.fileType),i.put_VKey(t.doc.vkey),i.put_Options(n),i.put_UserInfo(o),i.put_CallbackUrl(this.editorConfig.callbackUrl),i.put_Token(t.doc.token),i.put_Permissions(t.doc.permissions),i.put_EncryptedInfo(this.editorConfig.encryptionKeys),i.put_Lang(this.editorConfig.lang),i.put_Mode(this.editorConfig.mode);var s=!this.editorConfig.customization||!1!==this.editorConfig.customization.macros;i.asc_putIsEnabledMacroses(!!s),s=!this.editorConfig.customization||!1!==this.editorConfig.customization.plugins,i.asc_putIsEnabledPlugins(!!s);var r=/^(?:(pdf|djvu|xps|oxps))$/.exec(t.doc.fileType);r&&"string"==typeof r[1]&&(this.permissions.edit=this.permissions.review=!1)}e=$("#title-doc-name"),t.doc&&(e.text(t.doc.title||""),this.embedConfig.docTitle=t.doc.title),this.api.asc_registerCallback("asc_onGetEditorPermissions",_.bind(this.onEditorPermissions,this)),this.api.asc_registerCallback("asc_onRunAutostartMacroses",_.bind(this.onRunAutostartMacroses,this)),this.api.asc_registerCallback("asc_onLicenseChanged",_.bind(this.onLicenseChanged,this)),this.api.asc_setDocInfo(i),this.api.asc_getEditorPermissions(this.editorConfig.licenseUrl,this.editorConfig.customerId),this.api.asc_enableKeyEvents(!0),Common.Analytics.trackEvent("Load","Start")},onRunAutostartMacroses:function(){this.editorConfig.customization&&!1===this.editorConfig.customization.macros||this.api.asc_runAutostartMacroses()},onEditorPermissions:function(t){var e=t.asc_getLicenseType();if(Asc.c_oLicenseResult.Expired===e||Asc.c_oLicenseResult.Error===e||Asc.c_oLicenseResult.ExpiredTrial===e)return void Common.UI.warning({title:this.titleLicenseExp,msg:this.warnLicenseExp,buttons:[],closable:!1});if(Asc.c_oLicenseResult.ExpiredLimited===e&&(this._state.licenseType=e),!this.onServerVersion(t.asc_getBuildVersion())){this.permissions.review=void 0===this.permissions.review?!1!==this.permissions.edit:this.permissions.review,t.asc_getRights()!==Asc.c_oRights.Edit&&(this.permissions.edit=this.permissions.review=!1),this.appOptions.isOffline=this.api.asc_isOffline(),this.appOptions.trialMode=t.asc_getLicenseMode(),this.appOptions.isBeta=t.asc_getIsBeta(),this.appOptions.canLicense=e===Asc.c_oLicenseResult.Success||e===Asc.c_oLicenseResult.SuccessLimit,this.appOptions.canSubmitForms=this.appOptions.canLicense&&"object"==typeof this.editorConfig.customization&&!!this.editorConfig.customization.submitForm&&!this.appOptions.isOffline;var i=/^(?:(oform))$/.exec(this.document.fileType);this.appOptions.isOFORM=!(!i||"string"!=typeof i[1]),this.appOptions.canFillForms=this.appOptions.canLicense&&this.appOptions.isOFORM&&(void 0===this.permissions.fillForms?!1!==this.permissions.edit:this.permissions.fillForms)&&"view"!==this.editorConfig.mode,this.api.asc_setViewMode(!this.appOptions.canFillForms),this.appOptions.canBranding=t.asc_getCustomization(),this.appOptions.canBranding&&this.setBranding(this.appOptions.customization),this.appOptions.canDownload=!1!==this.permissions.download,this.appOptions.canPrint=!1!==this.permissions.print,this.appOptions.fileKey=this.document.key,AscCommon.UserInfoParser.setParser(!0),AscCommon.UserInfoParser.setCurrentName(this.appOptions.user.fullname),DE.getController("Plugins").setMode(this.appOptions,this.api);var n=this;n.view.btnSubmit.setVisible(this.appOptions.canFillForms&&this.appOptions.canSubmitForms),n.view.btnDownload.setVisible(this.appOptions.canDownload&&this.appOptions.canFillForms&&!this.appOptions.canSubmitForms),(n.appOptions.isOffline||n.appOptions.canRequestSaveAs||n.appOptions.saveAsUrl)&&(n.view.btnDownload.setCaption(n.appOptions.isOffline?n.textSaveAsDesktop:n.textSaveAs),n.view.btnDownload.updateHint("")),this.appOptions.canFillForms?(n.view.btnPrev.on("click",function(){n.api.asc_MoveToFillingForm(!1)}),n.view.btnNext.on("click",function(){n.api.asc_MoveToFillingForm(!0)}),n.view.btnClear.on("click",function(){n.api.asc_ClearAllSpecialForms()}),n.view.btnSubmit.on("click",function(){n.api.asc_SendForm()}),n.view.btnDownload.on("click",function(){n.appOptions.canDownload&&(n.appOptions.isOffline?n.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.PDF)):(n.isFromBtnDownload=n.appOptions.canRequestSaveAs||!!n.appOptions.saveAsUrl,n.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.PDF,n.isFromBtnDownload))))}),n.view.btnUndo.on("click",function(){n.api.Undo(!1)}),n.view.btnRedo.on("click",function(){n.api.Redo(!1)}),this.api.asc_setRestriction(Asc.c_oAscRestrictionType.OnlyForms),this.api.asc_SetFastCollaborative(!0),this.api.asc_setAutoSaveGap(1),this.api.SetCollaborativeMarksShowType(Asc.c_oAscCollaborativeMarksShowType.None)):(n.view.btnPrev.setVisible(!1),n.view.btnNext.setVisible(!1),n.view.btnClear.setVisible(!1),n.view.btnUndo.setVisible(!1),n.view.btnRedo.setVisible(!1),n.view.btnRedo.$el.next().hide()),this.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,-256),this.api.asc_LoadDocument(),this.api.Resize()}},onServerVersion:function(t){return!!this.changeServerVersion||DocsAPI.DocEditor.version()!==t&&!window.compareVersions&&(this.changeServerVersion=!0,Common.UI.warning({title:this.titleServerVersion,msg:this.errorServerVersion,callback:function(){_.defer(function(){Common.Gateway.updateVersion()})}}),!0)},onUpdateVersion:function(t){var e=this;e.needToUpdateVersion=!0,e.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-256),Common.UI.warning({title:this.titleUpdateVersion,msg:this.errorUpdateVersion,callback:function(){_.defer(function(){Common.Gateway.updateVersion(),t&&t.call(e),e.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,-256)})}})},onLicenseChanged:function(t){var e=t.asc_getLicenseType();void 0!==e&&this.appOptions.canFillForms&&(e===Asc.c_oLicenseResult.Connections||e===Asc.c_oLicenseResult.UsersCount||e===Asc.c_oLicenseResult.ConnectionsOS||e===Asc.c_oLicenseResult.UsersCountOS||e===Asc.c_oLicenseResult.SuccessLimit&&0!=(this.appOptions.trialMode&Asc.c_oLicenseMode.Limited))&&(this._state.licenseType=e),this._isDocReady&&this.applyLicense()},applyLicense:function(){if(this._state.licenseType){var t=this._state.licenseType,e=["ok"],i="ok";0==(this.appOptions.trialMode&Asc.c_oLicenseMode.Limited)||t!==Asc.c_oLicenseResult.SuccessLimit&&t!==Asc.c_oLicenseResult.ExpiredLimited&&this.appOptions.permissionsLicense!==Asc.c_oLicenseResult.SuccessLimit?t===Asc.c_oLicenseResult.Connections||t===Asc.c_oLicenseResult.UsersCount?t=t===Asc.c_oLicenseResult.Connections?this.warnLicenseExceeded:this.warnLicenseUsersExceeded:(t=t===Asc.c_oLicenseResult.ConnectionsOS?this.warnNoLicense:this.warnNoLicenseUsers,e=[{value:"buynow",caption:this.textBuyNow},{value:"contact",caption:this.textContactUs}],i="buynow"):t=t===Asc.c_oLicenseResult.ExpiredLimited?this.warnLicenseLimitedNoAccess:this.warnLicenseLimitedRenewed,this._state.licenseType!==Asc.c_oLicenseResult.SuccessLimit&&this.appOptions.canFillForms&&Common.NotificationCenter.trigger("api:disconnect");var n=Common.localStorage.getItem("de-license-warning");n=null!==n?parseInt(n):0;var o=(new Date).getTime();o-n>864e5&&Common.UI.info({maxwidth:500,title:this.textNoLicenseTitle,msg:t,buttons:e,primary:i,callback:function(t){Common.localStorage.setItem("de-license-warning",o),"buynow"==t?window.open("https://www.onlyoffice.com","_blank"):"contact"==t&&window.open("mailto:sales@onlyoffice.com","_blank")}})}},setBranding:function(t){if(t&&t.logo){var e=$("#header-logo");if(t.logo.image||t.logo.imageDark){var i=Common.UI.Themes.isDarkTheme()?t.logo.imageDark||t.logo.image:t.logo.image||t.logo.imageDark;e.html('<img src="'+i+'" style="max-width:100px; max-height:20px;"/>'),e.css({"background-image":"none",width:"auto",height:"auto"})}t.logo.url?e.attr("href",t.logo.url):void 0!==t.logo.url&&(e.removeAttr("href"),e.removeAttr("target"))}},onLongActionBegin:function(t,e){var i={id:e,type:t};this.stackLongActions.push(i),this.setLongActionView(i)},setLongActionView:function(t){var e="";switch(t.id){case Asc.c_oAscAsyncAction.Print:e=this.downloadTextText;break;case Asc.c_oAscAsyncAction.Submit:i=!1,this.submitedTooltip&&this.submitedTooltip.hide(),this.view.btnSubmit.setDisabled(!0),this.view.btnSubmit.cmpEl.css("pointer-events","none");break;case-256:e=this.textLoadingDocument+"           ";break;default:e=this.waitText}t.type==Asc.c_oAscAsyncActionType.BlockInteraction&&(this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:$(document.body)})),this.loadMask.setTitle(e),this.loadMask.show())},onLongActionEnd:function(t,e){var n={id:e,type:t};if(this.stackLongActions.pop(n),this.updateWindowTitle(!0),n=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.Information}),n&&this.setLongActionView(n),n=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.BlockInteraction}),n?this.setLongActionView(n):this.loadMask&&this.loadMask.hide(),e==Asc.c_oAscAsyncAction.Submit&&(this.view.btnSubmit.setDisabled(!1),this.view.btnSubmit.cmpEl.css("pointer-events","auto"),!i)){if(!this.submitedTooltip){var o=this;this.submitedTooltip=$('<div class="submit-tooltip" style="display:none;">'+this.textSubmited+"</div>"),$(document.body).append(this.submitedTooltip),this.submitedTooltip.on("click",function(){o.submitedTooltip.hide()})}this.submitedTooltip.show()}t!=Asc.c_oAscAsyncActionType.BlockInteraction||(e==Asc.c_oAscAsyncAction.LoadDocumentFonts||e==Asc.c_oAscAsyncAction.ApplyChanges||e==Asc.c_oAscAsyncAction.DownloadAs)&&Common.Utils.ModalWindow.isVisible()||this.api.asc_enableKeyEvents(!0)},onAdvancedOptions:function(t,e,i,n){if(!this._openDlg){var o=this;t==Asc.c_oAscAdvancedOptionsID.DRM&&(o._openDlg=new Common.Views.OpenDialog({title:Common.Views.OpenDialog.prototype.txtTitleProtected,closeFile:o.appOptions.canRequestClose,type:Common.Utils.importTextType.DRM,warning:!(o.appOptions.isDesktopApp&&o.appOptions.isOffline)&&"string"==typeof e,warningMsg:e,validatePwd:!!o._isDRM,iconType:"svg",handler:function(e,i){o.isShowOpenDialog=!1,"ok"==e?o.api&&(o.api.asc_setAdvancedOptions(t,i.drmOptions),o.loadMask&&o.loadMask.show()):(Common.Gateway.requestClose(),DE.Controllers.Desktop.requestClose()),o._openDlg=null}}),o._isDRM=!0),o._openDlg&&(this.isShowOpenDialog=!0,this.loadMask&&this.loadMask.hide(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-256),o._openDlg.show())}},onDocMouseMoveStart:function(){n.isHidden=!0},onDocMouseMoveEnd:function(){var t=this;n.isHidden&&n.isVisible&&(n.isVisible=!1,r=!0,n.toolTip.hide(function(){r=!1,s&&t.onDocMouseMove(s),s=null}))},onDocMouseMove:function(t){var e=this;if(t){var i=t.get_Type();if(i==Asc.c_oAscMouseMoveDataTypes.Hyperlink||i==Asc.c_oAscMouseMoveDataTypes.Form){if(r)return void(s=t);var o=i==Asc.c_oAscMouseMoveDataTypes.Hyperlink?e.txtPressLink:t.get_FormHelpText();o.length>500&&(o=o.substr(0,500)+"..."),o=Common.Utils.String.htmlEncode(o);var c=!1;n.isHidden=!1,(n.tipType!==i||n.tipLength!==o.length||n.strTip.indexOf(o)<0)&&(n.toolTip.setTitle(o),n.tipLength=o.length,n.strTip=o,n.tipType=i,c=!0);var h=[t.get_X()+5,t.get_Y()+l[1]-15];n.isVisible&&!c||(n.isVisible=!0,n.toolTip.show([-1e4,-1e4])),c&&(n.tipHeight=n.toolTip.getBSTip().$tip.height(),n.tipWidth=n.toolTip.getBSTip().$tip.width()),!a&&(a=$("body").width()),c=!1,h[0]+n.tipWidth>a&&(h[0]=a-n.tipWidth,c=!0),h[1]-n.tipHeight<0?h[1]=c?h[1]+30:0:h[1]-=n.tipHeight,n.toolTip.getBSTip().$tip.css({top:h[1]+"px",left:h[0]+"px"})}}},onDownloadUrl:function(t,e){if(this.isFromBtnDownload){var i=this,n=this.embedConfig.docTitle;!n&&(n=i.txtUntitled);var o=n.lastIndexOf(".");o>0&&(n=n.substring(0,o)+".pdf"),i.appOptions.canRequestSaveAs?Common.Gateway.requestSaveAs(t,n,e):(i._saveCopyDlg=new Common.Views.SaveAsDlg({saveFolderUrl:i.appOptions.saveAsUrl,saveFileUrl:t,defFileName:n}),i._saveCopyDlg.on("saveaserror",function(t,e){Common.UI.warning({closable:!1,msg:e,callback:function(t){Common.NotificationCenter.trigger("edit:complete",i)}})}).on("close",function(t){i._saveCopyDlg=void 0}),i._saveCopyDlg.show())}else Common.Gateway.downloadAs(t);this.isFromBtnDownload=!1},onPrint:function(){this.appOptions.canPrint&&!Common.Utils.ModalWindow.isVisible()&&(this.api&&this.api.asc_Print(new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)),Common.component.Analytics.trackEvent("Print"))},onPrintUrl:function(t){if(this.iframePrint&&(this.iframePrint.parentNode.removeChild(this.iframePrint),this.iframePrint=null),!this.iframePrint){var e=this;this.iframePrint=document.createElement("iframe"),this.iframePrint.id="id-print-frame",this.iframePrint.style.display="none",this.iframePrint.style.visibility="hidden",this.iframePrint.style.position="fixed",this.iframePrint.style.right="0",this.iframePrint.style.bottom="0",document.body.appendChild(this.iframePrint),this.iframePrint.onload=function(){try{e.iframePrint.contentWindow.focus(),e.iframePrint.contentWindow.print(),e.iframePrint.contentWindow.blur(),window.focus()}catch(t){e.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.PDF))}}}t&&(this.iframePrint.src=t)},onFillRequiredFields:function(t){this.view.btnSubmit.setDisabled(!t),this.view.btnSubmit.cmpEl.css("pointer-events",t?"auto":"none")},onProcessMouse:function(t){if("mouseup"==t.type){var e=document.getElementById("editor_sdk");if(e){var i=e.getBoundingClientRect();this.api.OnMouseUp(t.x-i.left,t.y-i.top)}}},onRequestClose:function(){Common.Gateway.requestClose()},onDownloadAs:function(){if(!this.appOptions.canDownload)return void Common.Gateway.reportError(Asc.c_oAscError.ID.AccessDeny,this.errorAccessDeny);var t=/^(?:(pdf|djvu|xps|oxps))$/.exec(this.document.fileType);t&&"string"==typeof t[1]?this.api.asc_DownloadOrigin(!0):this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.DOCX,!0))},onHyperlinkClick:function(t){t&&window.open(t)},onShowContentControlsActions:function(t,e,i){if(!this._isDisabled){switch(t.type){case Asc.c_oAscContentControlSpecificType.DateTime:this.onShowDateActions(t,e,i);break;case Asc.c_oAscContentControlSpecificType.Picture:if(t.pr&&t.pr.get_Lock){var n=t.pr.get_Lock();if(n==Asc.c_oAscSdtLockType.SdtContentLocked||n==Asc.c_oAscSdtLockType.ContentLocked)return}this.onShowImageActions(t,e,i);break;case Asc.c_oAscContentControlSpecificType.DropDownList:case Asc.c_oAscContentControlSpecificType.ComboBox:this.onShowListActions(t,e,i)}}},onHideContentControlsActions:function(){this.listControlMenu&&this.listControlMenu.isVisible()&&this.listControlMenu.hide();var t=this.boxSdk.find("#calendar-control-container");t.is(":visible")&&t.hide()},onShowImageActions:function(t,e,i){var n=this.imageControlMenu,o=n?this.boxSdk.find(Common.Utils.String.format("#menu-container-{0}",n.id)):null,s=this;this.internalFormObj=t&&t.pr?t.pr.get_InternalId():null,this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),n||(this.imageControlMenu=n=new Common.UI.Menu({maxHeight:207,menuAlign:"tl-bl",items:[{caption:this.mniImageFromFile,value:"file"},{caption:this.mniImageFromUrl,value:"url"},{caption:this.mniImageFromStorage,value:"storage",visible:this.appOptions.canRequestInsertImage||this.appOptions.fileChoiceUrl&&this.appOptions.fileChoiceUrl.indexOf("{documentType}")>-1}]}),n.on("item:click",function(t,e){setTimeout(function(){s.onImageSelect(t,e)},1),
setTimeout(function(){s.api.asc_UncheckContentControlButtons()},500)}),(!o||o.length<1)&&(o=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id)),this.boxSdk.append(o)),n.render(o),n.cmpEl.attr({tabindex:"-1"}),n.on("hide:after",function(){s._fromShowContentControls||s.api.asc_UncheckContentControlButtons()})),o.css({left:e,top:i}),o.attr("data-value","prevent-canvas-click"),this._preventClick=!0,n.show(),_.delay(function(){n.cmpEl.focus()},10),this._fromShowContentControls=!1},onImageSelect:function(t,e){if("url"==e.value){var i=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t&&i.api){var n=e.replace(/ /g,"");_.isEmpty(n)||i.setImageUrl(n)}}}).show()}else if("storage"==e.value)Common.NotificationCenter.trigger("storage:image-load","control");else{if(this._isFromFile)return;this._isFromFile=!0,this.api.asc_addImage(this.internalFormObj),this._isFromFile=!1}},openImageFromStorage:function(t){var e=this;this.appOptions.canRequestInsertImage?Common.Gateway.requestInsertImage(t):new Common.Views.SelectFileDlg({fileChoiceUrl:this.appOptions.fileChoiceUrl.replace("{fileExt}","").replace("{documentType}","ImagesOnly")}).on("selectfile",function(i,n){n&&(n.c=t),!n.images&&(n.images=[{fileType:n.fileType,url:n.url}]),n.url=null,e.insertImage(n)}).show()},setImageUrl:function(t,e){this.api.asc_SetContentControlPictureUrl(t,this.internalFormObj&&this.internalFormObj.pr?this.internalFormObj.pr.get_InternalId():null,e)},insertImage:function(t){if(t&&(t.url||t.images)){t.url&&console.log("Obsolete: The 'url' parameter of the 'insertImage' method is deprecated. Please use 'images' parameter instead.");var e=[];if(t.images&&t.images.length>0)for(var i=0;i<t.images.length;i++)t.images[i]&&t.images[i].url&&e.push(t.images[i].url);else t.url&&e.push(t.url);t._urls=e}Common.NotificationCenter.trigger("storage:image-insert",t)},insertImageFromStorage:function(t){t&&t._urls&&"control"==t.c&&this.setImageUrl(t._urls[0],t.token)},onShowListActions:function(t,e,i){var n=t.type,o=t.pr,s=n==Asc.c_oAscContentControlSpecificType.ComboBox?o.get_ComboBoxPr():o.get_DropDownListPr(),r=!!o.get_FormPr(),a=this.listControlMenu,l=a?this.boxSdk.find(Common.Utils.String.format("#menu-container-{0}",a.id)):null,c=this;if(this._listObj=o,this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),a||(this.listControlMenu=a=new Common.UI.Menu({maxHeight:207,menuAlign:"tr-bl",items:[]}),a.on("item:click",function(t,e){setTimeout(function(){-1!==e.value&&c.api.asc_SelectContentControlListItem(e.value,c._listObj.get_InternalId())},1)}),(!l||l.length<1)&&(l=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',a.id)),this.boxSdk.append(l)),a.render(l),a.cmpEl.attr({tabindex:"-1"}),a.on("hide:after",function(){c.listControlMenu.removeAll(),c._fromShowContentControls||c.api.asc_UncheckContentControlButtons()})),s){if(r){var h=o.get_PlaceholderText();a.addItem(new Common.UI.MenuItem({caption:""!==h.trim()?h:this.txtEmpty,value:"",template:_.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" style="<% if (options.value=="") { %> opacity: 0.6 <% } %>">',"<%= caption %>","</a>"].join(""))}))}for(var d=s.get_ItemsCount(),u=0;u<d;u++)(""!==s.get_ItemValue(u)||!r)&&a.addItem(new Common.UI.MenuItem({caption:s.get_ItemDisplayText(u),value:s.get_ItemValue(u),template:_.template(['<a id="<%= id %>" style="<%= style %>" tabindex="-1" type="menuitem">',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))}));!r&&a.items.length<1&&a.addItem(new Common.UI.MenuItem({caption:this.txtEmpty,value:-1}))}l.css({left:e,top:i}),l.attr("data-value","prevent-canvas-click"),this._preventClick=!0,a.show(),_.delay(function(){a.cmpEl.focus()},10),this._fromShowContentControls=!1},onShowDateActions:function(t,e,i){var n=t.pr,o=n.get_DateTimePr(),s=this.boxSdk.find("#calendar-control-container"),r=this;this._dateObj=n,s.length<1&&(s=$('<div id="calendar-control-container" style="position: absolute;z-index: 1000;"><div id="id-document-calendar-control" style="position: fixed; left: -1000px; top: -1000px;"></div></div>'),this.boxSdk.append(s)),Common.UI.Menu.Manager.hideAll(),s.css({left:e,top:i}),s.show(),this.cmpCalendar||(this.cmpCalendar=new Common.UI.Calendar({el:this.boxSdk.find("#id-document-calendar-control"),enableKeyEvents:!0,firstday:1}),this.cmpCalendar.on("date:click",function(t,e){var i=r._dateObj.get_DateTimePr();i.put_FullDate(new Date(e)),r.api.asc_SetContentControlDatePickerDate(i),s.hide(),r.api.asc_UncheckContentControlButtons()}),this.cmpCalendar.on("calendar:keydown",function(t,e){e.keyCode==Common.UI.Keys.ESC&&(s.hide(),r.api.asc_UncheckContentControlButtons())}),$(document).on("mousedown",function(t){"canvas"!==t.target.localName&&s.is(":visible")&&0==s.find(t.target).length&&(s.hide(),r.api.asc_UncheckContentControlButtons())})),this.cmpCalendar.setDate(new Date(o?o.get_FullDate():void 0));var a=s.offset(),l=Common.Utils.innerWidth(),c=Common.Utils.innerHeight()-10,h=this.cmpCalendar.cmpEl.outerWidth(),d=this.cmpCalendar.cmpEl.outerHeight(),u=a.left-h,p=a.top;p+d>c&&(p=c-d,u-=22),p<0&&(p=0),u+h>l&&(u=l-h),this.cmpCalendar.cmpEl.css({left:u,top:p}),this._preventClick=!0},onDocumentContentReady:function(){if(!this._isDocReady){this._isDocReady=!0,this.hidePreloader(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,-256);var t=this.appOptions.customization&&this.appOptions.customization.zoom?parseInt(this.appOptions.customization.zoom):100;-1==t?this.api.zoomFitToPage():-2==t?this.api.zoomFitToWidth():this.api.zoom(t>0?t:100),this.createDelayedElements(),this.api.asc_registerCallback("asc_onStartAction",_.bind(this.onLongActionBegin,this)),this.api.asc_registerCallback("asc_onEndAction",_.bind(this.onLongActionEnd,this)),this.api.asc_registerCallback("asc_onMouseMoveStart",_.bind(this.onDocMouseMoveStart,this)),this.api.asc_registerCallback("asc_onMouseMoveEnd",_.bind(this.onDocMouseMoveEnd,this)),this.api.asc_registerCallback("asc_onMouseMove",_.bind(this.onDocMouseMove,this)),this.api.asc_registerCallback("asc_onHyperlinkClick",_.bind(this.onHyperlinkClick,this)),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.api.asc_registerCallback("asc_onPrint",_.bind(this.onPrint,this)),this.api.asc_registerCallback("asc_onPrintUrl",_.bind(this.onPrintUrl,this)),this.api.asc_registerCallback("sync_onAllRequiredFormsFilled",_.bind(this.onFillRequiredFields,this)),this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onContextMenu,this)),this.appOptions.canFillForms&&(this.api.asc_registerCallback("asc_onShowContentControlsActions",_.bind(this.onShowContentControlsActions,this)),this.api.asc_registerCallback("asc_onHideContentControlsActions",_.bind(this.onHideContentControlsActions,this)),this.api.asc_registerCallback("asc_onCanUndo",_.bind(this.onApiCanRevert,this,"undo")),this.api.asc_registerCallback("asc_onCanRedo",_.bind(this.onApiCanRevert,this,"redo")),this.api.asc_SetHighlightRequiredFields(!0),Common.Gateway.on("insertimage",_.bind(this.insertImage,this)),Common.NotificationCenter.on("storage:image-load",_.bind(this.openImageFromStorage,this)),Common.NotificationCenter.on("storage:image-insert",_.bind(this.insertImageFromStorage,this))),DE.getController("Plugins").setApi(this.api),DE.getController("SearchBar").setApi(this.api),this.updateWindowTitle(!0),"view"!==this.editorConfig.mode&&this.applyLicense(),Common.Gateway.on("processmouse",_.bind(this.onProcessMouse,this)),Common.Gateway.on("downloadas",_.bind(this.onDownloadAs,this)),Common.Gateway.on("requestclose",_.bind(this.onRequestClose,this)),this.attachUIEvents(),Common.Gateway.documentReady(),Common.Analytics.trackEvent("Load","Complete")}},onOptionsClick:function(t,e,i){switch(e.value){case"fullscr":this.onHyperlinkClick(this.embedConfig.fullscreenUrl);break;case"download":this.embedConfig.saveUrl?this.onHyperlinkClick(this.embedConfig.saveUrl):this.api&&this.appOptions.canPrint&&this.api.asc_Print(new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)),Common.Analytics.trackEvent("Save");break;case"print":this.api.asc_Print(new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)),Common.Analytics.trackEvent("Print");break;case"close":!DE.Controllers.Desktop.process("goback")&&this.appOptions.customization&&this.appOptions.customization.goback&&(this.appOptions.customization.goback.requestClose&&this.appOptions.canRequestClose?Common.Gateway.requestClose():this.appOptions.customization.goback.url&&(!1!==this.appOptions.customization.goback.blank?window.open(this.appOptions.customization.goback.url,"_blank"):window.parent.location.href=this.appOptions.customization.goback.url));break;case"download-docx":this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.DOCX)),Common.Analytics.trackEvent("Save");break;case"download-pdf":this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.PDF)),Common.Analytics.trackEvent("Save");break;case"share":new Common.Views.ShareDialog({embedConfig:this.embedConfig}).show();break;case"embed":new Common.Views.EmbedDialog({embedConfig:this.embedConfig}).show();break;case"search":Common.NotificationCenter.trigger("search:show")}},onThemeClick:function(t,e){null!==e.value&&Common.UI.Themes.setTheme(e.value)},onApiZoomChange:function(t,e){this.view.mnuZoom.items[0].setChecked(2==e,!0),this.view.mnuZoom.items[1].setChecked(1==e,!0),this.view.mnuZoom.options.value=t,this.view.mnuZoom.$el&&$(".menu-zoom label.zoom",this.view.mnuZoom.$el).html(t+"%")},onMenuZoomClick:function(t,e,i){switch(e.value){case"zoom:page":e.isChecked()?this.api.zoomFitToPage():this.api.zoomCustomMode();break;case"zoom:width":e.isChecked()?this.api.zoomFitToWidth():this.api.zoomCustomMode()}},onBtnZoom:function(t,e){"up"==t?this.api.zoomIn():this.api.zoomOut(),e.stopPropagation()},onDarkModeClick:function(t){Common.UI.Themes.toggleContentTheme()},onThemeChange:function(){var t=Common.UI.Themes.currentThemeId();if(_.each(this.view.mnuThemes.items,function(e){e.setChecked(t===e.value,!0)}),this.view.menuItemsDarkMode&&(this.view.menuItemsDarkMode.setDisabled(!Common.UI.Themes.isDarkTheme()),this.view.menuItemsDarkMode.setChecked(Common.UI.Themes.isContentThemeDark())),this.appOptions.canBranding){var e=this.appOptions.customization;if(e&&e.logo&&(e.logo.image||e.logo.imageDark)&&e.logo.image!==e.logo.imageDark){var i=Common.UI.Themes.isDarkTheme()?e.logo.imageDark||e.logo.image:e.logo.image||e.logo.imageDark;$("#header-logo img").attr("src",i)}}},onContentThemeChangedToDark:function(t){this.view.menuItemsDarkMode.setChecked(t,!0)},createDelayedElements:function(){var t=this.view.btnOptions.menu.items,e=t.length-4,i=function(e){var n;t[0].isVisible()||t[1].isVisible()||t[2].isVisible()||t[3].isVisible()?n=t[4]:t[4].setVisible(!1),t[7].isVisible()||t[8].isVisible()?n=t[9]:t[9].setVisible(!1),t[10].isVisible()||t[11].isVisible()?n=t[12]:t[12].setVisible(!1),t[13].isVisible()||t[14].isVisible()||n&&n.setVisible(!1),e.off("show:after",i)};if(this.appOptions.canPrint||(t[3].setVisible(!1),e--),this.embedConfig.saveUrl&&this.appOptions.canDownload&&!this.appOptions.isOFORM||(t[0].setVisible(!1),e--),this.appOptions.isOFORM&&this.appOptions.canDownload&&!this.appOptions.isOffline||(t[1].setVisible(!1),t[2].setVisible(!1),e-=2),Common.UI.Themes.available()){var o=Common.UI.Themes.currentThemeId();for(var s in Common.UI.Themes.map())this.view.mnuThemes.addItem(new Common.UI.MenuItem({caption:Common.UI.Themes.get(s).text,value:s,toggleGroup:"themes",checkable:!0,checked:s===o}))}this.view.mnuThemes.items.length<1?(t[7].setVisible(!1),e--):(this.view.menuItemsDarkMode=new Common.UI.MenuItem({caption:this.view.txtDarkMode,checkable:!0,checked:Common.UI.Themes.isContentThemeDark(),disabled:!Common.UI.Themes.isDarkTheme()}),this.view.mnuThemes.addItem(new Common.UI.MenuItem({caption:"--"})),this.view.mnuThemes.addItem(this.view.menuItemsDarkMode),this.view.mnuThemes.on("item:click",_.bind(this.onThemeClick,this)),this.view.menuItemsDarkMode.on("click",_.bind(this.onDarkModeClick,this)),Common.NotificationCenter.on("uitheme:changed",this.onThemeChange.bind(this)),Common.NotificationCenter.on("contenttheme:dark",this.onContentThemeChangedToDark.bind(this))),this.embedConfig.shareUrl&&!this.appOptions.isOFORM||(t[10].setVisible(!1),e--),this.appOptions.canBackToFolder||(t[11].setVisible(!1),e--),this.embedConfig.embedUrl&&!this.appOptions.isOFORM||(t[13].setVisible(!1),e--),this.embedConfig.fullscreenUrl&&!this.appOptions.isOFORM||(t[14].setVisible(!1),e--),e<1&&this.view.btnOptions.setVisible(!1),this.view.btnOptions.menu.on("show:after",i),n={toolTip:new Common.UI.Tooltip({owner:this,html:!0,title:this.txtPressLink,cls:"link-tooltip"}),strTip:"",isHidden:!0,isVisible:!1}},attachUIEvents:function(){var t=this;$("#id-btn-zoom-in").on("click",this.api.zoomIn.bind(this.api)),$("#id-btn-zoom-out").on("click",this.api.zoomOut.bind(this.api)),$("#id-menu-zoom-in").on("click",_.bind(this.onBtnZoom,this,"up")),$("#id-menu-zoom-out").on("click",_.bind(this.onBtnZoom,this,"down")),this.view.btnOptions.menu.on("item:click",_.bind(this.onOptionsClick,this)),this.view.mnuZoom.on("item:click",_.bind(this.onMenuZoomClick,this));var e=this.view.txtGoToPage._input;if(this.view.txtGoToPage.on({"changed:after":function(e,i,n){var s=parseInt(i);s>o&&(s=o),(s<2||isNaN(s))&&(s=1),t.api.goToPage(s-1)},inputleave:function(){e.blur()}}),e.on({focusin:function(t){e.removeClass("masked"),e.select()},focusout:function(t){!e.hasClass("masked")&&e.addClass("masked")}}),$("#pages").on("click",function(t){setTimeout(function(){e.focus().select()},10)}),this.appOptions.canSubmitForms&&!this.api.asc_IsAllRequiredFormsFilled()){this.view.btnSubmit.setDisabled(!0),this.view.btnSubmit.cmpEl.css("pointer-events","none");var i=$("#id-submit-group");if(Common.localStorage.getItem("de-embed-hide-submittip"))i.attr("data-toggle","tooltip"),i.tooltip({title:t.textRequired,placement:"bottom"});else{var n=new Common.UI.SynchronizeTip({extCls:"colored",placement:"bottom-left",target:this.view.btnSubmit.$el,text:this.textRequired,showLink:!1,closable:!1,showButton:!0,textButton:this.textGotIt}),s=function(){n.hide(),t.api.asc_MoveToFillingForm(!0,!0,!0),i.attr("data-toggle","tooltip"),i.tooltip({title:t.textRequired,placement:"bottom"})};n.on("buttonclick",function(){s(),Common.localStorage.setItem("de-embed-hide-submittip",1)}),n.on("closeclick",s),n.show()}}var r,a=!1;$(document).mousemove(function(t){$("#id-btn-zoom-in").fadeIn(),$("#id-btn-zoom-out").fadeIn(),a=!0,r||(r=setInterval(function(){a||($("#id-btn-zoom-in").fadeOut(),$("#id-btn-zoom-out").fadeOut(),clearInterval(r),r=void 0),a=!1},2e3))})},onContextMenu:function(t){var e=this;_.delay(function(){0==t.get_Type()&&e.api&&e.appOptions.canFillForms&&e.fillMenuProps(e.api.getSelectedElements(),t)},10)},showPopupMenu:function(t,e,i){if(!_.isUndefined(t)&&null!==t){Common.UI.Menu.Manager.hideAll();var n=[i.get_X(),i.get_Y()],o=this.boxSdk.find(Common.Utils.String.format("#menu-container-{0}",t.id));t.rendered||(o.length<1&&(o=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',t.id)),this.boxSdk.append(o)),t.render(o),t.cmpEl.attr({tabindex:"-1"})),o.css({left:n[0],top:n[1]}),t.show(),_.isFunction(t.options.initMenu)&&(t.options.initMenu(e),t.alignPosition()),_.delay(function(){t.cmpEl.focus()},10),this.currentMenu=t}},fillMenuProps:function(t,e){if(t&&_.isArray(t)){this.textMenu||(this.textMenu=this.view.getContextMenu(),this.textMenu.on("item:click",_.bind(this.onContextMenuClick,this)));for(var i={},n=!0,o=0;o<t.length;o++){var s=t[o].get_ObjectType(),r=t[o].get_ObjectValue();if(Asc.c_oAscTypeSelectElement.Image==s){i.imgProps={},i.imgProps.value=r,i.imgProps.locked=!!r&&r.get_Locked();var a=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null,l=a?a.get_Lock():Asc.c_oAscSdtLockType.Unlocked;i.imgProps.content_locked=l==Asc.c_oAscSdtLockType.SdtContentLocked||l==Asc.c_oAscSdtLockType.ContentLocked,n=!1}else Asc.c_oAscTypeSelectElement.Paragraph==s?(i.paraProps={},i.paraProps.value=r,i.paraProps.locked=!!r&&r.get_Locked(),n=!1):Asc.c_oAscTypeSelectElement.Header==s&&(i.headerProps={},i.headerProps.locked=!!r&&r.get_Locked())}if(this.textMenu&&!n){var c=this.api.can_CopyCut(),h=i.paraProps&&i.paraProps.locked||i.headerProps&&i.headerProps.locked||i.imgProps&&(i.imgProps.locked||i.imgProps.content_locked)||this._isDisabled;this.textMenu.items[0].setDisabled(h||!this.api.asc_getCanUndo()),this.textMenu.items[1].setDisabled(h||!this.api.asc_getCanRedo()),this.textMenu.items[3].setDisabled(h),this.textMenu.items[5].setDisabled(h||!c),this.textMenu.items[6].setDisabled(!c),this.textMenu.items[7].setDisabled(h),this.showPopupMenu(this.textMenu,{},e)}}},onContextMenuClick:function(t,e,i){switch(e.value){case"undo":this.api&&this.api.Undo();break;case"redo":this.api&&this.api.Redo();break;case"copy":case"cut":case"paste":if(this.api){("cut"==e.value?this.api.Cut():"copy"==e.value?this.api.Copy():this.api.Paste())||Common.localStorage.getBool("de-forms-hide-copywarning")||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("de-forms-hide-copywarning",1)}}).show()}break;case"clear":if(this.api){var n=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null;n&&this.api.asc_ClearContentControl(n.get_InternalId())}}},onApiServerDisconnect:function(t){this._state.isDisconnected=!0,this._isDisabled=!0,this.view&&this.view.btnClear&&this.view.btnClear.setDisabled(!0),this.view&&this.view.btnUndo&&this.view.btnUndo.setDisabled(!0),this.view&&this.view.btnRedo&&this.view.btnRedo.setDisabled(!0),t||(this.appOptions.canPrint=this.appOptions.canDownload=!1,this.view&&this.view.btnDownload.setDisabled(!0),this.view&&this.view.btnSubmit.setDisabled(!0),this.view&&this.view.btnOptions&&this.view.btnOptions.menu&&(this.view.btnOptions.menu.items[3].setDisabled(!0),this.view.btnOptions.menu.items[0].setDisabled(!0),this.view.btnOptions.menu.items[1].setDisabled(!0),this.view.btnOptions.menu.items[2].setDisabled(!0)))},onApiCanRevert:function(t,e){this.view&&("undo"==t?this.view.btnUndo.setDisabled(!e):this.view.btnRedo.setDisabled(!e))},errorDefaultMessage:"Error code: %1",unknownErrorText:"Unknown error.",convertationTimeoutText:"Conversion timeout exceeded.",convertationErrorText:"Conversion failed.",downloadErrorText:"Download failed.",criticalErrorTitle:"Error",notcriticalErrorTitle:"Warning",scriptLoadError:"The connection is too slow, some of the components could not be loaded. Please reload the page.",errorFilePassProtect:"The file is password protected and cannot be opened.",errorAccessDeny:"You are trying to perform an action you do not have rights for.<br>Please contact your Document Server administrator.",errorUserDrop:"The file cannot be accessed right now.",unsupportedBrowserErrorText:"Your browser is not supported.",textOf:"of",downloadTextText:"Downloading document...",waitText:"Please, wait...",textLoadingDocument:"Loading document",txtClose:"Close",errorFileSizeExceed:"The file size exceeds the limitation set for your server.<br>Please contact your Document Server administrator for details.",errorUpdateVersionOnDisconnect:"Internet connection has been restored, and the file version has been changed.<br>Before you can continue working, you need to download the file or copy its content to make sure nothing is lost, and then reload this page.",textSubmited:"<b>Form submitted successfully</b><br>Click to close the tip.",errorSubmit:"Submit failed.",errorEditingDownloadas:"An error occurred during the work with the document.<br>Use the 'Download as...' option to save the file backup copy to your computer hard drive.",textGuest:"Guest",textAnonymous:"Anonymous",textRequired:"Fill all required fields to send form.",textGotIt:"Got it",errorForceSave:"An error occurred while saving the file. Please use the 'Download as' option to save the file to your computer hard drive or try again later.",textCloseTip:"Click to close the tip.",txtPressLink:"Press Ctrl and click link",txtEmpty:"(Empty)",titleServerVersion:"Editor updated",errorServerVersion:"The editor version has been updated. The page will be reloaded to apply the changes.",titleUpdateVersion:"Version changed",errorUpdateVersion:"The file version has been changed. The page will be reloaded.",warnLicenseLimitedRenewed:"License needs to be renewed.<br>You have a limited access to document editing functionality.<br>Please contact your administrator to get full access",warnLicenseLimitedNoAccess:"License expired.<br>You have no access to document editing functionality.<br>Please contact your administrator.",warnLicenseExceeded:"You've reached the limit for simultaneous connections to %1 editors. This document will be opened for viewing only.<br>Contact your administrator to learn more.",warnLicenseUsersExceeded:"You've reached the user limit for %1 editors. Contact your administrator to learn more.",warnNoLicense:"You've reached the limit for simultaneous connections to %1 editors. This document will be opened for viewing only.<br>Contact %1 sales team for personal upgrade terms.",warnNoLicenseUsers:"You've reached the user limit for %1 editors. Contact %1 sales team for personal upgrade terms.",textBuyNow:"Visit website",textNoLicenseTitle:"License limit reached",textContactUs:"Contact sales",errorLoadingFont:"Fonts are not loaded.<br>Please contact your Document Server administrator.",errorConnectToServer:"The document could not be saved. Please check connection settings or contact your administrator.<br>When you click the 'OK' button, you will be prompted to download the document.",errorTokenExpire:"The document security token has expired.<br>Please contact your Document Server administrator.",errorViewerDisconnect:"Connection is lost. You can still view the document,<br>but will not be able to download or print until the connection is restored and page is reloaded.",uploadImageSizeMessage:"Maximum image size limit exceeded.",uploadImageExtMessage:"Unknown image format.",txtArt:"Your text here",txtChoose:"Choose an item",txtEnterDate:"Enter a date",txtClickToLoad:"Click to load image",openErrorText:"An error has occurred while opening the file",mniImageFromFile:"Image from File",mniImageFromUrl:"Image from URL",mniImageFromStorage:"Image from Storage",txtUntitled:"Untitled",errorToken:"The document security token is not correctly formed.<br>Please contact your Document Server administrator.",errorSessionAbsolute:"The document editing session has expired. Please reload the page.",errorSessionIdle:"The document has not been edited for quite a long time. Please reload the page.",errorSessionToken:"The connection to the server has been interrupted. Please reload the page.",errorBadImageUrl:"Image url is incorrect",errorDataEncrypted:"Encrypted changes have been received, they cannot be deciphered.",saveErrorText:"An error has occurred while saving the file",saveErrorTextDesktop:"This file cannot be saved or created.<br>Possible reasons are: <br>1. The file is read-only. <br>2. The file is being edited by other users. <br>3. The disk is full or corrupted.",errorEditingSaveas:"An error occurred during the work with the document.<br>Use the 'Save as...' option to save the file backup copy to your computer hard drive.",textSaveAs:"Save as PDF",textSaveAsDesktop:"Save as...",warnLicenseExp:"Your license has expired.<br>Please update your license and refresh the page.",titleLicenseExp:"License expired",errorTextFormWrongFormat:"The value entered does not match the format of the field.",errorInconsistentExtDocx:"An error has occurred while opening the file.<br>The file content corresponds to text documents (e.g. docx), but the file has the inconsistent extension: %1.",errorInconsistentExtXlsx:"An error has occurred while opening the file.<br>The file content corresponds to spreadsheets (e.g. xlsx), but the file has the inconsistent extension: %1.",errorInconsistentExtPptx:"An error has occurred while opening the file.<br>The file content corresponds to presentations (e.g. pptx), but the file has the inconsistent extension: %1.",errorInconsistentExtPdf:"An error has occurred while opening the file.<br>The file content corresponds to one of the following formats: pdf/djvu/xps/oxps, but the file has the inconsistent extension: %1.",errorInconsistentExt:"An error has occurred while opening the file.<br>The file content does not match the file extension."},DE.Controllers.ApplicationController));var c=function(){var t,e,i={version:"7.3.3",uitype:"fillform",uithemes:!0},n=window.desktop||window.AscDesktopEditor;if(!!n&&n.execCommand("webapps:features",JSON.stringify(i)),n){if($("#header-logo, .brand-logo").hide(),e=window.RendererProcessVariable,window.on_native_message=function(t,e){if(/theme:changed/.test(t))Common.UI.Themes&&Common.UI.Themes.setTheme&&Common.UI.Themes.setTheme(e);else if(/window:features/.test(t)){var i=JSON.parse(e);void 0!==i.singlewindow&&(n.features.singlewindow=i.singlewindow,$("#title-doc-name")[i.singlewindow?"hide":"show"]())}},window.native_message_cmd)for(var o in window.native_message_cmd)window.on_native_message(o,window.native_message_cmd[o]);Common.NotificationCenter.on({"uitheme:changed":function(t){if(Common.localStorage.getBool("ui-theme-use-system",!1))n.execCommand("uitheme:changed",JSON.stringify({name:"theme-system"}));else{const e=Common.UI.Themes.get(t);e&&n.execCommand("uitheme:changed",JSON.stringify({name:t,type:e.type}))}}}),Common.Gateway.on("opendocument",function(){t=DE.getController("ApplicationController").api,$("#title-doc-name")[n.features.singlewindow?"hide":"show"]();var e=window.RendererProcessVariable&&"winxp"===window.RendererProcessVariable.os;Common.UI.Themes.setAvailable(!e)})}return{isActive:function(){return!!n},isOffline:function(){return t&&t.asc_isOffline()},process:function(e){if(n&&t&&"goback"==e){var i=DE.getController("ApplicationController").editorConfig;return n.execCommand("go:folder",t.asc_isOffline()?"offline":i.customization.goback.url),!0}return!1},systemThemeType:function(){return e.theme&&e.theme.system?e.theme.system:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}}};DE.Controllers.Desktop=new c,Common.Controllers=Common.Controllers||{},Common.Controllers.Desktop=DE.Controllers.Desktop}),void 0===Common)var Common={};if(Common.Models=Common.Models||{},define("common/main/lib/model/Plugin",["underscore","backbone","common/main/lib/component/BaseView"],function(t,e){"use strict";Common.Models.PluginVariation=e.Model.extend({defaults:function(){return{description:"",url:"",index:0,icons:void 0,isSystem:!1,isViewer:!1,isDisplayedInViewer:!0,EditorsSupport:["word","cell","slide"],isVisual:!1,isCustomWindow:!1,isModal:!0,isInsideMode:!1,initDataType:0,initData:"",isUpdateOleOnResize:!1,buttons:[],size:[800,600],initOnSelectionChanged:!1,visible:!0}}}),Common.Models.Plugin=e.Model.extend({defaults:function(){return{id:Common.UI.getId(),name:"",baseUrl:"",guid:Common.UI.getId(),variations:[],currentVariation:0,pluginObj:void 0,allowSelected:!1,selected:!1,visible:!0,groupName:"",groupRank:0}}})}),void 0===Common)var Common={};if(Common.Collections=Common.Collections||{},define("common/main/lib/collection/Plugins",["underscore","backbone","common/main/lib/model/Plugin"],function(t,e){"use strict";Common.Collections.Plugins=e.Collection.extend({model:Common.Models.Plugin,hasVisible:function(){return!!this.findWhere({visible:!0})}})}),void 0===Common)var Common={};if(define("common/main/lib/component/Layout",["backbone"],function(){"use strict";var t=function(t){this.box=null,this.panels=[],this.splitters=[],_.extend(this,t||{})},e=function(){return{width:null,height:null,resize:!1,stretch:!1,rely:!1}};_.extend(t.prototype,Backbone.Events,{initialize:function(t){this.$parent=this.box.parent(),this.resize={eventMove:_.bind(this.resizeMove,this),eventStop:_.bind(this.resizeStop,this)};this.freeze=t.freeze,this.changeLayout(t.items)},doLayout:function(){},changeLayout:function(t){var i,n,o=!1;this.splitters&&this.splitters.forEach(function(t){t.resizer&&t.resizer.el.remove()},this),this.splitters=[],this.panels=[],t.forEach(function(t){t.el instanceof HTMLElement&&(t.el=$(t.el)),i=_.extend(new e,t),i.stretch&&(o=!0,i.rely=!1,i.resize=!1),this.panels.push(i),i.resize&&(n={isresizer:!0,minpos:i.resize.min||0,maxpos:i.resize.max||0,fmin:i.resize.fmin,fmax:i.resize.fmax,behaviour:i.behaviour,index:this.splitters.length,offset:i.resize.offset||0,multiply:i.resize.multiply},o?(i.resize.el=n.el=i.el.before('<div class="layout-resizer before"></div>').prev(),this.panels.splice(this.panels.length-1,0,n)):(i.resize.el=n.el=i.el.after('<div class="layout-resizer after"></div>').next(),this.panels.push(n)),this.splitters.push({resizer:n}),i.resize.hidden&&n.el.hide(),Common.Gateway.on("processmouse",this.resize.eventStop))},this),this.freezePanels(this.freeze)},getElementHeight:function(t){return parseInt(t.css("height"))},getElementWidth:function(t){return parseInt(t.css("width"))},getItem:function(t){for(var e in this.panels){var i=this.panels[e];if(i.alias==t)return i}},onSelectStart:function(t){return t.preventDefault&&t.preventDefault(),!1},addHandler:function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},removeHandler:function(t,e,i){t.removeEventListener?t.removeEventListener(e,i):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null},clearSelection:function(){if(window.getSelection){var t=window.getSelection();t.empty?t.empty():t.removeAllRanges&&t.removeAllRanges()}else document.selection&&document.selection.empty()},resizeStart:function(t){if(!this.freeze){this.clearSelection(),this.addHandler(window.document,"selectstart",this.onSelectStart),$(document).on({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop}),Common.NotificationCenter.on({"frame:mousemove":this.resize.eventMove,"frame:mouseup":this.resize.eventStop});var e=t.data.panel;this.resize.type=t.data.type,this.resize.$el=e.el,this.resize.min=e.minpos,this.resize.fmin=e.fmin,this.resize.fmax=e.fmax,this.resize.behaviour=e.behaviour,this.resize.multiply=e.multiply,this.resize.$el.addClass("move"),"vertical"==t.data.type?(this.resize.height=parseInt(this.resize.$el.css("height")),this.resize.max=(e.maxpos>0?e.maxpos:this.resize.$el.parent().height()+e.maxpos)-this.resize.height,this.resize.inity=t.pageY*Common.Utils.zoom()-parseInt(t.currentTarget.style.top)):"horizontal"==t.data.type&&(this.resize.width=parseInt(this.resize.$el.css("width")),this.resize.max=(e.maxpos>0?e.maxpos:this.resize.$el.parent().width()+e.maxpos)-this.resize.width,this.resize.initx=t.pageX*Common.Utils.zoom()-parseInt(t.currentTarget.style.left)),this.resize.multiply&&this.resize.multiply.koeff&&(this.resize.max=Math.floor(this.resize.max/this.resize.multiply.koeff)*this.resize.multiply.koeff+(this.resize.multiply.offset||0)),Common.NotificationCenter.trigger("layout:resizestart")}},resizeMove:function(t){var e=t instanceof jQuery.Event?Common.Utils.zoom():1;if("vertical"==this.resize.type)var i="top",n=t.pageY*e-this.resize.inity;else"horizontal"==this.resize.type&&(i="left",n=t.pageX*e-this.resize.initx);if(this.resize.multiply&&this.resize.multiply.koeff){var o=this.resize.multiply.koeff,s=n/o,r=Math.floor(s)*o+(this.resize.multiply.offset||0),a=Math.ceil(s)*o+(this.resize.multiply.offset||0);n=n>r+o/2?a:r}
this.resize.fmin&&this.resize.fmax?n<this.resize.fmin()||n>this.resize.fmax()||(this.resize.$el[0].style[i]=n+"px"):n<this.resize.min||n>this.resize.max||(this.resize.$el[0].style[i]=n+"px")},resizeStop:function(t){if(this.removeHandler(window.document,"selectstart",this.onSelectStart),$(document).off({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop}),Common.NotificationCenter.off({"frame:mousemove":this.resize.eventMove,"frame:mouseup":this.resize.eventStop}),this.resize.$el){var e=t instanceof jQuery.Event?Common.Utils.zoom():1;if(t instanceof jQuery.Event||void 0!==t.pageY&&void 0!==t.pageX||(t.pageY=t.y,t.pageX=t.x),"vertical"==this.resize.type)var i="height",n=t.pageY*e-this.resize.inity;else"horizontal"==this.resize.type&&(i="width",n=t.pageX*e-this.resize.initx);if(this.resize.multiply&&this.resize.multiply.koeff){var o=this.resize.multiply.koeff,s=n/o,r=Math.floor(s)*o+(this.resize.multiply.offset||0),a=Math.ceil(s)*o+(this.resize.multiply.offset||0);n=n>r+o/2?a:r}this.resize.fmin&&this.resize.fmax?(n<this.resize.fmin()&&(n=this.resize.fmin()),n>this.resize.fmax()&&(n=this.resize.fmax())):(n<this.resize.min&&(n=this.resize.min),n>this.resize.max&&(n=this.resize.max));var l=null,c=null,h=0;this.resize.$el.hasClass("after")?(l=this.resize.$el.prev(),c=this.resize.$el.next(),h=parseInt(l.css(i))):(l=this.resize.$el.next(),c=this.resize.$el.next(),h=parseInt(l.css(i)),n=l.parent()[i]()-(n+this.resize[i])),"vertical"==this.resize.type&&(n-=l.position().top),"horizontal"==this.resize.type&&(n-=l.position().left),l.css(i,n+"px"),this.resize.behaviour&&c.css(i,parseInt(c.css(i))-(n-h)),this.resize.$el.removeClass("move"),delete this.resize.$el,this.resize.value!=n&&(this.doLayout(),this.trigger("layout:resizedrag",this)),Common.NotificationCenter.trigger("layout:resizestop")}},freezePanels:function(t){this.panels.forEach(function(e){!e.stretch&&e.resize&&$(e.resize.el).css("cursor",t?"default":"")}),this.freeze=t},setResizeValue:function(t,e){if(t>=this.splitters.length)return this.doLayout(),!1;var i=null,n=null,o=0,s=this.splitters[t].resizer,r="height";return e<s.fmin()&&(e=s.fmin()),e>s.fmax()&&(e=s.fmax()),s.el.hasClass("after")?(i=s.el.prev(),n=s.el.next(),o=parseInt(i.css(r))):(i=s.el.next(),e=i.parent()[r]()-(e+s[r]),n=s.el.next(),o=parseInt(i.css(r))),e-=i.position().top,i.css(r,e+"px"),s.behaviour&&n.css(r,parseInt(n.css(r))-(e-o)),s.value!=e&&this.doLayout(),Math.abs(o-e)>.99}}),!Common.UI&&(Common.UI={}),Common.UI.VBoxLayout=function(e){t.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.VBoxLayout.prototype=_.extend(new t,{initialize:function(e){t.prototype.initialize.call(this,e)},doLayout:function(){var t,e,i=0;this.panels.forEach(function(n){n.stretch?t=n:(e=n.el.is(":visible"),e&&(i+=!0!==n.rely?n.height:this.getElementHeight(n.el)),n.resize&&!1!==n.resize.autohide&&n.resize.el&&(e?(n.resize.el.show(),t&&(i+=n.resize.height)):(n.resize.el.hide(),t&&(i-=n.resize.height))))},this),t&&(t.height=this.$parent.height()-i),i=0,this.panels.forEach(function(t){t.el.is(":visible")&&(e={top:i},!0!==t.rely&&(e.height=t.height),t.el.css(e),i+=e.height||this.getElementHeight(t.el))},this)},changeLayout:function(e){t.prototype.changeLayout.call(this,e),this.panels.forEach(function(t){!t.stretch&&!t.height&&(t.height=this.getElementHeight(t.el)),t.isresizer&&t.el.on("mousedown",{type:"vertical",panel:t},_.bind(this.resizeStart,this))},this),this.doLayout.call(this)}}),Common.UI.HBoxLayout=function(e){t.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.HBoxLayout.prototype=_.extend(new t,{initialize:function(e){t.prototype.initialize.call(this,e)},doLayout:function(t){var e,i,n=0;this.panels.forEach(function(t){t.stretch?e=t:(i=t.el.is(":visible"),i&&(t.isresizer?n+=t.offset:n+=!0!==t.rely?t.width:this.getElementWidth(t.el)),t.resize&&!1!==t.resize.autohide&&t.resize.el&&(i?(t.resize.el.show(),e&&(n-=t.resize.width)):(t.resize.el.hide(),e&&(n-=t.resize.width))))},this),e&&(e.width=this.$parent.width()-n),n=0,this.panels.forEach(function(t){t.el.is(":visible")&&(i={left:n-(t.isresizer?t.width:0)},!0!==t.rely&&(i.width=t.width),t.el.css(i),t.isresizer?n+=t.offset:n+=this.getElementWidth(t.el))},this)},changeLayout:function(e){t.prototype.changeLayout.call(this,e),this.panels.forEach(function(t){!t.stretch&&!t.width&&(t.width=this.getElementWidth(t.el)),t.isresizer&&t.el.on("mousedown",{type:"horizontal",panel:t},_.bind(this.resizeStart,this))},this),this.doLayout.call(this)}}),Common.UI.VBoxLayout.prototype.constructor=Common.UI.VBoxLayout,Common.UI.HBoxLayout.prototype.constructor=Common.UI.HBoxLayout}),void 0===Common)var Common={};Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],function(t){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!0,enableKeyEvents:!1},t);var i=e.buttons&&_.size(e.buttons)>0?85:34;e.header||(i-=34),this.bordersOffset=40,e.width=Common.Utils.innerWidth()-2*this.bordersOffset-e.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:e.width,e.height+=i,e.height=Common.Utils.innerHeight()-2*this.bordersOffset-e.height<0?Common.Utils.innerHeight()-2*this.bordersOffset:e.height,e.cls+=" advanced-settings-dlg",this.template=['<div id="id-plugin-container" class="box" style="height:'+(e.height-i)+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.buttons&&_.size(this.options.buttons)>0?85:34,this.options.header||(this._headerFooterHeight-=34),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));var t=document.createElement("iframe");t.id=this.frameId,t.name="pluginFrameEditor",t.width="100%",t.height="100%",t.align="top",t.frameBorder=0,t.scrolling="no",t.allow="camera; microphone; display-capture",t.onload=_.bind(this._onLoad,this);var e=this;this.loader&&setTimeout(function(){e.isLoaded||(e.loadMask=new Common.UI.LoadMask({owner:$("#id-plugin-placeholder")}),e.loadMask.setTitle(e.textLoading),e.loadMask.show(),e.isLoaded&&e.loadMask.hide())},500),t.src=this.url,$("#id-plugin-placeholder").append(t),this.on("resizing",function(t){e.boxEl.css("height",parseInt(e.$window.css("height"))-e._headerFooterHeight)});var i=function(){e.onWindowResize()};$(window).on("resize",i),this.on("close",function(){$(window).off("resize",i)})},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),o=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),s=2*this.bordersOffset;i-s<e+this._headerFooterHeight&&(e=i-s-this._headerFooterHeight),n-s<t+o&&(t=n-s-o),this.boxEl.css("height",e),Common.UI.Window.prototype.setHeight.call(this,e+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+o),this.$window.css("left",(n-t-o)/2),this.$window.css("top",(i-e-this._headerFooterHeight)/2),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight(),i=this.getWidth(),n=this.getHeight(),o=this.resizable?0:this.bordersOffset;if(n<e-2*o+.1){if(!this.resizable&&this._restoreHeight>0&&n<this._restoreHeight){var s=Math.max(Math.min(this._restoreHeight,e-2*o),this.initConfig.minheight);this.setHeight(s),this.boxEl.css("height",s-this._headerFooterHeight)}var r=this.getTop();r<o?this.$window.css("top",o):r+n>e-o&&this.$window.css("top",e-o-n)}else void 0===this._restoreHeight&&(this._restoreHeight=n),this.setHeight(Math.max(e-2*o,this.initConfig.minheight)),this.boxEl.css("height",Math.max(e-2*o,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",o);if(i<t-2*o+.1){!this.resizable&&this._restoreWidth>0&&i<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,t-2*o),this.initConfig.minwidth));var a=this.getLeft();a<o?this.$window.css("left",o):a+i>t-o&&this.$window.css("left",t-o-i)}else void 0===this._restoreWidth&&(this._restoreWidth=i),this.setWidth(Math.max(t-2*o,this.initConfig.minwidth)),this.$window.css("left",o)},showButton:function(t){var e=this.$window.find(".header .tools.left");if("back"==t){var i=e.find("#id-plugindlg-"+t);i.length<1&&(i=$('<div id="id-plugindlg-'+t+'" class="tool help" style="font-size:20px;">←</div>'),i.on("click",_.bind(function(){this.fireEvent("header:click",t)},this)),e.prepend(i)),i.show(),e.removeClass("hidden")}},hideButton:function(t){var e=this.$window.find(".header .tools.left");if("back"==t){var i=e.find("#id-plugindlg-"+t);i.length>0&&i.hide()}},textLoading:"Loading"},Common.Views.PluginDlg||{}))}),define("documenteditor/forms/app/controller/Plugins",["core","common/main/lib/collection/Plugins","common/main/lib/view/PluginDlg"],function(){"use strict";DE.Controllers.Plugins=Backbone.Controller.extend(_.extend({models:[],appOptions:{},configPlugins:{autostart:[]},serverPlugins:{autostart:[]},collections:["Common.Collections.Plugins"],initialize:function(){},events:function(){},onLaunch:function(){this._moveOffset={x:0,y:0},this.autostart=[],Common.Gateway.on("init",this.loadConfig.bind(this))},loadConfig:function(t){var e=this;e.configPlugins.config=t.config.plugins,e.editor="word"},loadPlugins:function(){this.configPlugins.config?this.getPlugins(this.configPlugins.config.pluginsData).then(function(e){t.configPlugins.plugins=e,t.mergePlugins()}).catch(function(e){t.configPlugins.plugins=!1}):this.configPlugins.plugins=!1;var t=this;Common.Utils.loadConfig("../../../../plugins.json",function(e){"error"!=e?(t.serverPlugins.config=e,t.getPlugins(t.serverPlugins.config.pluginsData).then(function(e){t.serverPlugins.plugins=e,t.mergePlugins()}).catch(function(e){t.serverPlugins.plugins=!1})):t.serverPlugins.plugins=!1})},setApi:function(t){return this.api=t,this.appOptions.customization&&!1===this.appOptions.customization.plugins||(this.api.asc_registerCallback("asc_onPluginShow",_.bind(this.onPluginShow,this)),this.api.asc_registerCallback("asc_onPluginClose",_.bind(this.onPluginClose,this)),this.api.asc_registerCallback("asc_onPluginResize",_.bind(this.onPluginResize,this)),this.api.asc_registerCallback("asc_onPluginMouseUp",_.bind(this.onPluginMouseUp,this)),this.api.asc_registerCallback("asc_onPluginMouseMove",_.bind(this.onPluginMouseMove,this)),this.api.asc_registerCallback("asc_onPluginsReset",_.bind(this.resetPluginsList,this)),this.api.asc_registerCallback("asc_onPluginsInit",_.bind(this.onPluginsInit,this)),this.loadPlugins()),this},setMode:function(t,e){return this.appOptions=t,this.api=e,this},refreshPluginsList:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins"),e=[];t.each(function(t){var i=new Asc.CPlugin;i.deserialize(t.get("original")),t.set("pluginObj",i),e.push(i)}),this.api.asc_pluginsRegister("",e),Common.Gateway.pluginsReady()},onPluginShow:function(t,e,i,n){var o=t.get_Variations()[e];if(o.get_Visual()){var s=this.appOptions&&this.appOptions.lang?this.appOptions.lang.split(/[\-_]/)[0]:"en",r=o.get_Url();r=(0==t.get_BaseUrl().length?r:t.get_BaseUrl())+r,n&&(r+=n);var a=this,l=o.get_CustomWindow(),c=o.get_Buttons(),h=[],d=o.get_Size(),u=o.get_Modal();(!d||d.length<2)&&(d=[800,600]),_.isArray(c)&&_.each(c,function(t,e){t.visible&&(h[e]={caption:t.text,value:e,primary:t.primary})});var p=o.get_Help();a.pluginDlg=new Common.Views.PluginDlg({cls:l?"plain":"",header:!l,title:t.get_Name(s),width:d[0],height:d[1],url:r,frameId:i,buttons:l?void 0:h,toolcallback:_.bind(this.onToolClose,this),help:!!p,loader:t.get_Loader(),modal:void 0===u||u}),a.pluginDlg.on({"render:after":function(t){t.getChild(".footer .dlg-btn").on("click",_.bind(a.onDlgBtnClick,a)),a.pluginContainer=a.pluginDlg.$window.find("#id-plugin-container")},close:function(t){a.pluginDlg=void 0},drag:function(t){a.api.asc_pluginEnableMouseEvents("start"==t[1])},resize:function(t){a.api.asc_pluginEnableMouseEvents("start"==t[1])},help:function(){p&&window.open(p,"_blank")}}),a.pluginDlg.show()}},onPluginClose:function(t){this.pluginDlg&&this.pluginDlg.close(),this.runAutoStartPlugins()},onPluginResize:function(t,e,i,n){if(this.pluginDlg){var o=e&&e.length>1&&i&&i.length>1&&(i[0]>e[0]||i[1]>e[1]||0==i[0]||0==i[1]);this.pluginDlg.setResizable(o,e,i),this.pluginDlg.setInnerSize(t[0],t[1]),n&&n.call()}},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;this.api.asc_pluginButtonClick(parseInt(e))},onToolClose:function(){this.api.asc_pluginButtonClick(-1)},onPluginMouseUp:function(t,e){this.pluginDlg&&(this.pluginDlg.binding.dragStop&&this.pluginDlg.binding.dragStop(),this.pluginDlg.binding.resizeStop&&this.pluginDlg.binding.resizeStop())},onPluginMouseMove:function(t,e){if(this.pluginDlg){var i=this.pluginContainer.offset();this.pluginDlg.binding.drag&&this.pluginDlg.binding.drag({pageX:t*Common.Utils.zoom()+i.left,pageY:e*Common.Utils.zoom()+i.top}),this.pluginDlg.binding.resize&&this.pluginDlg.binding.resize({pageX:t*Common.Utils.zoom()+i.left,pageY:e*Common.Utils.zoom()+i.top})}},onPluginsInit:function(t){!(t instanceof Array)&&(t=t.pluginsData),this.parsePlugins(t)},runAutoStartPlugins:function(){this.autostart&&this.autostart.length>0&&this.api.asc_pluginRun(this.autostart.shift(),0,"")},resetPluginsList:function(){this.getApplication().getCollection("Common.Collections.Plugins").reset()},parsePlugins:function(t){var e=this,i=this.getApplication().getCollection("Common.Collections.Plugins"),n=e.editor,o=e.api?e.api.GetVersion():void 0;if(t instanceof Array){var s=[],r=e.appOptions.lang.split(/[\-_]/)[0];t.forEach(function(t){if(!(s.some(function(e){return e.get("baseUrl")==t.baseUrl||e.get("guid")==t.guid})||i.findWhere({baseUrl:t.baseUrl})||i.findWhere({guid:t.guid}))){var a=[],l=!1;if(t.variations.forEach(function(e){var i=e.isViewer&&!1!==e.isDisplayedInViewer&&_.contains(e.EditorsSupport,n)&&!e.isSystem;if(i&&(l=!0),!t.isUICustomizer){var o=new Common.Models.PluginVariation(e),s=e.description;"object"==typeof e.descriptionLocale&&(s=e.descriptionLocale[r]||e.descriptionLocale.en||s||""),_.each(e.buttons,function(t,e){"object"==typeof t.textLocale&&(t.text=t.textLocale[r]||t.textLocale.en||t.text||""),t.visible=!1!==t.isViewer}),o.set({description:s,index:a.length,url:e.url,icons:e.icons2||e.icons,buttons:e.buttons,visible:i,help:e.help}),a.push(o)}}),a.length>0&&!t.isUICustomizer){var c=t.name;"object"==typeof t.nameLocale&&(c=t.nameLocale[r]||t.nameLocale.en||c||""),l&&(l=e.checkPluginVersion(o,t.minVersion)),s.push(new Common.Models.Plugin({name:c,guid:t.guid,baseUrl:t.baseUrl,variations:a,currentVariation:0,visible:l,groupName:t.group?t.group.name:"",groupRank:t.group?t.group.rank:0,minVersion:t.minVersion,original:t}))}}}),i&&(s=i.models.concat(s),s.sort(function(t,e){var i=t.get("groupRank"),n=e.get("groupRank");return i<n?0==i?1:-1:i>n?0==n?-1:1:0}),i.reset(s),this.appOptions.canPlugins=!i.isEmpty())}else this.appOptions.canPlugins=!1;this.appOptions.canPlugins&&(this.refreshPluginsList(),this.runAutoStartPlugins())},checkPluginVersion:function(t,e){if(t&&"develop"!==t&&e&&"string"==typeof e){var i=e.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/),n=t.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/);if(i&&i.length>1&&n&&n.length>1)for(var o=0;o<3;o++){var s=i[o+1]?parseInt(i[o+1]):0,r=n[o+1]?parseInt(n[o+1]):0;if(s>r)return!1;if(s<r)return!0}}return!0},getPlugins:function(t,e){if(!t||t.length<1)return Promise.resolve([]);e=e||function(t){return fetch(t).then(function(e){return e.ok?e.json():Promise.reject(t)}).then(function(e){return e.baseUrl=t.substring(0,t.lastIndexOf("config.json")),e})};var i=[];return t.map(e).reduce(function(t,e){return t.then(function(){return e}).then(function(t){return i.push(t),Promise.resolve(t)}).catch(function(t){return Promise.resolve(t)})},Promise.resolve()).then(function(){return Promise.resolve(i)})},mergePlugins:function(){if(void 0!==this.serverPlugins.plugins&&void 0!==this.configPlugins.plugins){var t=[],e=[],i=this.configPlugins,n=!1;if(i.plugins&&i.plugins.length>0&&(e=i.plugins),i&&i.config){var o=i.config.autostart||i.config.autoStartGuid;"string"==typeof o&&(o=[o]),n=!!i.config.autoStartGuid,t=o||[]}i=this.serverPlugins,i.plugins&&i.plugins.length>0&&(e=e.concat(i.plugins)),i&&i.config&&(o=i.config.autostart||i.config.autoStartGuid,"string"==typeof o&&(o=[o]),(n||i.config.autoStartGuid)&&console.warn("Obsolete: The autoStartGuid parameter is deprecated. Please check the documentation for new plugin connection configuration."),t=t.concat(o||[])),this.autostart=t,this.parsePlugins(e)}}},DE.Controllers.Plugins||{}))}),define("common/main/lib/view/SearchBar",["common/main/lib/component/Window","common/main/lib/component/Button"],function(){"use strict";Common.UI.SearchBar=Common.UI.Window.extend(_.extend({options:{modal:!1,width:328,height:54,header:!1,cls:"search-bar",alias:"SearchBar",showOpenPanel:!0,toolclose:"hide"},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<input type="text" id="search-bar-text" class="input-field form-control" maxlength="255" placeholder="'+this.textFind+'" autocomplete="off">','<div class="tools">','<div id="search-bar-back"></div>','<div id="search-bar-next"></div>',this.options.showOpenPanel?'<div id="search-bar-open-panel"></div>':"",'<div id="search-bar-close"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.iconType=this.options.iconType,Common.UI.Window.prototype.initialize.call(this,this.options),Common.NotificationCenter.on("layout:changed",_.bind(this.onLayoutChanged,this)),$(window).on("resize",_.bind(this.onLayoutChanged,this))},render:function(){return Common.UI.Window.prototype.render.call(this),this.inputSearch=this.$window.find("#search-bar-text"),this.inputSearch.on("input",_.bind(function(){this.disableNavButtons(),this.fireEvent("search:input",[this.inputSearch.val()])},this)).on("keydown",_.bind(function(t){this.fireEvent("search:keydown",[this.inputSearch.val(),t])},this)),this.btnBack=new Common.UI.Button({parentEl:$("#search-bar-back"),cls:"btn-toolbar",iconCls:"svg"===this.iconType?"svg-icon search-arrow-up":"toolbar__icon btn-arrow-up",hint:this.tipPreviousResult}),this.btnBack.on("click",_.bind(this.onBtnNextClick,this,"back")),this.btnNext=new Common.UI.Button({parentEl:$("#search-bar-next"),cls:"btn-toolbar",iconCls:"svg"===this.iconType?"svg-icon search-arrow-down":"toolbar__icon btn-arrow-down",hint:this.tipNextResult}),this.btnNext.on("click",_.bind(this.onBtnNextClick,this,"next")),this.options.showOpenPanel&&(this.btnOpenPanel=new Common.UI.Button({parentEl:$("#search-bar-open-panel"),cls:"btn-toolbar",iconCls:"toolbar__icon more-vertical",hint:this.tipOpenAdvancedSettings}),this.btnOpenPanel.on("click",_.bind(this.onOpenPanel,this))),this.btnClose=new Common.UI.Button({parentEl:$("#search-bar-close"),cls:"btn-toolbar",iconCls:"svg"===this.iconType?"svg-icon search-close":"toolbar__icon btn-close",hint:this.tipCloseSearch}),this.btnClose.on("click",_.bind(function(){this.hide()},this)),this.on("animate:before",_.bind(this.focus,this)),Common.NotificationCenter.on("search:updateresults",_.bind(this.disableNavButtons,this)),this},show:function(t){var e=($("#app-title").length>0?$("#app-title").height():0)+$("#toolbar").height()+2,i=Common.Utils.innerWidth()-($("#right-menu").is(":visible")?$("#right-menu").width():0)-this.options.width-32;Common.UI.Window.prototype.show.call(this,i,e),this.disableNavButtons(),t?(this.inputSearch.val(t),this.fireEvent("search:input",[t])):(this.inputSearch.val(""),window.SSE&&this.fireEvent("search:input",["",!0])),this.focus()},focus:function(){var t=this;setTimeout(function(){t.inputSearch.focus(),t.inputSearch.select()},10)},setText:function(t){this.inputSearch.val(t),this.fireEvent("search:input",[t])},getSettings:function(){return{}},onLayoutChanged:function(){var t=$("#app-title").height()+$("#toolbar").height()+2,e=Common.Utils.innerWidth()-($("#right-menu").is(":visible")?$("#right-menu").width():0)-this.options.width-32;this.$window.css({left:e,top:t})},onBtnNextClick:function(t){this.fireEvent("search:"+t,[this.inputSearch.val(),!1])},onOpenPanel:function(){this.hide(),this.fireEvent("search:show",[!0,this.inputSearch.val()])},disableNavButtons:function(t,e){var i=""===this.inputSearch.val()&&!window.SSE||!e;this.btnBack.setDisabled(i),this.btnNext.setDisabled(i)},textFind:"Find",tipPreviousResult:"Previous result",tipNextResult:"Next result",tipOpenAdvancedSettings:"Open advanced settings",tipCloseSearch:"Close search"},Common.UI.SearchBar||{}))}),define("documenteditor/forms/app/controller/SearchBar",["core","common/main/lib/view/SearchBar"],function(){"use strict";DE.Controllers.SearchBar=Backbone.Controller.extend(_.extend({initialize:function(){},events:function(){},onLaunch:function(){this._state={searchText:""},Common.NotificationCenter.on("search:show",_.bind(this.onSearchShow,this))},setApi:function(t){return this.api=t,this.api&&this.api.asc_registerCallback("asc_onSetSearchCurrent",_.bind(this.onApiUpdateSearchCurrent,this)),this},onSearchShow:function(){this.searchBar||(this.searchBar=new Common.UI.SearchBar({showOpenPanel:!1,width:303,iconType:"svg"}),this.searchBar.on({"search:back":_.bind(this.onSearchNext,this,"back"),"search:next":_.bind(this.onSearchNext,this,"next"),"search:input":_.bind(this.onInputSearchChange,this),"search:keydown":_.bind(this.onSearchNext,this,"keydown"),show:_.bind(this.onSelectSearchingResults,this,!0),hide:_.bind(this.onSelectSearchingResults,this,!1)})),this.searchBar.isVisible()||this.searchBar.show(this.api.asc_GetSelectedText()||this._state.searchText)},onSelectSearchingResults:function(t){this._state.isHighlightedResults!==t&&(this.api.asc_selectSearchingResults(t),this._state.isHighlightedResults=t)},onApiUpdateSearchCurrent:function(t,e){this.searchBar&&this.searchBar.disableNavButtons(t,e)},onSearchNext:function(t,e){var i=e[0],n=e[1];i&&i.length>0&&("keydown"===t&&13===n.keyCode||"keydown"!==t)&&(this._state.searchText=i,this.onQuerySearch(t)&&this._searchTimer&&this._searchTimer&&(clearInterval(this._searchTimer),this._searchTimer=void 0))},onQuerySearch:function(t,e){var i=new AscCommon.CSearchSettings;return i.put_Text(this._state.searchText),i.put_MatchCase(!1),i.put_WholeWords(!1),!!this.api.asc_findText(i,"back"!=t)||(this.searchBar.disableNavButtons(),!1)},onInputSearchChange:function(t){var t=t[0];if((t&&this._state.searchText!==t||!t&&this._state.newSearchText)&&(this._state.newSearchText=t,this._lastInputChange=new Date,void 0===this._searchTimer)){var e=this;this._searchTimer=setInterval(function(){new Date-e._lastInputChange<400||(e._state.searchText=e._state.newSearchText,""!==e._state.newSearchText?e.onQuerySearch():e.api.asc_endFindText(),clearInterval(e._searchTimer),e._searchTimer=void 0)},10)}}},DE.Controllers.SearchBar||{}))}),define("common/main/lib/controller/Themes",["core"],function(){"use strict";!Common.UI&&(Common.UI={}),Common.UI.Themes=new function(t){!t&&(t={});var e={"theme-system":{text:t.txtThemeSystem||"Same as system",type:"system",source:"static"},"theme-light":{text:t.txtThemeLight||"Light",type:"light",source:"static"},"theme-classic-light":{text:t.txtThemeClassicLight||"Classic Light",type:"light",source:"static"},"theme-dark":{text:t.txtThemeDark||"Dark",type:"dark",source:"static"},"theme-contrast-dark":{text:t.txtThemeContrastDark||"Dark Contrast",type:"dark",source:"static"}};window.currentLoaderTheme&&(e[currentLoaderTheme.id]||(e[currentLoaderTheme.id]=currentLoaderTheme),window.currentLoaderTheme=void 0);var i=["toolbar-header-document","toolbar-header-spreadsheet","toolbar-header-presentation","text-toolbar-header-on-background-document","text-toolbar-header-on-background-spreadsheet","text-toolbar-header-on-background-presentation","background-normal","background-toolbar","background-toolbar-additional","background-primary-dialog-button","background-tab-underline","background-notification-popover","background-notification-badge","background-scrim","background-loader","background-accent-button","background-contrast-popover","shadow-contrast-popover","highlight-button-hover","highlight-button-pressed","highlight-button-pressed-hover","highlight-primary-dialog-button-hover","highlight-header-button-hover","highlight-header-button-pressed","highlight-toolbar-tab-underline","highlight-text-select","highlight-accent-button-hover","highlight-accent-button-pressed","border-toolbar","border-divider","border-regular-control","border-toolbar-button-hover","border-preview-hover","border-preview-select","border-control-focus","border-color-shading","border-error","border-contrast-popover","text-normal","text-normal-pressed","text-secondary","text-tertiary","text-link","text-link-hover","text-link-active","text-link-visited","text-inverse","text-toolbar-header","text-contrast-background","text-alt-key-hint","icon-normal","icon-normal-pressed","icon-inverse","icon-toolbar-header","icon-notification-badge","icon-contrast-popover","icon-success","canvas-background","canvas-content-background","canvas-page-border","canvas-ruler-background","canvas-ruler-border","canvas-ruler-margins-background","canvas-ruler-mark","canvas-ruler-handle-border","canvas-ruler-handle-border-disabled","canvas-high-contrast","canvas-high-contrast-disabled","canvas-cell-border","canvas-cell-title","canvas-cell-title-border","canvas-cell-title-border-hover","canvas-cell-title-border-selected","canvas-cell-title-hover","canvas-cell-title-selected","canvas-dark-cell-title","canvas-dark-cell-title-hover","canvas-dark-cell-title-selected","canvas-dark-cell-title-border","canvas-dark-cell-title-border-hover","canvas-dark-cell-title-border-selected","canvas-dark-content-background","canvas-dark-page-border","canvas-scroll-thumb","canvas-scroll-thumb-hover","canvas-scroll-thumb-pressed","canvas-scroll-thumb-border","canvas-scroll-thumb-border-hover","canvas-scroll-thumb-border-pressed","canvas-scroll-arrow","canvas-scroll-arrow-hover","canvas-scroll-arrow-pressed","canvas-scroll-thumb-target","canvas-scroll-thumb-target-hover","canvas-scroll-thumb-target-pressed"],n=function(t){var e={};if(!Common.Utils.isIE10&&!Common.Utils.isIE11){var i=getComputedStyle(document.body);t.forEach(function(t,n){e[t]=i.getPropertyValue("--"+t).trim()})}return e},o=function(t,e){if(e&&t){var i=[":root .",t,"{"];for(var n in e)i.push("--",n,":",e[n],";");return i.push("}"),i.join("")}},s=function(t){if(t){var e=document.createElement("style");e.type="text/css",e.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(e)}},r=function(t){var i,n=Common.Locale.getCurrentLanguage();t.themes&&t.themes instanceof Array?t.themes.forEach(function(t){t.id?(i=t.l10n&&t.l10n[n]?t.l10n[n]:t.name,e[t.id]={text:i,type:t.type},s(o(t.id,t.colors))):"string"==typeof t&&a(t)}):t.id&&(i=t.l10n&&t.l10n[n]?t.l10n[n]:t.name,e[t.id]={text:i,type:t.type},s(o(t.id,t.colors))),Common.NotificationCenter.trigger("uitheme:countchanged")},a=function(t){Common.Utils.loadConfig(t,function(t){"error"!=t?r(t):console.warn("failed to load/parse themes.json")})},l=function(t){Common.Controllers.Desktop.isActive()&&Common.Controllers.Desktop.isOffline()||a("../../../../themes.json")},c=function(t){return"string"==typeof t&&t.startsWith("{")&&t.endsWith("}")&&(t=JSON.parse(t)),t&&"object"==typeof t?t.id:t},h=function(t){this.api.asc_setContentDarkMode&&this.isDarkTheme()&&this.api.asc_setContentDarkMode(this.isContentThemeDark())};const d=function(t){return"system"==e[t].type},u=function(){return Common.Controllers.Desktop&&Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.systemThemeType():window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},p=function(){const t="dark"==u()?"theme-dark":"theme-classic-light";return{id:t,info:e[t]}},m=function(t){Common.localStorage.getBool("ui-theme-use-system",!1)&&this.setTheme("theme-system")};return{init:function(t){var o=this;Common.Gateway.on("opendocument",h.bind(this)),$(window).on("storage",function(t){"ui-theme"==t.key||"ui-theme-id"==t.key?t.originalEvent.newValue&&(Common.localStorage.getBool("ui-theme-use-system",!1)?o.setTheme("theme-system"):o.setTheme(t.originalEvent.newValue,!0)):"content-theme"==t.key&&(o.setContentTheme(t.originalEvent.newValue,!0),console.log("changed content",t.originalEvent.newValue))}),this.api=t;var s=c(Common.localStorage.getItem("ui-theme"));s||Common.Utils.isIE10||Common.Utils.isIE11||document.body.classList.forEach(function(t,i,n){if(!s&&t.startsWith("theme-")&&!t.startsWith("theme-type-")&&e[t]){s=t;var o={id:s,type:e[s].type};Common.localStorage.setItem("ui-theme",JSON.stringify(o))}}),e[s]||(s="theme-classic-light"),$("body").hasClass(s)||$("body").addClass(s),document.body.className.match(/theme-type-/)||document.body.classList.add("theme-type-"+e[s].type);var r=n(i);r.type=e[s].type,r.name=s,t.asc_setSkin(r),Common.Utils.isIE10||Common.Utils.isIE11||window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",m.bind(this)),Common.NotificationCenter.on("document:ready",l.bind(this))},available:function(){return!Common.Utils.isIE&&!this.locked},setAvailable:function(t){this.locked=!t},map:function(){return e},get:function(t){return e[t]},currentThemeId:function(){if(Common.localStorage.getBool("ui-theme-use-system",!1))return"theme-system";var t=Common.localStorage.getItem("ui-theme")||Common.localStorage.getItem("ui-theme-id"),i=c(t);return e[i]?i:"theme-classic-light"},defaultThemeId:function(t){return"dark"==t?"theme-dark":"theme-classic-light"},defaultTheme:function(t){return e[this.defaultThemeId(t)]},isDarkTheme:function(t){return!t&&(t=this.currentThemeId()),"dark"==(d(t)?p().info.type:e[t].type)},isContentThemeDark:function(){return"dark"==Common.localStorage.getItem("content-theme")},setContentTheme:function(t,e){var i="dark"==t;i&&!this.isDarkTheme()||(i!=this.isContentThemeDark()||e)&&(this.api.asc_setContentDarkMode&&this.api.asc_setContentDarkMode(i),Common.localStorage.getItem("content-theme")!=t&&Common.localStorage.setItem("content-theme",t),Common.NotificationCenter.trigger("contenttheme:dark",i))},toggleContentTheme:function(){var t=this.isContentThemeDark();t?Common.localStorage.setItem("content-theme","light"):Common.localStorage.setItem("content-theme","dark"),this.api.asc_setContentDarkMode&&this.api.asc_setContentDarkMode(!t),Common.NotificationCenter.trigger("contenttheme:dark",!t)},setTheme:function(t){if(t){var o=c(t),s=arguments[1];if(!s&&d(this.currentThemeId())&&p().id==o)return Common.localStorage.setBool("ui-theme-use-system",!1),Common.localStorage.setItem("ui-theme-id",""),Common.localStorage.setItem("ui-theme-id",o),void Common.NotificationCenter.trigger("uitheme:changed",o);if(d(o)){if(p().id==this.currentThemeId())return Common.localStorage.setBool("ui-theme-use-system",!0),Common.localStorage.setItem("ui-theme-id",""),Common.localStorage.setItem("ui-theme-id",o),void Common.NotificationCenter.trigger("uitheme:changed",o);Common.localStorage.setBool("ui-theme-use-system",!0),o=p().id}else Common.localStorage.setBool("ui-theme-use-system",!1)
;if((this.currentThemeId()!=o||s)&&e[o]){if(document.body.className=document.body.className.replace(/theme-[\w-]+\s?/gi,"").trim(),document.body.classList.add(o,"theme-type-"+e[o].type),this.api){this.api.asc_setContentDarkMode&&("light"==e[o].type?this.api.asc_setContentDarkMode(!1):(this.api.asc_setContentDarkMode(this.isContentThemeDark()),Common.NotificationCenter.trigger("contenttheme:dark",this.isContentThemeDark())));var t=n(i);t.type=e[o].type,t.name=o,this.api.asc_setSkin(t)}if(!Common.Utils.isIE10&&!Common.Utils.isIE11){var r={id:o,type:t.type,text:e[o].text};"static"!=e[o].source&&(r.colors=t),s||Common.localStorage.setItem("ui-theme",JSON.stringify(r))}s||Common.localStorage.setItem("ui-theme-id",o),Common.NotificationCenter.trigger("uitheme:changed",o)}}},toggleTheme:function(){this.setTheme(this.isDarkTheme()?"theme-classic-light":"theme-dark")}}}(Common.UI.Themes)});var reqerr;require.config({baseUrl:"../../",paths:{jquery:"../vendor/jquery/jquery",underscore:"../vendor/underscore/underscore",backbone:"../vendor/backbone/backbone",bootstrap:"../vendor/bootstrap/dist/js/bootstrap",text:"../vendor/requirejs-text/text",perfectscrollbar:"common/main/lib/mods/perfect-scrollbar",jmousewheel:"../vendor/perfect-scrollbar/src/jquery.mousewheel",xregexp:"../vendor/xregexp/xregexp-all-min",socketio:"../vendor/socketio/socket.io.min",allfonts:"../../sdkjs/common/AllFonts",sdk:"../../sdkjs/word/sdk-all-min",api:"api/documents/api",core:"common/main/lib/core/application",notification:"common/main/lib/core/NotificationCenter",keymaster:"common/main/lib/core/keymaster",tip:"common/main/lib/util/Tip",localstorage:"common/main/lib/util/LocalStorage",analytics:"common/Analytics",gateway:"common/Gateway",locale:"common/locale",irregularstack:"common/IrregularStack"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},bootstrap:{deps:["jquery"]},perfectscrollbar:{deps:["jmousewheel"]},notification:{deps:["backbone"]},core:{deps:["backbone","notification","irregularstack"]},sdk:{deps:["jquery","underscore","allfonts","xregexp","socketio"]},gateway:{deps:["jquery"]},analytics:{deps:["jquery"]}}}),require(["backbone","bootstrap","core","sdk","api","analytics","gateway","locale"],function(t,e,i){if(!t.History||!t.History.started){t.history.start();var n=new t.Application({nameSpace:"DE",autoCreate:!1,controllers:["ApplicationController","Plugins","SearchBar"]});Common.Locale.apply(function(){require(["documenteditor/forms/app/controller/ApplicationController","documenteditor/forms/app/controller/Plugins","documenteditor/forms/app/controller/SearchBar","documenteditor/forms/app/view/ApplicationView","common/main/lib/util/utils","common/main/lib/util/LocalStorage","common/main/lib/controller/Themes","common/main/lib/view/PluginDlg","common/main/lib/view/SearchBar","common/forms/lib/view/modals"],function(){n.start()})})}},function(t){"timeout"==t.requireType&&!reqerr&&window.requireTimeourError&&(reqerr=window.requireTimeourError(),window.alert(reqerr),window.location.reload())}),define("../apps/documenteditor/forms/app.js",function(){});